{"version":3,"file":"phonegap/gielese/www/javascripts/app.js","sources":["app/appcache.coffee","app/application.coffee","app/auth/authentication.coffee","app/backbone.offline.coffee","app/language_codes.coffee","app/loadingtracker.coffee","app/media/audio_player.coffee","app/models/category.litcoffee","app/models/categorylist.litcoffee","app/models/collection.coffee","app/models/concept.coffee","app/models/conceptdb.coffee","app/models/exceptions/level_complete.coffee","app/models/exceptions/progression_cycle_done.coffee","app/models/helpers/concept_by_ordering.coffee","app/models/helpers/concept_progression_sorter.litcoffee","app/models/model.coffee","app/models/question.litcoffee","app/models/questiondb.coffee","app/models/session.coffee","app/models/user_log_entry.coffee","app/models/user_progression.coffee","app/models/user_settings.coffee","app/models/usersetting.coffee","app/routers/router.coffee","app/sample_data/sample_concepts.coffee","app/tests/auth_tests.coffee","app/tests/question_tests.coffee","app/tests/tests.coffee","app/views/categories/categories.coffee","app/views/categories/category.coffee","app/views/categories/templates/categories.eco","app/views/categories/templates/category.eco","app/views/categories/templates/subcategory.eco","app/views/concepts/list.coffee","app/views/concepts/templates/concepts.eco","app/views/concepts/templates/item.eco","app/views/concepts/templates/list.eco","app/views/error/templates/error.eco","app/views/error/view.coffee","app/views/games/learn.coffee","app/views/games/leksa.coffee","app/views/games/leksa_options_view.coffee","app/views/games/level_complete.coffee","app/views/games/templates/leksa.eco","app/views/games/templates/leksa_error_template.eco","app/views/games/templates/leksa_level_completed.eco","app/views/games/templates/leksa_options_view.eco","app/views/games/templates/leksa_question_image_to_word.eco","app/views/games/templates/leksa_question_word_to_image.eco","app/views/games/templates/stat_block.eco","app/views/info/info.coffee","app/views/info/templates/info.eco","app/views/intro/loading.coffee","app/views/intro/templates/front_page.eco","app/views/intro/templates/loading.eco","app/views/intro/view.coffee","app/views/splash/splash.coffee","app/views/splash/templates/splash.eco","app/views/templates/app_cache_status.eco","app/views/templates/leksa_concept.eco","app/views/templates/sound_loading.eco","app/views/users/login_modal.coffee","app/views/users/options.coffee","app/views/users/stats.coffee","app/views/users/templates/category_legend.eco","app/views/users/templates/high_scores.eco","app/views/users/templates/login_error_modal.eco","app/views/users/templates/login_modal.eco","app/views/users/templates/options.eco","app/views/users/templates/stats.eco"],"names":[],"mappings":"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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA5GA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3GA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA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CAAJ,IAAU;CAAU,CACR,IAAV;CADkB,CAEV,EAAC,EAAT,WAFkB;EAGH,CAAoB,CAApB,EAAf,CAAsB,MAAtB;CAHF,KAAU;CA3CV,EAiDI,CAAJ;CAjDA,GAkDA;CApDM,UAsDN;CAzLF,EAmIQ;;CAnIR;;CAFyC,OAAQ;A;;CChFnD;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAzFA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/HA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AArGA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3DA;;A;ACAA;;;;GAAgB,UAAhB,MAAgB;;AAEhB,CAFA,EAEuB,GAAjB,CAAN;CAEE;;;;;;;GAAW,IAAX;;EACA,CAAI,IADJ;;GAGU,KAAV,KAHA;;GAKQ,GAAR,GAAQ;CACN,EAAI,CAAJ;CADM,UAEN;CAPF,EAKQ;;CALR;;CAFuC,OAAQ;A;;;ACQjD;;;;GAAiB,WAAjB,qBAAiB;;AACjB,CADA,EACuB,iBAAvB,YAAuB;;AAEvB,CAHA,EAGY,MAAZ,WAAY;;AAMZ,CATA,EASuB,GAA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ACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/EA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3DA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/FA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3DA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/EA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhGA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnFA;;A;ACAA;;;;GAAe,SAAf,MAAe;;AAEf,CAFA,EAEuB,GAAjB,CAAN;CAEE;;;;;;;GAAI,OAAJ;;GAEU,KAAV,IAFA;;GAIQ,GAAR,GAAQ;CACN,EAAI,CAAJ;CADM,UAGN;CAPF,EAIQ;;CAJR;;CAFsC,OAAQ;A;;CCFhD;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3DA;;A;ACAA;;;;GAAuB,GAAjB,CAAN;CAEE;;;;;;;GAAW,MAAX;;EACA,CAAI,MADJ;;GAGU,KAAV,aAAU;;CAHV,EAKQ,GAAR,GAAQ;CACN;GAAI,CAAJ;GACG,CAAH,UAAkB;CADlB,EAEI,CAAJ;CAFA,EAGA,GAAa,CAAN;CAHP,EAII,CAAJ,EAC2B,GAAP,CACP,GAFY;CALnB,UAUN;CAfF,EAKQ;;CALR;;CAFyC,OAAQ;A;;CCAnD;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnIA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvDA;;A;ACGA;;;;;;GAAoB,cAApB,OAAoB;;AACpB,CADA,EACqB,eAArB,wBAAqB;;AAErB,CAHA,EAGuB,GAAjB,CAAN;CAEE;;;;;;;;GAAI,QAAJ;;GAEU,KAAV,SAFA;;GAOE,GADF;CACE,CAAgB,EAAhB;EACiB,EAAjB,MADA,KACA;CADA,CAGuB,EAAvB,UAHA,OAGA;CAHA,CAIiC,EAAjC,UAJA,iBAIA;CAJA,CAKgB,EAAhB,GALA,OAKA;CALA,CAOwC,EAAxC,YAPA,s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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3DA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAjFA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvDA;;A;ACCA;;;;GAAuB,GAAjB,CAAN;CAEE;;;;;;;GAAU,KAAV,iBAAU;;CAAV,EAEQ,GAAR,GAAQ;WACN;CAHF,EAEQ;;CAFR;;CAFuC,OAAQ;A;;;ACDjD;;;;GAAkB,YAAlB,MAAkB;;AAElB,CAFA,EAEuB,GAAjB,CAAN;CAIE;;;;;;;GAAI,aAAJ;;GAKE,GADF;CACE,CAAuB,EAAvB;EACyB,EAAzB,eADA,IACA;CADA,CAE+B,EAA/B,YAFA,aAEA;CAFA,CAGiC,EAAjC,SAHA,kBAGA;CAHA,CAImC,EAAnC,SAJA,oBAIA;CAJA,CAKiC,EAAjC,SALA,kBAKA;CAVF;;GAYgB,MAAC,KAAjB;CACE;GAAY,CAAZ,EAAY,GAAZ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;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3EA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAvKA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3EA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/DA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA/FA;;A,CCAA;;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AA3HA;;A","sourcesContent":["AppCacheStatus = require 'views/templates/app_cache_status'\n\nmodule.exports = AppCacheHandler = () ->\n  console.log \"Initializing appCache\"\n  # TODO: need some sort of sync feedback for users\n  #\n  # Some log handlers for the console\n  loadingFloat = () ->\n    if $('#loading_float').length == 0\n      loading = AppCacheStatus {\n      \tobj_count: 55\n      }\n      $('body').append loading\n      loading = $('#loading_float')\n    else\n      loading = $('#loading_float')\n    loading.fadeOut(4500)\n    return loading\n\n  updateLoadingCount = (count, total) =>\n    loader = loadingFloat()\n    loader.fadeIn(500)\n    _count = loader.find('#cache_count')\n    _total = loader.find('#cache_total')\n    _count.html(count)\n    _total.html(total)\n    return true\n\n  incrementLoadingCount = () =>\n    loader = loadingFloat()\n    _count = loader.find('#cache_count')\n    _total = loader.find('#cache_total')\n\n    count = parseInt loader.find('#cache_count').html()\n    total = parseInt loader.find('#cache_total').html()\n\n    if isNaN(count) or isNaN(total)\n      count = 0\n      total = 0\n\n    updateLoadingCount(count + 1, total)\n\n  updateLoadingStatusMessage = (msg) =>\n    loader = loadingFloat()\n    loader.fadeIn(500)\n    _msg = loader.find('#status #message')\n    _msg.html(msg)\n    return true\n\n  fadeOutLoader = () ->\n    loader = loadingFloat().fadeOut(1500)\n    return true\n\n  window.updateLoadingCount = updateLoadingCount\n  window.incrementLoadingCount = incrementLoadingCount\n  window.updateLoadingStatusMessage = updateLoadingStatusMessage\n  window.fadeOutLoader = fadeOutLoader\n\n  loadingFloat()\n\n  if window.applicationCache\n    window.applicationCache.onchecking = (e) ->\n      console.log \"onchecking\"\n      updateLoadingStatusMessage(\"Checking for new media files.\")\n\n    window.applicationCache.onnoupdate = (e) ->\n      console.log(\"No updates\")\n      updateLoadingStatusMessage(\"No updates.\")\n      fadeOutLoader()\n\n    window.applicationCache.onupdateready = (e) ->\n      console.log(\"Update ready\")\n      updateLoadingStatusMessage(\"Update finished.\")\n      fadeOutLoader()\n\n    window.applicationCache.onobsolete = (e) ->\n      console.log(\"Obsolete\")\n\n    window.applicationCache.ondownloading = (e) ->\n      console.log(\"Downloading\")\n      updateLoadingStatusMessage(\"Downloading ...\")\n\n    window.applicationCache.oncached = (e) ->\n      console.log(\"Cached\")\n      updateLoadingStatusMessage(\"Offline files downloaded.\")\n      fadeOutLoader()\n\n    window.applicationCache.onerror = (e) ->\n      console.log(\"Error\")\n      updateLoadingStatusMessage(\"Caching error! Error connecting.\")\n\n    counter = 0\n    window.applicationCache.onprogress = (e) ->\n      console.log(\"checking\")\n      console.log(\"Progress: downloaded file \" + counter)\n      incrementLoadingCount()\n      counter++\n\n    window.addEventListener \"online\", (e) ->\n      # TODO: things to do here\n      console.log \"you are online\"\n\n    window.addEventListener \"offline\", (e) ->\n      # TODO: things to do here\n      console.log \"you are offline\"\n  else\n    fadeOutLoader()\n","# Views\nRouter = require 'routers/router'\n\n# User stuff\nAuthenticator = require 'auth/authentication'\nUserSettings = require 'models/user_settings'\nUserProgression = require 'models/user_progression'\n\n# Data\nLoadingTracker = require 'loadingtracker'\nConceptDB = require 'models/conceptdb'\nCategoryList = require 'models/categorylist'\nQuestionDB = require 'models/questiondb'\n\n# Media\nAudioPlayer = require 'media/audio_player'\n\n# Tests\n\nTests = require 'tests/tests'\n\n# some global things that get called\nrequire 'backbone.offline'\nrequire 'language_codes'\n\nwindow.initWindowCache = require 'appcache'\n\narrayChunk = (a, s) ->\n  x = undefined\n  i = 0\n  c = -1\n  l = a.length\n  n = []\n\n  while i < l\n    (if (x = i % s) then n[c][x] = a[i] else n[++c] = [a[i]])\n    i++\n  n\n\nwindow.arrayChunk = arrayChunk\n\n# Mobile Safari fix\nFunction::bind = (parent) ->\n  f = this\n  args = []\n  a = 1\n\n  while a < args.length\n    args[args.length] = args[a]\n    a++\n\n  temp = ->\n    f.apply parent, args\n\n  temp\n\nclass LeksaOptions\n  constructor: ->\n\nmodule.exports = class Application\n\n  enable_webfonts: () ->\n    if not WebFont?\n      console.log \"ERROR: WebFont async loader not available.\"\n      return\n    WebFont.load\n      google:\n        families: ['Open Sans', 'Kaushan Script']\n\n  switch_locale: (locale, options = {}) ->\n    conv_l = ISOs.three_to_two locale\n    if conv_l != locale\n      locale = conv_l\n    $.get app.server.path + \"/data/translations/#{locale}/messages.json\",\n      (locale_data) =>\n        gettext = new Gettext({\n          domain: 'messages'\n          locale_data: locale_data\n        })\n        @gettext = gettext\n        window.gettext = @gettext\n        @loadingTracker.markReady('translations.json')\n        options.complete() if options.complete\n\n  soundEffectCorrect: () ->\n    @correct_concept = _.first @conceptdb.where\n      semantics: [\"CORRECT\"]\n      concept_value: \"CORRECT\"\n    if @correct_concept\n      @correct_concept.playAudio()\n    true\n\n  soundEffectIncorrect: () ->\n    @incorrect_concept = _.first @conceptdb.where\n      semantics: [\"INCORRECT\"]\n      concept_value: \"INCORRECT\"\n    if @incorrect_concept\n      @incorrect_concept.playAudio()\n    true\n    \n  soundEffects:\n    'click': () => app.audio.playPath('/static/audio/click.mp3')\n    'correct': () => app.soundEffectCorrect()\n    'incorrect': () =>  app.soundEffectIncorrect()\n    \n  constructor: ->\n    $ =>\n      @enable_webfonts()\n      @initialize\n        complete: () =>\n          Backbone.history.start\n            pushState: false\n            hashChange: true\n            root: window.location.pathname\n\n          # There be dragons here...\n          # Webkit has issues with certain things.\n          $(document).bind \"pagechange\", (e, data) ->\n            webkit = $.browser.webkit\n            not_string = data.toPage isnt \"string\"\n            root_page = data.toPage.attr(\"data-url\") is '/'\n            if webkit and not_string and root_page\n              app.router.index()\n              return e.preventDefault()\n\n          if app.options.getSetting('enable_cache')?\n            initWindowCache()\n          \n          if window.location.hostname == 'localhost'\n            console.log \"Appending debug watcher\"\n            debug_watch = $ \"<script />\"\n            debug_watch.attr('src',\"http://localhost:9001/ws\")\n            debug_watch.appendTo 'head'\n\n  initialize: (options = {}) ->\n\n    # TODO: when to automatically clear localstorage, and check for\n    # existing session?\n    # TODO: device detection\n    @device_type = \"mobile\"\n    @media_size = \"small\"\n    @video_format = \"gif\"\n\n    # TODO: determine this based on whether cordova is present, etc.\n    @server =\n      path: \"http://localhost:5000\"\n    \n    # TODO: modernizr, check for preferred video format, fallback - gif?\n    #\n    if $(window).width() > 499\n      @device_type = \"tablet\"\n      @media_size = \"medium\"\n\n    @screen_width = $(window).width()\n    @screen_height = $(window).height()\n\n    @loadingTracker = new LoadingTracker({\n      'concepts.json': false\n      'leksa_questions.json': false\n      'translations.json': false\n      'categories.json': false\n    })\n\n    @loadingTracker.showLoading()\n\n    @audio = new AudioPlayer()\n\n    @gettext = new Gettext({\n      domain: 'messages'\n    })\n    window.gettext = @gettext\n\n    @auth = new Authenticator()\n\n    @tests = new Tests()\n\n    @conceptdb = new ConceptDB()\n    @conceptdb.fetch\n      success: () =>\n        window.fetched_somewhere = true\n        app.loadingTracker.markReady('concepts.json')\n        console.log \"fetched concepts.json (#{app.conceptdb.models.length})\"\n\n    @categories = new CategoryList()\n    @categories.fetch\n      success: () =>\n        window.fetched_somewhere = true\n        app.loadingTracker.markReady('categories.json')\n        console.log \"fetched categories.json (#{app.conceptdb.models.length})\"\n\n    @questiondb = new QuestionDB()\n\n    @userprogression = new UserProgression()\n    @leksaOptions = new LeksaOptions()\n\n    @router = new Router()\n\n    soundManager.setup\n      url: \"/static/client/swf/\"\n      debugMode: false\n      defaultOptions:\n        volume: 50\n      useConsole: true\n      preferFlash: false\n      useHTML5Audio: true\n      useFlashBlock: true\n      onready: () ->\n        console.log \"SoundManager ready\"\n      ontimeout: () ->\n        window.client_log.error('SM2 init failed!')\n\n    # usually ISO 639-1, excepting languages that don't have them but the trick\n    # is that we want to store ISO 639-2, because the lexicon has special needs\n    initial_language = navigator.language || navigator.userLanguage || \"no\"\n\n    # Force Norwegian if someone doesn't have one of the localizations\n    # supported here.\n    if initial_language not in [\"sma\", \"sv\", \"no\"]\n      initial_language = \"no\"\n\n    initial_language = ISOs.three_to_two initial_language\n\n    @switch_locale(initial_language, options)\n\n    # Convert the initial ISO settings\n\n    @options = new UserSettings()\n    @options.setSettings({\n      'interface_language': ISOs.two_to_three initial_language\n      'help_language': ISOs.two_to_three initial_language\n    })\n\nmakeLogger = () ->\n  log = log4javascript.getLogger()\n  ajaxlogger = new log4javascript.AjaxAppender('/client_logger/')\n  log.addAppender(ajaxlogger)\n  return log\n\nwindow.app = new Application\nwindow.client_log = makeLogger()\n\nwindow.onerror = (errorMsg, url, lineNumber) ->\n  window.client_log.fatal(\n    \"Uncaught error #{errorMsg} in #{url}, line #{lineNumber}\"\n  )\n","LoginTemplate = require '/views/users/templates/login_modal'\n\nmodule.exports = class Authenticator\n\n  hide_authentication_popup: (el) ->\n    el.find('#loginPopup').hide()\n\n  render_authentication_popup: (el, opts = {}) ->\n    # TODO: mutiple insertions in different elements will result in two of the\n    # same IDs, fix\n    auth_popup_form_submit = (event) =>\n      # TODO: disable form\n      if app.debug\n        console.log \"Authenticator.login: submitted\"\n      el.find('#loginPopup #loading').fadeIn()\n  \n      @login\n        username: el.find('#loginPopup #un').val()\n        password: el.find('#loginPopup #pw').val()\n        success: (data, textStatus, jqXHR) =>\n          el.find('#loginPopup #loading').fadeOut()\n          el.find('#loginPopup #success').fadeIn()\n          opts.success(data, textStatus, jqXHR) if opts.success\n        fail: (resp) =>\n          el.find('#loginPopup #loading').fadeOut()\n          el.find('#loginPopup #fail').fadeIn()\n          el.find('#loginPopup #login_error').html resp.error\n          opts.fail() if opts.fail\n      \n      return false\n\n    resetState = () ->\n      # TODO: enable form\n      el.find('#loginPopup #loading').hide()\n      el.find('#loginPopup #success').hide()\n      el.find('#loginPopup #fail').hide()\n      el.find('#loginPopup #pw').val('')\n\n    if $('#loginPopup').length == 0\n      login_template = LoginTemplate()\n      el.append(login_template)\n      \n      # Rerender elements\n      el.find('#loginPopup').trigger('create')\n\n      # el.find('#loginPopup input').textinput()\n      # el.find('#loginPopup button').button()\n      # el.find('#loginPopup .close_modal').button()\n      \n      # Events\n      el.find('#loginPopup form').submit auth_popup_form_submit\n      el.find('#loginPopup .close_modal').click (e) ->\n        popup = el.find(\"#loginPopup\")\n        popup.popup().hide().popup('close')\n\n    # Show it\n    popup = el.find(\"#loginPopup\")\n    resetState()\n    popup.popup().show().popup('open')\n\n    return false\n\n  create_user: (opts = {}) ->\n    data =\n      username: opts.username\n      email:    opts.email\n      password: opts.password\n      \n    _create_user = $.post(\"/user/create/\", data)\n\n    _create_user.fail (response) =>\n        if app.debug\n          console.log \"auth.create_user: fail\"\n        opts.fail(response) if opts.fail\n\n    _create_user.success (response) =>\n        if app.debug\n          console.log \"auth.create_user: success\"\n        opts.success(response) if opts.success\n\n    _create_user.always (response) =>\n        if app.debug\n          console.log \"auth.create_user: always\"\n        opts.always(response) if opts.always\n\n    return opts\n\n  logout: (opts = {}) ->\n    logout_request = $.ajax\n      type: \"GET\"\n      url: \"/user/logout/\"\n      xhrFields:\n        withCredentials: true\n\n    # TODO: sync everything left over in user collections\n\n    logout_request.fail (resp) ->\n      # TODO: post log to server\n      console.log \"Authenticator.logout.logout_request.fail: fail\"\n      console.log JSON.parse resp.responseText\n      app.user = null\n      opts.fail(resp) if opts.fail\n\n    logout_request.success (data, textStatus, jqXHR) =>\n      app.user = false\n      if app.debug\n        console.log \"Authenticator.logout.logout_request.success\"\n      @clearUserData()\n\n      opts.success(data, textStatus, jqXHR) if opts.success\n\n  clearUserData: ->\n    if app.debug\n      console.log \"Authenticator.clearUserData()\"\n\n    # exception for login-details\n    deets = DSt.get('login-details')\n    window.localStorage.clear()\n    app.options.reset()\n    app.userprogression.reset()\n    deets = DSt.set('login-details', deets)\n\n    if app.debug\n      console.log \"Cleared user data.\"\n      console.log [ app.userprogression.length\n                  , app.options.length, window.localStorage\n                  ]\n\n  forgot: (opts = {}) ->\n    data = {}\n\n    if opts.email\n      data.email_address = opts.email\n\n    if opts.username\n      data.username = opts.username\n\n    forgotten_request = $.ajax\n      type: \"POST\"\n      url: \"/user/forgot/\"\n      data: data\n      xhrFields:\n        withCredentials: true\n\n    forgotten_request.fail (resp) =>\n      # TODO: log to server?\n      console.log \"fail\"\n      console.log JSON.parse resp.responseText\n      app.user = null\n      opts.fail(resp) if opts.fail\n\n    forgotten_request.success (data, textStatus, jqXHR) ->\n      if app.debug\n        console.log \"Authenticator.login.forgot: Request for token successfully submitted ...\"\n      opts.success() if opts.success\n\n    forgotten_request.complete () =>\n      opts.complete() if opts.complete\n\n  # change_password: (opts = {}) ->\n  #   data =\n  #     new_password: new_password\n\n  #   if opts.forgotten_token?\n  #     data.forgotten_token = forgotten_token\n\n  #   if opts.old_password?\n  #     data.old_password = old_password\n\n  #   change_request = $.ajax\n  #     type: \"POST\"\n  #     url: \"/user/change/\"\n  #     data: data\n  #     xhrFields:\n  #       withCredentials: true\n\n  login: (opts = {}) ->\n    # TODO: when to clear user data before login?\n    data =\n      username: opts.username\n      password: opts.password\n    \n    login_request = $.ajax\n      type: \"POST\"\n      url: \"/user/login/\"\n      data: data\n      xhrFields:\n        withCredentials: true\n\n    login_request.fail (resp) =>\n      # TODO: log error to server?\n      console.log \"fail\"\n      console.log JSON.parse resp.responseText\n      app.user = null\n      opts.fail(resp) if opts.fail\n\n    login_request.success (data, textStatus, jqXHR) ->\n      if app.debug\n        console.log \"Authenticator.login.success: Should be logged in...\"\n      test_authed_request = $.getJSON('/user/data/log')\n      test_authed_request.success (resp) ->\n        if app.debug\n          console.log \"Authenticator.login.success.tesst_authed_request: \"\n          console.log resp\n\n      app.user = {\n        username: data.user.username\n        email: data.user.email\n      }\n      opts.success() if opts.success\n\n    login_request.complete () =>\n\n      # TODO: need to chain some of this stuff so that opts.success is only\n      # called when everything else is done, or create a separate opts.finished\n      # method or something.\n\n      if app.debug\n        console.log \"User logged in, syncing progression\"\n      $.when(\n        app.userprogression.storage.sync.full({\n          success: (data) ->\n            if app.debug\n              console.log \"userlog.full.success\"\n        }),\n        app.options.storage.sync.full({\n          success: (data) ->\n            if app.debug\n              console.log \"storage.full.success\"\n        })\n      ).then () =>\n        if app.debug\n          console.log \"all login requests complete\"\n        opts.success() if opts.success\n\n","#    Backbone.offline allows your Backbone.js app to work offline\n#    https://github.com/Ask11/backbone.offline\n#\n#    (c) 2012 - Aleksey Kulikov\n#    May be freely distributed according to MIT license.\n\ndo (global = window, _, Backbone) ->\n  global.Offline =\n    VERSION: '0.4.3a'\n\n    # This is a method for CRUD operations with localStorage.\n    # Delegates to 'Offline.Storage' and works as Backbone.sync alternative\n    localSync: (method, model, options, store) ->\n      resp = switch(method)\n        when 'read'\n          if _.isUndefined(model.id) then store.findAll(options) else store.find(model, options)\n        when 'create' then store.create(model, options)\n        when 'update' then store.update(model, options)\n        when 'delete' then store.destroy(model, options)\n\n      if resp\n        # TODO: test/check this\n        options.success(resp.attributes ? resp)\n      else\n        options.error?('Record not found')\n\n    # Overrides default 'Backbone.sync'. It checks 'storage' property of the model or collection\n    # and then delegates to 'Offline.localSync' when property exists else calls the default 'Backbone.sync' with received params.\n    sync: (method, model, options) ->\n      store = model.storage || model.collection?.storage\n      if store and store?.support\n        Offline.localSync(method, model, options, store)\n      else\n        Backbone.ajaxSync(method, model, options)\n\n    onLine: ->\n      navigator.onLine isnt false\n\n  # Override 'Backbone.sync' to default to 'Offline.sync'\n  # the original 'Backbone.sync' is available in 'Backbone.ajaxSync'\n  Backbone.ajaxSync = Backbone.sync\n  Backbone.sync = Offline.sync\n\n  # This class is use as a wrapper for manipulations with localStorage\n  # It's based on a great library https://github.com/jeromegn/Backbone.localStorage\n  # with some specific methods.\n  #\n  # Create your collection of this type:\n  #\n  # class Dreams extends Backbone.Collection\n  #   initialize: ->\n  #     @storage = new Offline.Storage('dreams', this)\n  #\n  # After that your collection will work offline.\n  #\n  # Instance attributes:\n  # @name - storage name\n  # @sync - instance of Offline.Sync\n  # @allIds - index of ids for the collection\n  # @destroyIds - index for destroyed models\n  class Offline.Storage\n\n    # Name of storage and collection link are required params\n    constructor: (@name, @collection, options = {}) ->\n      @support = @isLocalStorageSupport()\n      @allIds = new Offline.Index(@name, this)\n      @destroyIds = new Offline.Index(\"#{@name}-destroy\", this)\n      @sync = new Offline.Sync(@collection, this)\n      @keys = options.keys || {}\n      @autoPush = options.autoPush || false\n\n    # Test from modernizr: https://github.com/Modernizr/Modernizr/blob/master/modernizr.js\n    # Normally, we could not test that directly and need to do a\n    #   `('localStorage' in window) && ` test first because otherwise Firefox will\n    #   throw bugzil.la/365772 if cookies are disabled\n    #\n    # Also in iOS5 Private Browsing mode, attempting to use localStorage.setItem\n    # will throw the exception:\n    #   QUOTA_EXCEEDED_ERRROR DOM Exception 22.\n    # Peculiarly, getItem and removeItem calls do not throw.\n    isLocalStorageSupport: ->\n      try\n        localStorage.setItem('isLocalStorageSupport', '1')\n        localStorage.removeItem('isLocalStorageSupport')\n        true\n      catch e\n        false\n\n    # Most implementations of HTML5 localStorage have a size limit of about 5MB.\n    # When data starts exceeding this limit, setting a key value throws the QUOTA_EXCEEDED_ERROR.\n    # in other cases localSync support will be stopped\n    setItem: (key, value) ->\n      try\n        localStorage.setItem key, value\n      catch e\n        if e.name is 'QUOTA_EXCEEDED_ERR'\n          @collection.trigger('quota_exceed')\n        else\n          @support = false\n\n    # Wrappers for localStorage methods\n    removeItem: (key) ->\n      localStorage.removeItem(key)\n\n    getItem: (key)->\n      localStorage.getItem(key)\n\n    # Add a model, giving it a unique GUID. Server id saving to \"sid\".\n    # Set a sync's attributes updated_at, dirty and add\n    create: (model, options = {}) ->\n      options.regenerateId = true\n      @save(model, options)\n\n    # Update a model into the set. Set a sync's attributes update_at and dirty.\n    update: (model, options = {}) ->\n      @save(model, options)\n\n    # Delete a model from the storage\n    destroy: (model, options = {}) ->\n      @destroyIds.add(sid) unless options.local or (sid = model.get('sid')) is 'new'\n      @remove(model, options)\n\n    find: (model, options = {}) ->\n      JSON.parse @getItem(\"#{@name}-#{model.id}\")\n\n    # Returns the array of all models currently in the storage.\n    # And refreshes the storage into background\n    findAll: (options = {}) ->\n      unless options.local\n        if @isEmpty() then @sync.full(options) else @sync.incremental(options)\n      JSON.parse(@getItem(\"#{@name}-#{id}\")) for id in @allIds.values\n\n    s4: ->\n      (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1)\n\n    incrementId: 0x1000000\n    localId1: ((1+ Math.random()) * 0x100000 | 0).toString(16).substring(1)\n    localId2: ((1+ Math.random()) * 0x100000 | 0).toString(16).substring(1)\n\n    mid: ->\n       ((new Date).getTime()/1000 | 0).toString(16) + @localId1 + @localId2 + (++@incrementId).toString(16).substring(1)\n\n    guid: ->\n      @s4() + @s4() + '-' + @s4() + '-' + @s4() + '-' + @s4() + '-' + @s4() + @s4() + @s4()\n\n    save: (item, options = {}) ->\n      if options.regenerateId\n        id = if options.id is 'mid' then @mid() else @guid()\n        item.set(sid: item.attributes?.sid || item.attributes?.id || 'new', id: id)\n      item.set(updated_at: (new Date()).toJSON(), dirty: true) unless options.local\n\n      @replaceKeyFields(item, 'local')\n      @setItem \"#{@name}-#{item.id}\", JSON.stringify(item)\n      @allIds.add(item.id)\n\n      @sync.pushItem(item) if @autoPush and !options.local\n      item\n\n    remove: (item, options = {}) ->\n      @removeItem \"#{@name}-#{item.id}\"\n      @allIds.remove(item.id)\n\n      sid = item.get('sid')\n      @sync.flushItem(sid) if @autoPush and sid isnt 'new' and !options.local\n\n      item\n\n    isEmpty: ->\n      @getItem(@name) is null\n\n    # Clears the current storage\n    clear: ->\n      keys = Object.keys(localStorage)\n      collectionKeys = _.filter keys, (key) => (new RegExp @name).test(key)\n      @removeItem(key) for key in collectionKeys\n      record.reset() for record in [@allIds, @destroyIds]\n\n    # Replaces local-keys to server-keys based on options.keys.\n    replaceKeyFields: (item, method) ->\n      if Offline.onLine()\n        item = item.attributes if item.attributes\n\n        for field, collection of @keys\n          replacedField = item[field]\n\n          if !/^\\w{8}-\\w{4}-\\w{4}/.test(replacedField) or method isnt 'local'\n            newValue = if method is 'local'\n              wrapper = new Offline.Collection(collection)\n              wrapper.get(replacedField)?.id\n            else\n              collection.get(replacedField)?.get('sid')\n            item[field] = newValue unless _.isUndefined(newValue)\n      item\n\n  # Sync collection with a server. All server requests delegated to 'Backbone.sync'\n  # It provides a backward-compability. If your application is working with 'Backbone.sync'\n  # it'll be working with a 'Offline.sync'\n  #\n  # @storage = new Offline.Storage('dreams', this)\n  # @storage.sync - access to class instance through Offline.Storage\n  class Offline.Sync\n    constructor: (collection, storage) ->\n      @collection = new Offline.Collection(collection)\n      @storage = storage\n\n    ajax: (method, model, options) ->\n      if Offline.onLine()\n        @prepareOptions(options)\n        return Backbone.ajaxSync(method, model, options)\n      else\n        @storage.setItem('offline', 'true')\n\n    # @storage.sync.full() - full storage synchronization\n    # 1. clear collection and store\n    # 2. load new data\n    full: (options = {}) ->\n      @ajax 'read', @collection.items, _.extend {}, options,\n        success: (response) =>\n          if @storage.collection.parse\n          \tresponse = @storage.collection.parse(response)\n          @storage.clear()\n          @collection.items.reset([], silent: true)\n          @collection.items.create(item, silent: true, local: true, regenerateId: true) for item in response\n          @collection.items.trigger('reset') unless options.silent\n          options.success(response) if options.success\n\n    # @storage.sync.incremental() - incremental storage synchronization\n    # 1. pull() - request data from server\n    # 2. push() - send modified data to server\n    incremental:(options = {}) ->\n      @pull _.extend {}, options, success: => @push()\n\n    # Runs incremental sync when storage was offline\n    # after current request therefore don't duplicate requests\n    prepareOptions: (options) ->\n      if @storage.getItem('offline')\n        @storage.removeItem('offline')\n        success = options.success\n        options.success = (response) =>\n          success(response)\n          @incremental()\n\n    # Requests data from the server and merges it with a collection.\n    # It's useful when you want to refresh your collection and don't want to reload it completely.\n    # If response does not include any local ids they will be removed\n    # Local data will be compared with a server's response using updated_at field and new objects will be created\n    #\n    # @storage.sync.pull()\n    pull: (options = {}) ->\n      @ajax 'read', @collection.items, _.extend {}, options,\n        success: (response) =>\n          if @storage.collection.parse\n          \tresponse = @storage.collection.parse(response)\n          @collection.destroyDiff(response)\n          @pullItem(item) for item in response\n          options.success(response) if options.success\n\n    pullItem: (item) ->\n      local = @collection.get(item.id)\n      if local\n        @updateItem(item, local)\n      else\n        @createItem(item)\n\n    createItem: (item) ->\n      unless _.include(@storage.destroyIds.values, item.id.toString())\n        item.sid = item.id\n        delete item.id\n        @collection.items.create(item, local: true)\n\n    updateItem: (item, model) ->\n      if (new Date(model.get 'updated_at')) < (new Date(item.updated_at))\n        delete item.id\n        model.save(item, local: true)\n\n    # Use to send modifyed data to the server\n    # You can use it manually for sending changes\n    #\n    # @storage.sync.push()\n    #\n    # At first, method gets all dirty-objects (added or updated)\n    # and sends every object to server using 'Backbone.sync' method\n    # after that it sends deleted objects to the server\n    push: ->\n      @pushItem(item) for item in @collection.dirty()\n      @flushItem(sid) for sid in @storage.destroyIds.values\n\n    pushItem: (item) ->\n      @storage.replaceKeyFields(item, 'server')\n      localId = item.id\n      delete item.attributes.id\n      [method, item.id] = if item.get('sid') is 'new' then ['create', null] else ['update', item.attributes.sid]\n\n      @ajax method, item, success: (response) =>\n        item.set(sid: response.id) if method is 'create'\n        item.save {dirty: false}, {local: true}\n\n      item.attributes.id = localId; item.id = localId\n\n    flushItem: (sid) ->\n      model = @collection.fakeModel(sid)\n      @ajax 'delete', model, success: (model, response, opts) =>\n        @storage.destroyIds.remove(sid)\n\n  # Manage indexes storing to localStorage.\n  # For example 1,2,3,4,5,6\n  class Offline.Index\n\n    # @name - index name\n    # @storage.setItem 'dreams', '1,2,3,4'\n    # records = new Offline.Index('dreams', @storage)\n    # records.values - an array based on @storage data\n    # => ['1', '2', '3', '4']\n    constructor: (@name, @storage) ->\n      store = @storage.getItem(@name)\n      @values = (store && store.split(',')) || []\n\n    # Add a new item to the end of list\n    # records.add '5'\n    # records.values\n    # => ['1', '2', '3', '4', '5']\n    add: (itemId) ->\n      unless _.include(@values, itemId.toString())\n        @values.push itemId.toString()\n      @save()\n\n    # Remove element from a list of values\n    # records.remove '3'\n    # records.values\n    # => ['1', '2', '4', '5']\n    remove: (itemId) ->\n      @values = _.without @values, itemId.toString()\n      @save()\n\n    save: ->\n      @storage.setItem @name, @values.join(',')\n\n    reset: ->\n      @values = []\n      @storage.removeItem @name\n\n  # Uses as wrapper for 'Backbone.Collection'\n  class Offline.Collection\n\n    # @items is an instance of 'Backbone.Collection'\n    constructor: (@items) ->\n\n    # Returns models marked as \"dirty\" - {dirty: true}\n    # That is needy for synchronization with server\n    dirty: ->\n      @items.where dirty: true\n\n    # Get a model from the set by sid.\n    get: (sid) ->\n      @items.find (item) -> item.get('sid') is sid\n\n    # destory old models from the collection which have not marked as \"new\"\n    destroyDiff: (response) ->\n      diff = _.difference(_.without(@items.pluck('sid'), 'new'), _.pluck(response, 'id'))\n      @get(sid)?.destroy(local: true) for sid in diff\n\n    # Use to create a fake model for the set\n    fakeModel: (sid) ->\n      model = new Backbone.Model(id: sid)\n      model.urlRoot = @items.url\n      model\n\n","\n#    ISOConv has some features for easily converting between language codes.\n\ndo (global = window, _, Backbone) ->\n  class ISOConv\n    VERSION: '0.0.1'\n\n    constructor: () ->\n      for k, v of @ISOs\n        if not @reverseISOs[v]?\n          @reverseISOs[v] = k\n\n    reverseISOs:\n      \"nob\": \"no\"\n\n    ISOs:\n      \"no\": \"nob\"\n      \"nb\": \"nob\"\n      \"nn\": \"nno\"\n      \"sv\": \"swe\"\n      \"fi\": \"fin\"\n      \"en\": \"eng\"\n\n    # set some initial special things, otherwise the rest are automatically\n    # compiled from @ISOs\n\n    two_to_three: (two) ->\n      if @ISOs[two]?\n        return @ISOs[two]\n      else\n        return two\n\n    three_to_two: (three) ->\n      if @reverseISOs[three]?\n        return @reverseISOs[three]\n      else\n        return three\n\n  global.ISOs = new ISOConv()\n\n","class LoadingDepsFailed extends Error\n  constructor: (@params...) ->\n    super\n\nmodule.exports = class LoadingTracker\n  isReady: () ->\n    for name, status of @dependencies\n      if not status\n        return false\n    console.log \"In readiness.\"\n    return true\n\n  waitForDeps: (opts = {}) ->\n    # TODO: minimum duration to keep trying for, and then redirect if nothing\n    # works\n    if @isReady()\n      if opts.ready?\n        return opts.ready()\n      else\n        return true\n    else\n      @showLoading()\n\n    @check_handler = setInterval(\n      () =>\n        if @isReady()\n          if opts.extra_test?\n            if not opts.extra_test()\n              return false\n\n          clearInterval(@check_handler)\n          @hideLoading()\n\n          if opts.ready?\n            return opts.ready()\n          else\n            return false\n\n        if opts.timeout?\n          if total_wait > opts.timeout\n            clearInterval(@check_handler)\n            @hideLoading()\n            if opts.failed?\n              return opts.failed()\n            else\n              throw new LoadingDepsFailed()\n    , 500)\n  checkDeps: () ->\n    if @isReady()\n      @hideLoading()\n\n  markReady: (name) ->\n    @dependencies[name] = true\n    @checkDeps()\n\n  hideLoading: () ->\n    interval = setInterval(() ->\n      $.mobile.loading('hide')\n      clearInterval(interval)\n    ,1)\n    return false\n\n  showLoading: () ->\n    interval = setInterval(() ->\n      $.mobile.loading('show', {\n        text: 'Loading...',\n        textVisible: true,\n        theme: 'a',\n        html: \"\"\n      })\n      clearInterval(interval)\n    ,1)\n    return false\n\n  constructor: (deps) ->\n    @dependencies = deps\n","SoundLoadingTemplate = require '../views/templates/sound_loading'\n\nmodule.exports = class AudioPlayer\n\n  playPath: (path, opts={}) ->\n    # TODO: user feedback about whether audio is downloaded or not.\n\n    loading = $(document).find('#sound_loading_bar')\n    if loading.length == 0\n      $('body').append SoundLoadingTemplate\n      loading = $('body').find('#sound_loading_bar')\n    \n    error_event = () =>\n      console.log \"Audio playing error\"\n      return false\n\n    finished_event = () =>\n      loading.fadeOut()\n      opts.finished() if opts.finished?\n      return false\n\n    begin_event = () =>\n      loading.fadeOut()\n      opts.begin() if opts.begin?\n      return false\n\n    whileload_event = () ->\n      if this.bytesTotal >= this.bytesLoaded\n        if loading.css('display') == 'none'\n          loading.fadeIn()\n      if this.bytesTotal == this.bytesLoaded\n        loading.fadeOut()\n\n    if soundManager.enabled\n      sound_id = \"concept_audio\"\n\n      # Have to have different behavior for html5-only, because of iOS\n      # limitations\n      if soundManager.html5Only\n        if app.debug\n          console.log \"html5 only\"\n        sound_obj = soundManager.getSoundById(sound_id)\n        # grab sound obj if it hasn't been created yet\n        if not sound_obj\n          if app.debug\n            console.log \"creating sound obj\"\n          sound_obj = soundManager.createSound\n            id: sound_id\n            url: path\n            onfinish: finished_event\n            onerror: error_event\n            onplay: begin_event\n            whileloading: whileload_event\n          sound_obj._a.playbackRate = opts.rate\n        else\n          if app.debug\n            console.log \"sound obj exists\"\n          # update the onfinished event\n          sound_obj.options.onfinish = finished_event\n          sound_obj.options.onerror = error_event\n          sound_obj.options.onplay = begin_event\n          sound_obj.options.whileloading = whileload_event\n\n        if sound_obj.url == path\n          if app.debug\n            console.log \"concept.playAudio: repeat\"\n        else\n          if app.debug\n            console.log \"concept.playAudio: no repeat\"\n          sound_obj.url = path\n          window.so = sound_obj\n\n        sound_obj.play({position:0})\n      else\n        if app.debug\n          console.log \"creating sound with flash\"\n        soundManager.destroySound(sound_id)\n        s = soundManager.createSound\n          id: sound_id\n          url: path\n          onfinish: finished_event\n          onerror: error_event\n          onplay: begin_event\n          whileloading: whileload_event\n\n        s.play({position:0})\n      return s\n\n    # here's what to do if there was no sound or sound manager failed somehow\n    if opts.finished\n      opts.finished()\n    else\n      return false\n  \n","Category model.\n\n    module.exports = class Category extends Backbone.Model\n\nCompatibility with old version of bootstrap\n\n      idAttribute: \"c_id\"\n\n      defaults:\n        children: []\n        activities: [ ]\n\n      initialize: () ->\n\n      getConcepts: (args = {}) ->\n        query = _.extend {semantics: @get('semantics')}, args\n        concepts = app.conceptdb.where(query)\n\n        if @attributes.order_by?\n          _order = @attributes.order_by\n          sorter = (a) =>\n            _a_attr = a.attributes || {}\n            _a_ext = _a_attr.extra_attributes || {}\n            _a_ord = _a_ext[_order]\n            return _a_ord\n        else\n          sorter = (c) -> c.get('concept_value')\n\n        sorted = _.sortBy concepts, sorter\n\n        return sorted\n\n      children: () ->\n        cs = @.get('children')\n        if cs.length == 0\n          return false\n        else\n          return (new Category c for c in cs)\n\nThe category image is selected from media.\n      \n      hasThumbnail: (opts = {}) ->\n        if not opts.device\n          device = app.device_type\n        else\n          device = opts.device\n    \n        if not opts.size\n          size = app.media_size\n        else\n          size = opts.size\n        \n        # TODO: maybe preference to image size over device? i.e., if large/tablet\n        # doesn't exist, but large/mobile does, take that one\n        has_media = @.get('media')\n\n        if not has_media?\n          return false\n\n        if 'icon' of has_media\n          if has_media.icon.length > 0\n    \n            images_for_device = _.filter has_media.icon, (i) ->\n              return i.size == size and i.device == device\n    \n            if images_for_device.length == 0\n              return has_media.icon[0].path\n    \n            if images_for_device.length > 0\n              return images_for_device[0].path\n    \n            return images_for_device\n        return false\n\n      hasImage: (opts = {}) ->\n        if not opts.device\n          device = app.device_type\n        else\n          device = opts.device\n    \n        if not opts.size\n          size = app.media_size\n        else\n          size = opts.size\n    \n        # TODO: maybe preference to image size over device? i.e., if large/tablet\n        # doesn't exist, but large/mobile does, take that one\n        has_media = @.get('media')\n\n        if not has_media?\n          return false\n\n        if 'image' of has_media\n          if has_media.image.length > 0\n    \n            images_for_device = _.filter has_media.image, (i) ->\n              return i.size == size and i.device == device\n    \n            if images_for_device.length == 0\n              return has_media.image[0].path\n    \n            if images_for_device.length > 0\n              return images_for_device[0].path\n    \n            return images_for_device\n        return false\n\n","The category list maintains all the dependencies of the main word categories,\nand uses them to generate the main menu.\n\n    Category = require 'models/category'\n\n    module.exports = class CategoryList extends Backbone.Collection\n      model: Category\n\n      url: () ->\n        return app.server.path + \"/data/categories.json\"\n\n      parse: (response, opts) ->\n        return response.categories\n\n      initialize: () ->\n          # @storage = new Offline.Storage('word-categories', @)\n","module.exports = class Collection extends Backbone.Collection\n\n  model: require './model'\n","LeksaConceptTemplate = require '../views/templates/leksa_concept'\nSoundLoadingTemplate = require '../views/templates/sound_loading'\n\nmodule.exports = class Concept extends Backbone.Model\n  # Compatibility with old version of bootstrap\n  idAttribute: \"c_id\"\n\n  defaults:\n    fails: false\n    last_sound_path: ''\n\n  successRateInUserLog: () ->\n    log_entries_for_concept = app.userprogression.where\n      question_concept_value: @get('concept_value')\n    correct_values = app.userprogression.where\n      question_concept_value: @get('concept_value')\n      question_correct: true\n\n    total = log_entries_for_concept.length\n    count_correct = correct_values.length\n    if total > 0\n      return count_correct/total\n    else\n      return false\n\n  hasThumbnail: () ->\n    thumbs = false\n    has_media = @.get('media')\n    if 'image' of has_media\n      if has_media.image.length > 0\n        thumbs = _.filter has_media.image, (i) ->\n          return i.size == 'thumbnail'\n        if thumbs.length == 0\n          thumbs = false\n    return thumbs\n\n  hasVideo: (opts = {}) ->\n    if not opts.device\n      device = app.device_type\n    else\n      device = opts.device\n\n    if not opts.size\n      size = app.media_size\n    else\n      size = opts.size\n\n    if not opts.format\n      format = app.video_format\n    else\n      format = opts.format\n\n    # TODO: maybe preference to image size over device? i.e., if large/tablet\n    # doesn't exist, but large/mobile does, take that one\n\n    has_media = @.get('media')\n    if 'videos' of has_media\n      if has_media.videos.length > 0\n\n        videos_for_device = _.filter has_media.videos, (i) ->\n          return i.size == size and i.device == device and i.format == format\n\n        if videos_for_device.length == 0\n          return false\n\n        if videos_for_device.length > 0\n          return videos_for_device[0]\n\n        return videos_for_device\n\n    if opts.no_default\n      return false\n\n    return \"/static/images/missing_concept_image.jpg\"\n\n  hasGif: (opts = {}) ->\n    \n  hasImage: (opts = {}) ->\n    if not opts.device\n      device = app.device_type\n    else\n      device = opts.device\n\n    if not opts.size\n      size = app.media_size\n    else\n      size = opts.size\n\n    if not opts.gif\n      gif = false\n    else\n      gif = true\n\n    # TODO: maybe preference to image size over device? i.e., if large/tablet\n    # doesn't exist, but large/mobile does, take that one\n    has_media = @.get('media')\n    if 'image' of has_media\n      if has_media.image.length > 0\n\n        images_for_device = _.filter has_media.image, (i) ->\n          return i.size == size and i.device == device\n\n        if gif\n          gifs = _.filter images_for_device, (i) ->\n            return i.path.search('.gif') > -1\n          if gifs.length > 0\n            return gifs[0].path\n        else\n          images_for_device = _.filter images_for_device, (i) ->\n            return i.path.search('.gif') == -1\n\n        if images_for_device.length == 0\n          return has_media.image[0].path\n\n        if images_for_device.length > 0\n          return images_for_device[0].path\n\n        return images_for_device\n\n    if opts.no_default\n      return false\n\n    return \"/static/images/missing_concept_image.jpg\"\n\n  getTranslationsToLang: (lang) ->\n    @getTranslations().filter (c) =>\n      c.get('language') == lang\n\n  getTranslations: () ->\n    @collection.filter (comp_concept) =>\n      if _.contains( @.get('translations')\n                   , comp_concept.get('c_id')\n                   )\n        return true\n      else\n        return false\n\n  hasAudio: () ->\n    # Find an audio path in the media, however track the previous one that was\n    # selected, and do not repeat if possible. Otherwise if there is only one\n    # audio track, that will just play always.\n    #\n\n    has_media = @.get('media')\n    is_not_last_path = (s) => s.path != @last_sound_path\n\n    if app.options.getSetting('enable_audio') and has_media.audio?\n      if has_media.audio.length > 0\n\n        audios = has_media.audio\n\n        if audios.length > 1\n          audios = _.filter(has_media.audio, is_not_last_path)\n\n        has_audio_file = _.first(_.shuffle(audios)).path\n\n        if audios.length > 1\n          @last_sound_path = has_audio_file\n\n        return has_audio_file\n\n    return false\n  \n  playAudio: (opts={}) ->\n    # TODO: user feedback about whether audio is downloaded or not.\n    has_audio_file = @hasAudio()\n    if has_audio_file\n      app.audio.playPath(has_audio_file, opts)\n\n  render_concept: () ->\n    concept_media_value = @.get('concept_value')\n\n    if @.get('concept_type') == 'img'\n      concept_media_value = @hasImage()\n    \n    LeksaConceptTemplate({\n      concept: @\n      concept_type: @.get('concept_type')\n      concept_value: concept_media_value\n    })\n","Concept = require 'models/concept'\n\nmodule.exports = class ConceptDB extends Backbone.Collection\n  model: Concept\n  idAttribute: \"c_id\"\n\n  url: () ->\n    return app.server.path + \"/data/concepts.json\"\n\n  initialize: () ->\n    # @storage = new Offline.Storage('concepts', @)\n    # if navigator.onLine\n    #   @storage.sync.pull\n    #     success: () =>\n    #       app.loadingTracker.markReady('concepts.json')\n    #       console.log \"fetched concepts.json (#{app.conceptdb.models.length})\"\n  \n  getByCid: (cid) ->\n    ms = @models.filter (m) =>\n      m.cid == cid\n\n    if ms.length > 0\n      ms[0]\n    else\n      false\n\n  whereSemantics: (sets, extra_filter) ->\n    # Really the only reliable way to check the type of an object...\n    #\n    _type = Object.prototype.toString.call(sets)\n    _type_str = Object.prototype.toString.call(\"str\")\n    if _type == _type_str\n      sets = [sets]\n\n    filtered = @models.filter (m) =>\n      sem_match = _.intersection( m.get('semantics')\n                                , sets\n                                )\n      sem_match.length > 0\n    result_collection = new ConceptDB()\n    result_collection.add filtered\n\n    if extra_filter\n      more_filtered = result_collection.where(extra_filter)\n      more_collection = new ConceptDB()\n      more_collection.add more_filtered\n      return more_collection\n    return result_collection\n\n  titleImages: (semantic_set) ->\n    concepts = @where({'semantics': [semantic_set]})\n                     .filter (concept) -> concept.hasThumbnail()\n\n    if concepts.length > 0\n      images = concepts[0].hasThumbnail()\n      return images\n\n    return false\n\n  where: (params) ->\n    # TODO: features\n    if 'semantics' of params\n      new_coll = @whereSemantics(params.semantics)\n      delete params.semantics\n      if Object.keys(params).length > 0\n        return new_coll.where(params)\n      else\n        return new_coll.models\n\n    super\n\n  getTranslationsOf: (concept) ->\n    @models.filter (comp_concept) =>\n      if _.contains( concept.get('translations')\n                   , comp_concept.get('id')\n                   )\n        return true\n      else\n        return false\n","module.exports = class LevelComplete extends Error\n  constructor: (@params...) ->\n    super\n","module.exports = class NoMoreProgression extends Error\n  constructor: (@params...) ->\n    super\n\n","NoMoreProgression = require '/models/exceptions/progression_cycle_done'\n\nmodule.exports = orderConceptsByList = (q, concepts, ordering) ->\n\n  if q.attributes.type == 'image_to_word'\n    get_canonical_concept_value = (c) =>\n      if c? and c\n        answer_lang = q.attributes.filters.to_language\n        txls = _.first c.getTranslationsToLang(answer_lang)\n        return txls.get('concept_value')\n      else\n        return false\n  else\n    chop_concept = (a) -> a\n    get_canonical_concept_value = (c) -> c.get('concept_value')\n\n  if app.debug\n    console.log \"#{q.cid} - #{user_prog_for_question.length} run-throughs\"\n\n  if ordering.length == 0\n    return concepts\n\n  last_concept = app.userprogression.last()\n  if app.debug\n    console.log \"Last concept: \"\n    console.log last_concept\n\n  concepts_by_ordering = []\n  for c in ordering\n    _conc = _.first(concepts.filter((v) => get_canonical_concept_value(v) == c))\n    if _conc\n      concepts_by_ordering.push(_conc)\n\n  if app.debug\n    f_strings = ordered_by_frequency.map (f) ->\n      \"#{progressionCorrectCountForConcept(f)} - #{f.get('concept_value')}\"\n\n    if f_strings.length > 0\n      console.log f_strings.join('\\n')\n\n  if concepts_by_ordering.length == 0\n    if app.debug\n      console.log \"No more concepts fitting progression\"\n    err = new NoMoreProgression()\n    throw err\n\n  concepts_by_ordering\n\n","Helpful TODOs at end of module...\n\n# Helper function for user progression concept sorting\n\nThe point of this piece is to integrate the user progression with the way that\nconcepts are selected for a given question, taking into account the following\nthings: \n\n1.) How many times has the question concept been displayed?\n  - More than four times? -> Remove!\n  - Less than four times? -> Sort by display count.\n\n2.) What was the last question concept displayed?\n\n3.) Is there a user progression?\n\n4.) Is the user done with all of the concepts in the progression?\n\nSo, let's get going... Define the module as a function expect a `question`,\nlist of `concepts`, and the `user_prog_for_question`.\n\n    NoMoreProgression = require '/models/exceptions/progression_cycle_done'\n\n    module.exports = orderConceptsByProgression = (q, concepts) ->\n\nGrab only the user progression for this question.\n\n      user_prog_for_question = app.userprogression.logs_for_question_in_cycle(q, q.get('cycle'))\n\n      if app.debug\n        console.log \"#{q.cid} - #{user_prog_for_question.length} run-throughs\"\n\nIf there's nothing in the user progression, great, no need to sort!\n\n      if user_prog_for_question.length == 0\n        return concepts\n\n      max_repeats = _.max (u.get('cycle') for u in user_prog_for_question)\n\n      if not max_repeats\n        max_repeats = false\n\n      if app.debug\n        console.log \"Currently at cycle <#{max_repeats}>\"\n\nFor a user progression, figure out how many times this question concept has\nbeen answered as correct by the user.\n\n      progressionCorrectCountForConcept = (c) =>\n        zups = app.userprogression.correctLogsForConceptInQuestion(c, q)\n        if max_repeats\n          zups = zups.filter (up) =>\n            up.get('cycle') == max_repeats\n        return zups.length\n\nRemove a concept from the cycle once it has been displayed 4 times.\n\n      if q.get('repetitions')\n        reps = parseInt q.get('repetitions')\n        if app.debug\n          console.log \"question repetition count:\" + q.get('repetitions')\n      else\n        reps = 3\n        q.set('repetitions', reps)\n        if app.debug\n          console.log \"question repetition not specified, default 3\"\n\n      countLessRepetitions = (c) =>\n        progressionCorrectCountForConcept(c) < reps + 1\n\nTry to avoid repeats by excluding the last concept from the progression.\n\n      last_concept = app.userprogression.last()\n      if app.debug\n        console.log \"Last concept: \"\n        console.log last_concept\n\n      if last_concept\n        notLast = (c) =>\n          c.get('concept_value') != last_concept.get('question_concept_value')\n        excluding_last_concept = _.filter(concepts, notLast)\n\n        if excluding_last_concept.length == 0\n          excluding_last_concept = concepts\n      else\n        excluding_last_concept = concepts\n\nNow we sort by the amount of times the concept has been displayed-- giving\npreference to those that have been displayed less so far.\n\n      ordered_by_frequency = _.sortBy(\n        _.filter(excluding_last_concept, countLessRepetitions),\n        progressionCorrectCountForConcept\n      )\n\nUseful debugging info...\n\n      if app.debug\n        f_strings = ordered_by_frequency.map (f) ->\n            \"#{progressionCorrectCountForConcept(f)} - #{f.get('concept_value')}\"\n\n        if f_strings.length > 0\n          console.log f_strings.join('\\n')\n\nHere there may be a problem that there are no concepts fitting the progression,\nwhich means most likely that the user has completed the level. So, we return\nsomething anyway, but log an error.\n\n      if ordered_by_frequency.length == 0\n        if app.debug\n          console.log \"No more concepts fitting progression\"\n        err = new NoMoreProgression()\n        throw err\n\n      ordered_by_frequency\n\n# TODO:\n\nMaybe it's worth only considering the user progression of the last hour, or\nsomething like that?\n","module.exports = class Model extends Backbone.Model\n","    NoMoreProgression = require '/models/exceptions/progression_cycle_done'\n    LevelComplete = require '/models/exceptions/level_complete'\n\nThis module is somewhat complex, thus it is written in Literate Coffeescript.\n\nThis class is returned when a question is generated.\n\n    class QuestionInstance\n      constructor: (@generator, @question, @choices, @answer, @current_count,\n                    @question_total, @total_correct) ->\n        if app.debug\n          console.log \"created instance\"\n        if app.debug\n          console.log \"cIDs for answer concepts:\"\n          console.log (choice.cid for choice in @choices)\n        @choices = _.shuffle(@choices)\n\n## Question model\n\nThis is the only thing we need to export from this module.\n\n    module.exports = class Question extends Backbone.Model\n\nDetermine whether the user has completed this question, here, defined as\nanswering all concepts in level correctly at least once.\n\n      defaults:\n        cycle: 1\n        tries: 0\n\nHere we find out if the user completed the question.\n\n      cycle_for_progression: () ->\n        maximum = _.max(\n          (p.get('cycle') for p in app.userprogression.logs_for_question(@))\n        )\n        return _.max([maximum, 1])\n\nHow many correct answers are there for this question?\n\n      total_correct_answers_for_question: () ->\n        app.userprogression.where({\n          question_correct: true\n          question_category: @get('category')\n          question_category_level: @get('level')\n          cycle: @.get('cycle')\n        }).length\n\n      user_completed_question: (opts={}) ->\n        userprogression = app.userprogression\n        correct_count = 2\n\n        if opts.cycle\n          cycle = opts.cycle\n        else\n          cycle = @get('cycle')\n\nFilter user progression models for the current cycle, question ID, whether it\nwas correct. Then return all the question concepts for these logs.\n\n        # this only checks the current cycle, which should be incremented\n        # and stored unless user logs back in again\n        if userprogression.length > 0\n          logs_for_question = userprogression.correct_logs_for_question(@)\n            .filter (up) =>\n              up.get('cycle') == cycle\n          concepts_for_question = logs_for_question\n            .map (up) ->\n              up.get('question_concept')\n        else\n          return false\n\nHow many times was the concept correct for each question?\n\n        concepts = @select_question_concepts app.conceptdb\n\nFor each question concept, determine what amount the user correctly,\nif the amount is greater, append the correct amount to counts.\n        \n        correctsForCQW = (c, q, w) ->\n          app.userprogression.correctLogsForConceptInQuestionInCycle(c, q, cycle).length\n\n        counts = []\n        for c in concepts\n          corrects = correctsForCQW(c, @, cycle)\n          if corrects > correct_count\n            corrects = correct_count\n          counts.push corrects\n\nIf the sum of uniq'd counts is 1, then the level/question has been completed,\nand we increment the cycle one.\n\n        # this may need to move out of here, and to somewhere else, i.e.,\n        # checking whether the answer to an individual concept is correct, if\n        # it is then check whether incrementing can happen, and if so return\n        # about next level\n        if _.uniq(counts).length == 1\n          if _.max(counts) == correct_count and _.uniq(counts)[0] == correct_count\n            if not opts.cycle\n              console.log \"incrementing cycle.\"\n              @set('cycle', @get('cycle') + 1)\n            return true\n\n        return false\n\n      user_completed_cycle: () ->\n        userprogression = app.userprogression\n        correct_count = 2\n\n        if opts.cycle\n          cycle = opts.cycle\n        else\n          cycle = @get('cycle')\n\nFilter user progression models for the current cycle, question ID, whether it\nwas correct. Then return all the question concepts for these logs.\n\n        # this only checks the current cycle, which should be incremented\n        # and stored unless user logs back in again\n        if userprogression.length > 0\n          # TODO: rewrite to .where() once everything else is stable\n          logs_for_question = userprogression.correct_logs_for_question(@)\n            .filter (up) =>\n              up.get('cycle') == cycle\n          concepts_for_question = logs_for_question\n            .map (up) ->\n              up.get('question_concept')\n        else\n          return false\n\nHow many times was the concept correct for each question?\n\n        concepts = @select_question_concepts app.conceptdb\n\nFor each question concept, determine what amount the user correctly,\nif the amount is greater, append the correct amount to counts.\n        \n        correctsForCQW = (c, q, w) ->\n          app.userprogression.correctLogsForConceptInQuestionInCycle(c, q, cycle).length\n          \n        counts = []\n        for c in concepts\n          corrects = correctsForCQW(c, @, cycle)\n          if corrects > correct_count\n            corrects = correct_count\n          counts.push corrects\n\nHere we increment the cycle if the current question is compelte\n\n        if _.uniq(counts).length == 1\n          if _.max(counts) == correct_count and _.uniq(counts)[0] == correct_count\n            @set('cycle', @get('cycle') + 1)\n            return true\n\n        return false\n\n      # TODO: something problematic going on here\n      filter_concepts_by_media: (concepts, media_size) ->\n        filtered_concepts = _.filter concepts, (c) =>\n          if c.get('language') == 'img'\n            imgs = c.get('media').image\n            for i in imgs\n              if i.size == app.media_size\n                return true\n            return false\n          else if c.get('language') == 'mov'\n            imgs = c.get('media').video\n            for i in imgs\n              if i.size == app.media_size\n                return true\n            return false\n          else\n            return true\n\n        if filtered_concepts.length == 0\n          if app.debug\n            console.log \"* Unable to filter by media type because concepts do not\"\n            console.log \"  have a media type that matches device. Falling back to\"\n            console.log \"  whatever is available.\"\n          return concepts\n\n        return filtered_concepts\n\n      select_question_concepts_by_progression: (conceptdb) ->\n        userprog = app.userprogression\n        orderConceptsByProgression = require './helpers/concept_progression_sorter'\n        return orderConceptsByProgression(@,\n          @filter_concepts_by_media(\n            @select_question_concepts(conceptdb), app.media_size\n          )\n        )\n\n      select_question_concepts_by_ordering: (conceptdb, ordering) ->\n        orderConceptsByList = require './helpers/concept_by_ordering'\n        return orderConceptsByList(@,\n          @filter_concepts_by_media(\n            @select_question_concepts(conceptdb), app.media_size\n          ),\n          ordering\n        )\n\n      select_question_concepts: (conceptdb) ->\n        default_similarity = {\n          'features': false\n          'semantics': false\n        }\n\n        _filters = @get('filters')\n        _answer_sim = @get('answer_similarity') || default_similarity\n\n        _from = _filters.from_language\n        _to   = _filters.to_language\n\n        # Possible question prompts matching filters\n        q_concepts = conceptdb.filter (concept) =>\n          # remove concepts that have failed before\n          if concept.get('fails') == true\n            return false\n          semantics  =  _.intersection( concept.get('semantics')\n                                      , _filters.semantics\n                                      )\n          target_language = concept.get('language') == _from\n          # TODO: feature match?\n          if target_language and semantics.length > 0\n            return true\n          else\n            return false\n        return q_concepts\n\n      find_concepts: (conceptdb, opts={}) ->\n\n        if not opts.repeat_count?\n          repeat_count = 0\n\n        if repeat_count > 5\n          _err = new Error()\n          console.log \"Uh oh\"\n          throw _err\n\n        userprogression = app.userprogression\n        # handle edge case for tail call immediately.\n        # somehow this has failed several times, so...\n        if @tries > 3\n          _error_msg = \"Failed generating question #{@get('category')} - #{@get('level')}\"\n          console.log _error_msg\n          window.client_log.error(_error_msg)\n          @set('fails', true)\n          # TODO: recover and regenerate\n          return false\n\n        userlang = ISOs.two_to_three app.options.getSetting('help_language')\n\n        # TODO: include userprogression\n        #\n        if @.get('answers')\n          max_answers = @.get('answers')\n        else\n          max_answers = 4\n\n        answer_possibilities = []\n\n        default_similarity = {\n          'features': false\n          'semantics': false\n        }\n\n        _filters = @get('filters')\n        _answer_sim = @get('answer_similarity') || default_similarity\n\n        _from = _filters.from_language\n        _to   = _filters.to_language\n\n        if _to == \"USERLANG\"\n          console.log \"USERLANG found, replacing with user help lang\"\n          console.log userlang\n          _to = userlang\n\n        question_concepts = @select_question_concepts(conceptdb)\n\n        if @attributes.type == 'word_to_image'\n          question_concepts = @filter_concepts_by_media(question_concepts, app.media_size)\n\n        try\n          if opts.ordering? and opts.ordering\n            q_concepts = @select_question_concepts_by_ordering(question_concepts, opts.ordering)\n          else\n            q_concepts = @select_question_concepts_by_progression(question_concepts)\n          if app.debug\n            console.log q_concepts\n        catch err\n          if err instanceof NoMoreProgression\n            # check if user completed the question-- if so, then we need the\n            # next level\n            # increment cycle\n            # go again\n            if app.debug\n              console.log \"got NoMoreProgression...\"\n            if @user_completed_question()\n              # next question\n              throw new LevelComplete\n            else\n              # keep going\n              return @find_concepts(conceptdb, {repeat_count: repeat_count+1})\n\n        # Select a question concept\n        if q_concepts.length > 0\n          if not opts.ordering?\n            question = _.shuffle(q_concepts)[0]\n            alternates = _.shuffle(q_concepts).slice(1)\n          else\n            question = _.first q_concepts\n            alternates = _.shuffle(q_concepts).slice(1)\n          # Alternate question concepts that match the question criteria\n        else\n          console.log \"No concepts left for question.\"\n          console.log _filters\n          return false\n\n        # Here are the direct translations of our question prompt\n        actual_answer_concepts = @filter_concepts_by_media(\n          question.getTranslationsToLang(_to),\n          app.media_size\n        )\n\n        if actual_answer_concepts.length == 0\n          # skajje\n          _error_msg = \" * No translations to #{_to} for #{question.get('concept_value')}\"\n          console.log _error_msg\n          window.client_log.error(_error_msg)\n          question.set('fails', true)\n          # TODO: recover and regenerate\n          @tries += 1\n          return @find_concepts(conceptdb)\n\n        filterByLang = (lang, concepts) ->\n          concepts.filter (o) => o.get('language') == lang\n\n        # Get translations of the alternate question concepts; these should have a\n        # semantic match and thus be a little more difficult.\n        alternate_translations = filterByLang _to, _.flatten(\n          conceptdb.getTranslationsOf alt for alt in alternates\n        )\n        \n        answer_possibilities = alternate_translations\n\n        actual_answer = _.shuffle(actual_answer_concepts)[0]\n        \n        # Make some potential incorrect answers to fill things in.\n\n        # here we get answers that are similar as described in the answer similarity\n        potential_incorrect_answers = conceptdb.filter (concept) =>\n\n          target_language = concept.get('language') == _to\n          # TODO: feature match?\n          if _answer_sim.semantics\n            semantics  = _.intersection( concept.get('semantics')\n                                       , _answer_sim.semantics\n                                       )\n            if target_language and concept != actual_answer and semantics.length > 0\n              return true\n            else\n              return false\n          else\n            if target_language and concept != actual_answer\n              return true\n            else\n              return false\n\n        if @attributes.type == 'word_to_image'\n          chop_concept = (a) -> a.split('/').slice(-1)[0]\n          get_canonical_concept_value = (c) =>\n            question_concept_value = question.get('concept_value')\n            question_lang = question.get('language')\n            txls = _.first c.getTranslationsToLang(question_lang)\n            return txls.get('concept_value')\n        else\n          chop_concept = (a) -> a\n          get_canonical_concept_value = (c) -> c.get('concept_value')\n\n\n        # TODO: this results in problems, image names are no longer the same, so need to\n        # see if it's unique by the original concept word; if word in image translations,\n\n        uniq_for_concept_value = (cs) =>\n          _cs = []\n          _cvs = []\n          for c in cs\n            _cv = get_canonical_concept_value c\n            if _cv in _cvs\n              continue\n            _cs.push c\n            _cvs.push _cv\n          return _cs\n\n        potential_incorrect_answers = _.shuffle(\n          uniq_for_concept_value potential_incorrect_answers\n        )\n\n        answer_possibilities = @filter_concepts_by_media(answer_possibilities, app.media_size)\n\n        answer_possibilities = answer_possibilities.slice(0, max_answers - 1)\n\n        all_answer_poss = [actual_answer]\n        all_answer_poss = all_answer_poss.concat answer_possibilities\n        all_answer_poss = uniq_for_concept_value all_answer_poss\n\nFill the array with missing answers if we have too few.\n\n        if all_answer_poss.length < max_answers\n          if app.debug\n            console.log \"Things came short, filling in...\"\n          \n          difference = max_answers - all_answer_poss.length\n          concept_values = all_answer_poss.map get_canonical_concept_value\n\n          for c in _.range(0, difference)\n            act_ans = get_canonical_concept_value(actual_answer)\n\n            for a in _.shuffle(potential_incorrect_answers)\n              pot_ans = get_canonical_concept_value(a)\n\n              if (pot_ans != act_ans) and !(a in all_answer_poss)\n                all_answer_poss.push a\n                break\n\n        if question and all_answer_poss.length > 0 and actual_answer\n          concepts_left = concepts_total - q_concepts.length\n          concepts_total = question_concepts.length\n          inst = new QuestionInstance( @\n                                     , question\n                                     , all_answer_poss\n                                     , actual_answer\n                                     , concepts_left\n                                     , concepts_total\n                                     , @total_correct_answers_for_question()\n                                     )\n\n        else\n          console.log \" * Couldn't generate a question instance for #{@.get('name')}\"\n          console.log \"   removing question from cycle.\"\n          inst = false\n          @.set('fails', true)\n\n        return inst\n","Question = require 'models/question'\nLevelComplete = require '/models/exceptions/level_complete'\n\nmodule.exports = class QuestionDB extends Backbone.Collection\n  model: Question\n\n  url: () ->\n    return app.server.path + \"/data/leksa_questions.json\"\n\n  initialize: () ->\n    @fetch\n      success: () =>\n        app.loadingTracker.markReady('leksa_questions.json')\n        mod_count = app.questiondb.models.length\n        console.log \"fetched leksa_questions.json (#{mod_count})\"\n\n  removeNonFunctioning: (qs) ->\n    return qs.filter (c) ->\n      _fails = c.get('fails')\n      if not _fails\n        return true\n      if _fails and _fails == false\n        return false\n    \n  filterQuestionsByCategory: (category) ->\n    # If a category does not have any questions, create the questions from the\n    # default templates.\n    #\n\n    qs = @removeNonFunctioning @where({'category': category})\n    if qs.length == 0\n      # TODO: need to replace filter semantics-- store in local db for user?\n      qs = @removeNonFunctioning @where({'category': 'DEFAULT_GROUP'})\n      cat = _.first app.categories.where({category: category})\n      cat_semantics = cat.get('semantics')\n      adjusted_qs = []\n      for q in qs\n        new_q = q.clone()\n        new_q.set('category', category)\n        _filters = new_q.get('filters')\n        _sims = new_q.get('answer_similarity')\n        # copy, so this saves to obj\n        _filters.semantics = cat_semantics\n        _sims.semantics = cat_semantics\n\n        adjusted_qs.push new_q\n      qs = adjusted_qs\n    return qs\n\n  orderQuestionsByProgression: (qs, user_cycle) ->\n    userprogression = app.userprogression\n\n    questionByProg = (questions, user_cycle) =>\n    \n      if app.debug\n        console.log \"choosing question by progression\"\n    \n      _filtered_questions = questions.filter (q) =>\n        # TODO: for highest cycle available\n        return not q.user_completed_question({cycle: user_cycle})\n    \n      filtered_questions = _filtered_questions.map (q) ->\n        {'question': q, 'level': q.get('level')}\n    \n      filtered_questions = _.sortBy(filtered_questions, 'level')\n    \n      if filtered_questions.length > 0\n        return [_.first(filtered_questions).question]\n      else\n        return false\n\n    _.shuffle questionByProg(\n      @removeNonFunctioning(qs),\n      user_cycle\n    )\n\n  selectQuestionByProg: (category, level_constraint=false) ->\n    @selectQuestion(category, level_constraint)\n\n  selectQuestion: (category, level_constraint=false, ordering=false) ->\n    #\n    # Select a question\n    #\n    # Max attempts 5, if cannot generate a question from the definition,\n    # then skip. The question will be marked as failing, and filtered\n    # out of the cycle.\n    #\n    # TODO: log a server error.\n\n    [tries, max_tries] = [0, 5]\n\n    if level_constraint == false\n      level_constraint = (level) -> true\n\n    question_instance = false\n    while not question_instance and tries <= max_tries\n      category_qs = @filterQuestionsByCategory(category)\n      level_constraint_qs = category_qs.filter(level_constraint)\n\n      if app.debug\n        console.log \"Level constraint questions: \"\n        console.log (\"#{q.get('category')}/#{q.get('level')}\" for q in level_constraint_qs)\n\n      if level_constraint_qs.length > 0\n        qs = level_constraint_qs\n      else\n        qs = category_qs\n\n      completed = false\n      user_cycle = app.userprogression.cycle_for_category(category)\n\n      if @needs_next\n        user_cycle += 1\n      progression_qs = @orderQuestionsByProgression(qs, user_cycle)\n      if app.debug\n        console.log \"Ordered by progression: \"\n        console.log (\"#{q.get('category')}/#{q.get('level')}\" for q in progression_qs)\n      \n      # for testing only, so far.. \n      if progression_qs.length == 0\n        progression_qs_next = @orderQuestionsByProgression(qs, user_cycle+1)\n        if app.debug\n          console.log \"Ordered by progression plus one: \"\n          console.log (\"#{q.get('category')}/#{q.get('level')}\" for q in progression_qs_next)\n      else\n        progression_qs_next = []\n\n      if progression_qs_next.length > 0 and progression_qs.length == 0 and not @needs_next\n        if app.debug\n          console.log \"Uh oh, this.\"\n        user_cycle += 1\n        progression_qs = @orderQuestionsByProgression(qs, user_cycle)\n        completed = true\n\n      @needs_next = false\n\n      if progression_qs\n        qs = progression_qs\n      else\n        qs = qs\n\n      if qs.length == 0\n        return false\n\n      q = _.first qs\n      q.set('cycle', user_cycle)\n\n      # TODO: this gets the cycle, but nothing is incrementing when the level\n      # is completed\n      current_question_cycle = q.cycle_for_progression()\n\n      if app.debug\n        console.log \"current cycle: #{current_question_cycle}\"\n        console.log \"question level: #{q.get('level')}\"\n        console.log \"user's cycle for category: #{current_question_cycle}\"\n\n      try\n        question_instance = q.find_concepts(app.conceptdb, {ordering: ordering})\n        if app.debug\n          _msg_q_cycle = question_instance.generator.get('cycle')\n          console.log \"question cycle: #{_msg_q_cycle}\"\n        if completed\n          if app.debug\n            console.log \"question cycle complete for: #{q}\"\n          question_instance = false\n          @needs_next = true\n          return question_instance\n      catch e\n        console.log \"TODO: caught LevelComplete\"\n        if e instanceof LevelComplete\n          question_instance = false\n          if app.debug\n            console.log \"question cycle complete for: #{q}\"\n\n      tries += 1\n\n    return question_instance\n","module.exports = class Session extends Backbone.Model\n  # http://whatcodecraves.com/articles/2012/01/11/backbonejs-sessions-and-authentication\n  defaults:\n    access_token: null,\n    user_id: null\n\n  initialize: ->\n    @load()\n\n  authenticated: ->\n    Boolean(@get(\"access_token\"))\n\n  # Saves session information to cookie\n  save: (auth_hash)->\n    $.cookie('user_id', auth_hash.id)\n    $.cookie('access_token', auth_hash.access_token)\n\n  # Loads session information from cookie\n  load: ->\n    @set\n      user_id: $.cookie('user_id')\n      access_token: $.cookie('access_token')\n\n","module.exports = class UserLogEntry extends Backbone.Model\n\n  url: \"/user/data/log/\"\n\n  attributes:\n    game_name: false        # string\n    question_concept: false # related?\n    question_correct: false # boolean\n    cycle: false\n\n  do_not_push: [\n    \"sid\"\n    \"dirty\"\n  ]\n\n  toJSON: (options) ->\n    # TODO: setting to keep everything?\n    attrs = @attributes\n    for i in @do_not_push\n      delete attrs[i]\n    return _.clone(attrs)\n\n  initialize: () ->\n    @set('sid', 'new')\n    @set('dirty', true)\n    @set('_id', @cid)\n\n","UserLogEntry = require 'models/user_log_entry'\n\nmodule.exports = class UserProgression extends Backbone.Collection\n\n  url: \"/user/data/log/\"\n\n  model: UserLogEntry\n\n  parse: (resp) ->\n    return resp.data\n\n  logs_for_category_name: (c_name) ->\n    # Prefer @where, because syntax is cleaner. Where also doesn't\n    # return collections, so otherwise you have to .filter() everything,\n    # thus, avoid simplifying these to additional functions.\n    @where\n      question_category: c_name\n\n  points_for_category_name: (c_name) ->\n    points = @logs_for_category_name(c_name).map (l) -> l.get('points')\n    return _.reduce(points, ((memo, num) -> memo + num), 0)\n    \n  cycle_for_category: (c_name) ->\n    maximum = _.max(\n      (p.get('cycle') for p in @logs_for_category_name(c_name))\n    )\n    return _.max([maximum, 1])\n\n  logs_for_question: (q) ->\n    # Prefer @where, because syntax is cleaner. Where also doesn't\n    # return collections, so otherwise you have to .filter() everything,\n    # thus, avoid simplifying these to additional functions.\n    @where\n      question_category: q.get('category')\n      question_category_level: q.get('level')\n\n  logs_for_question_in_cycle: (q, w) ->\n    # Prefer @where, because syntax is cleaner. Where also doesn't\n    # return collections, so otherwise you have to .filter() everything,\n    # thus, avoid simplifying these to additional functions.\n    @where\n      question_category: q.get('category')\n      question_category_level: q.get('level')\n      cycle: w\n\n  correct_logs_for_question: (q) ->\n    @where\n      question_category: q.get('category')\n      question_category_level: q.get('level')\n      question_correct: true\n\n  correctLogsForConceptInQuestion: (c, q) ->\n    @where\n      question_category: q.get('category')\n      question_category_level: q.get('level')\n      question_concept: c.get('concept_value')\n      question_correct: true\n\n  correctLogsForConceptInQuestionInCycle: (c, q, w) ->\n    @where\n      question_category: q.get('category')\n      question_category_level: q.get('level')\n      question_concept: c.get('concept_value')\n      question_correct: true\n      cycle: w\n\n  initialize: () ->\n    @storage = new Offline.Storage('leksa-user-progression', @)\n    # set after the user successfully authenticates\n    if app.has_user\n      if navigator.onLine\n        @fetch()\n\n  countPoints: () ->\n    total = 0\n    for a in @pluck('points')\n      if a and a isnt undefined\n        total += a\n    return total\n\n  logActivity: (opts) ->\n    log = @create(opts)\n    log.set('dirty', true)\n    if app.user\n      @storage.sync.push()\n    return log\n\n  collateConcepts: (conceptdb) ->\n    # for each log entry, collect concept and correct 1/0, sum correct / length\n    # for each concept\n    boolToInt = (b) ->\n      switch b\n        when true  then 1\n        when false then 0\n\n    concept_correct = []\n    for c in @models\n      concept_correct.push [           c.get('question_concept_value')\n                           , boolToInt c.get('question_correct')\n                           ]\n\n    sorted_values  = _.sortBy(concept_correct, (m) -> m[0])\n    grouped_values = _.groupBy(sorted_values, (m) -> m[0])\n\n    totals = {}\n    for c_name, c_vals of grouped_values\n      _vals = _.flatten [v[1] for v in c_vals]\n      _v_correct = _.reduce(_vals, (a,m) -> a + m)\n      _v_total   = _vals.length\n      totals[c_name] = [_v_correct, _v_total]\n\n    return totals\n\n  totalCorrect: () ->\n    models = @models.filter (m) ->\n      m.get('question_correct') == true\n    models.length\n\n","UserSetting = require 'models/usersetting'\n\nmodule.exports = class UserSettings extends Backbone.Collection\n  # For storing user configuration stuff and syncing with the server, keep it\n  # simple.\n\n  url: \"/user/settings/\"\n\n  model: UserSetting\n\n  # NB: currently only used for getting settings, not actually automatically\n  # populated on instantiation\n  default_setting_values:\n    enable_cache: false\n    enable_audio: true\n    highscore_visible: true\n    interface_language: 'nob'\n    help_language: 'nob'\n\n  getSetting: (setting) ->\n    s = @where({setting_key: setting})\n    if s.length > 0\n      return s[0].get('setting_value')\n    else\n      val = @default_setting_values[setting]\n      if val?\n        new_s = @setSetting(setting, val)\n        return val\n    return null\n\n  setLanguage: (value, opts = {}) ->\n    app.switch_locale(value, opts)\n\n  setSettings: (values, opts = {}) ->\n    @setSetting k, v for k, v of values\n    if opts.store?\n      @storage.sync.push()\n\n  setSetting: (key, val, opts = {}) ->\n    setting = @where({setting_key: key})\n\n    if setting.length > 0\n      @remove(setting)\n\n    new_setting = @create({setting_key: key, setting_value: val})\n    new_setting.set('dirty', true)\n\n    if key == 'interface_language'\n      @setLanguage(val)\n\n    opts.success() if opts.success\n\n    return new_setting\n\n  setDefaults: (opts) ->\n    @setSetting k, v  for k, v of opts\n\n  parse: (response, opts) ->\n    return response.settings\n\n  initialize: () ->\n    @storage = new Offline.Storage('user-settings', @)\n    if not app.user\n      @setDefaults @default_setting_values\n\n    # set after the user successfully authenticates\n    # if app.has_user and navigator.onLine\n    #   @fetch()\n\n      # parse: (resp) ->\n      #   console.log \"UserSettings.parse\"\n      #   console.log resp\n      #   return resp.data\n\n# TODO: call something to refresh settings when a login happens.\n","module.exports = class UserSetting extends Backbone.Model\n  # For storing user configuration stuff and syncing with the server, keep it\n  # simple.\n\n  url: \"/user/settings/\"\n\n  defaults:\n    setting_key: false\n    setting_value: false\n\n  # Attributes to not push to server\n  do_not_push: [\n    \"sid\"\n    \"dirty\"\n  ]\n\n  initialize: () ->\n    @set('sid', 'new')\n    @set('dirty', true)\n    @set('_id', @cid)\n\n  toJSON: (options) ->\n    # TODO: setting to keep everything?\n    attrs = @attributes\n    for i in @do_not_push\n      delete attrs[i]\n    return _.clone(attrs)\n\n\n","# NB:   some views need to be reinstantiated in order for all events to be\n#       available again, as router.changePage destroys them for some reason.\n\nLeksaView = require 'views/games/leksa'\nLearnView = require 'views/games/learn'\n\nCategoryMenu = require 'views/categories/categories'\nCategoryGames = require 'views/categories/category'\n\nConceptList = require 'views/concepts/list'\nGlobalOptionsView = require 'views/users/options'\n\nUserStats = require 'views/users/stats'\nFrontPage = require 'views/intro/view'\nErrorView = require 'views/error/view'\nLoadingView = require 'views/intro/loading'\nSplashView = require 'views/splash/splash'\nInfoView = require 'views/info/info'\nLevelComplete = require 'views/games/level_complete'\n\nmodule.exports = class Router extends Backbone.Router\n\n  initialize: () ->\n    # Handle back button throughout the application\n    $('.back').live 'click', (event) ->\n      window.history.back()\n      return false\n    @firstPage = true\n\n    app.userStats = new UserStats()\n    app.categoryMenu = new CategoryMenu()\n    app.categoryGames = new CategoryGames()\n    app.errorView = new ErrorView()\n    app.frontPage = new FrontPage()\n    app.loadingView = new LoadingView()\n    app.splashView = new SplashView()\n    app.infoView = new InfoView()\n    app.levelComplete = new LevelComplete()\n\n  # Seems to be no way to avoid the double listing for now, because of hash\n  # option, which does some funky redirecting.\n  routes:\n    '': 'splash'\n    '#splash': 'splash'\n\n    'index': 'index'\n    '#index': 'index'\n\n    'frontPage': 'frontPage'\n    '#frontPage': 'frontPage'\n\n    # Misc\n    \n    'options': 'options'\n    '#options': 'options'\n\n    'error': 'errorPage'\n    '#error': 'errorPage'\n\n    'reset': 'reset'\n    '#reset': 'reset'\n\n    'loading': 'loading'\n    '#loading': 'loading'\n\n    'stats':  'userStats'\n    '#stats': 'userStats'\n\n    'infoPage': 'infoPage'\n    '#infoPage': 'infoPage'\n\n    # First step\n\n    'mainMenu':  'categoryMenu'\n    '#mainMenu': 'categoryMenu'\n\n    'categoryMenu':  'categoryMenu'\n    '#categoryMenu': 'categoryMenu'\n\n    'category/:name':  'categoryGames'\n    '#category/:name': 'categoryGames'\n\n    #\n\n    'level_complete': 'level_complete'\n    '#level_complete': 'level_complete'\n\n    'category_complete': 'category_complete'\n    '#category_complete': 'category_complete'\n\n    'leksa/:level/:category': 'learn_and_practice'\n    '#leksa/:level/:category': 'learn_and_practice'\n\n    'conceptSet/:category': 'conceptSet'\n    '#conceptSet/:category': 'conceptSet'\n\n  index: ->\n    configured_already = DSt.get('gielese-configured')\n    if configured_already\n      @changePage(app.categoryMenu)\n    else\n      app.frontPage = new FrontPage()\n      @changePage(app.frontPage)\n\n  frontPage: ->\n    app.frontPage = new FrontPage()\n    @changePage(app.frontPage)\n  \n  loading: ->\n    @changePage(app.loadingView)\n\n  infoPage: ->\n    @changePage(app.infoView)\n\n  level_complete: ->\n    app.levelComplete = new LevelComplete()\n    app.levelComplete.category = false\n    @changePage(app.levelComplete)\n\n  category_complete: ->\n    app.levelComplete = new LevelComplete()\n    app.levelComplete.category = true\n    @changePage(app.levelComplete)\n\n  splash: ->\n    @changePage(app.splashView)\n    # for testing\n    # return false\n    if DSt.get('skip-splash')?\n      time = 500\n    else\n      time = 5000\n\n    setTimeout(() =>\n      configured_already = DSt.get('gielese-configured', false)\n      if configured_already\n        app.categoryMenu = new CategoryMenu()\n        @fadePage(app.categoryMenu)\n      else\n        app.frontPage = new FrontPage()\n        @fadePage(app.frontPage)\n    , time)\n\n  reset: ->\n    DSt.set('gielese-configured', false)\n    window.location = '/'\n\n  userStats: ->\n    # TODO: logged in testing only\n    app.userStats = new UserStats()\n    @changePage(app.userStats)\n\n  categoryMenu: ->\n    app.categoryMenu = new CategoryMenu()\n    app.categoryMenu.initialize()\n    @changePage(app.categoryMenu)\n\n  categoryGames: (name) ->\n\n    app.categoryGames = new CategoryGames()\n    app.categoryGames.category = name\n    app.categoryGames.initialize()\n\n    @changePage(app.categoryGames)\n\n  learn_and_practice: (level, category) ->\n    # $('content #content').html app.leksaView.render().el\n    # ready = false\n    # until ready\n    app.loadingTracker.waitForDeps\n      extra_test: () =>\n        app.conceptdb.models.length > 0 \\\n          and app.questiondb.models.length > 0 \\\n          and app.categories.models.length > 0\n      failed: () =>\n        # TODO: error view / caching problem or server not up\n        console.log \"Uh oh!\"\n      ready: () =>\n\n        level = parseInt level\n    \n        if level == 1\n          app.leksaView = new LearnView\n            attributes:\n              leksa_category: category\n              level_constraint: level\n        else if level > 1\n          app.leksaView = new LeksaView\n            attributes:\n              leksa_category: category\n              level_constraint: level\n         \n        app.leksaView.preselected_q = app.leksaView.selectQuestionForRendering()\n        #\n        # Hopefully we're still in the click event here, in which case we need\n        # to play now.\n        app.leksaView.pregenerated = true\n        app.leksaView.playQuestionSound()\n    \n        app.leksaView.initialize()\n    \n        @changePage(app.leksaView)\n    \n        app.leksaView.viewedOnce = true\n\n  errorPage: ->\n    # $('content #content').html app.errorView.render().el\n    @changePage(app.errorView)\n\n  options: ->\n    app.globalOptionsView = new GlobalOptionsView()\n    @changePage(app.globalOptionsView)\n\n  conceptSet: (category) ->\n    # $('content #content').html app.leksaView.render().el\n    app.loadingTracker.waitForDeps\n      extra_test: () =>\n        app.conceptdb.models.length > 0\n      ready: () =>\n        app.conceptList = new ConceptList()\n        app.conceptList.for_category = category\n        app.conceptList.initialize()\n        @changePage(app.conceptList)\n      failed: () =>\n        # TODO: error view / caching problem or server not up\n        console.log \"Oh craapp\"\n\n  refreshCurrentPage: () ->\n    $('[data-role=\"page\"]').trigger(\"pagecreate\")\n    return true\n\n  changePage: (page) ->\n    # Here we're creating new change page behavior so that backbone plays\n    # nicely with jQuery mobile.\n    #\n    $(page.el).attr('data-role', 'page')\n    page.render()\n\n    $('body').append($(page.el))\n    transition = $.mobile.defaultPageTransition\n\n    # We don't want to slide the first page\n    if @firstPage\n      transition = 'none'\n      @firstPage = false\n\n    $.mobile.changePage($(page.el), {changeHash:false, transition:transition})\n    return false\n\n  fadePage: (page) ->\n    # Here we're creating new change page behavior so that backbone plays\n    # nicely with jQuery mobile.\n    #\n    $(page.el).attr('data-role', 'page')\n    page.render()\n\n    $('body').append($(page.el))\n    transition = $.mobile.defaultPageTransition\n\n    transition = 'fade'\n\n    $.mobile.changePage($(page.el), {changeHash:false, transition:transition})\n    return false\n\n","","module.exports = class AuthTests\n  test_order: [ ]\n\n  run: ->\n    true\n\n  constructor: ->\n\n","module.exports = class QuestionTests\n  test_order: [\n    'duplicate_four_questions'\n  ]\n\n  filter_concepts_by_media_size: ->\n    # TODO: finish this with new code\n    pluck_values = (c) -> c.attributes.concept_value\n    media_size = 'small'\n\n    concepts = app.conceptdb.where({language: \"img\", semantics: [\"FOOD\"]})\n    console.log concepts.map pluck_values\n\n    concepts_f = @filter_concepts_by_media(concepts, media_size)\n    console.log concepts_f.map pluck_values\n    return false\n\n\n  duplicate_four_questions: ->\n    # Create a specific type of question and inspect the kinds of values it\n    # presents\n    #\n    db = app.questiondb\n    errors = []\n    success = true\n\n    vs = db.where({type: \"word_to_image\", category: \"TEST\"})[0]\n      .find_concepts(app.conceptdb, app.userprogression)\n      .choices\n      .map (o) -> o.attributes.concept_value\n\n    filenames = vs.map (a) -> a.split('/').slice(-1)[0]\n\n    if _.uniq(filenames).length != 4\n      console.log filenames\n      success = false\n      errors.push \"* Filenames are same, directory structure differs\"\n\n    if _.uniq(vs).length != 4\n      console.log vs\n      success = false\n      errors.push \"* Paths are the same\"\n\n    return [success, errors]\n\n  run: (iterations = 4) ->\n    # TODO: iterations\n\n    status_str = (a) ->\n      if a\n        \"PASS\"\n      else\n        \"FAIL\"\n\n    _th = @\n    for a in @test_order\n      [status, errors] = _th[a]()\n      console.log \"#{status_str(status)}: #{a}\"\n      if errors.length > 0\n        for err in errors\n          console.log \"  #{err}\"\n      \n  constructor: ->\n      \n","QuestionTests = require './question_tests'\nAuthTests = require './auth_tests'\n\nmodule.exports = class Tests\n  test_order: [\n    'questions'\n    'auth'\n  ]\n\n  run: ->\n    true\n\n  constructor: ->\n    @questions = new QuestionTests()\n    @auth = new AuthTests()\n","CategoriesList = require './templates/categories'\n\nmodule.exports = class CategoryMenu extends Backbone.View\n\n  events:\n    \"click #login_button\": 'displayLogin'\n    \"click #log_out\": 'logout'\n    \"click #userinfo_button\": 'displayUserInfo'\n    \"click .category_name_play\": 'playAudioBefore'\n    \"click a\": \"clickSound\"\n  \n  id: \"category_menu\"\n\n  clickSound: (evt) ->\n    app.soundEffects.click()\n    return true\n\n  logout: (evt) ->\n    DSt.set('gielese-configured', false)\n    window.location.hash = \"frontPage\"\n\n  displayLogin: (evt) ->\n    # TODO: where did username go?\n    if app.user\n      window.location.hash = 'stats'\n      return true\n    app.auth.render_authentication_popup @$el, {\n      success: () =>\n        un = app.user.username\n        @$el.find('#login_button').find('.action').html \" \"\n        @$el.find('#login_button').find('.user').html un\n        @$el.find('#login_button').attr('href', \"#stats\")\n        setTimeout(() =>\n          app.auth.hide_authentication_popup @$el\n        , 250)\n    }\n\n  template: CategoriesList\n\n  render: ->\n    categories = app.categories.where\n      main_menu: true\n\n    labels = 'cba'\n    _labels = labels.split('')\n    withLabel = (c) =>\n      if _labels.length == 0\n        _labels = labels.split('')\n      lab = _labels.pop(0)\n      return [c, lab]\n\n    chunks = window.arrayChunk(\n      withLabel c for c in categories,\n      3\n    )\n    @$el.html @template\n      categories: chunks\n\n    this\n","Category = require 'models/category'\nCategoryTemplate = require './templates/category'\nSubcategoryTemplate = require './templates/subcategory'\n\nmodule.exports = class CategoryGames extends Backbone.View\n\n  id: \"category_view\"\n\n  events:\n    \"click a\": \"clickSound\"\n\n  clickSound: (evt) ->\n    app.soundEffects.click()\n    return true\n\n  template: (params) ->\n    if params.subcategory\n      return SubcategoryTemplate params\n    else\n      return CategoryTemplate params\n\n  render: ->\n    cats = app.categories.where({category: @category})\n    if cats.length > 0\n      cat = cats[0]\n\n    subcategory = cat.children()\n\n    if subcategory\n      labels = 'cba'\n      _labels = labels.split('')\n\n      withLabel = (c) =>\n        if _labels.length == 0\n          _labels = labels.split('')\n        lab = _labels.pop(0)\n        return [c, lab]\n\n      chunks = window.arrayChunk(\n        withLabel c for c in subcategory,\n        3\n      )\n      subcategory = chunks\n    else\n      children = false\n\n    window.cat = cat\n    if cat.hasImage()\n      category_image = cat.hasImage()\n    else\n      category_image = ''\n\n    @$el.html @template {\n      category: cat\n      subcategory: subcategory\n    }\n\n    @$el.css\n      \"background-image\": \"url('#{category_image}')\"\n      \"background-size\": \"cover\"\n      \"background-repeat\": \"no-repeat\"\n      \"background-position\": \"center\"\n\n    #   \"background-size\":  \"#{app.screen_width-2}px #{app.screen_height-2}px\"\n\n    this\n\n","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var background_img, cat, category, group, label, name, subcat, _i, _j, _len, _len1, _ref, _ref1;\n    \n      __out.push('<div class=\"aajege-header aajege-header-shrinkable\">\\n    <ul class=\"aajege-nav aajege-nav-left\">\\n        <li class=\"icon-aajege-left-arrow\">\\n            <a href=\"#\" id=\"log_out\">\\n            </a>\\n        </li>\\n    </ul>\\n    <hr class=\"aajege-flette\" />\\n</div>\\n\\n<div data-role=\"content\" id=\"main_menu_content\">\\n\\n    <div id=\"category_links\">\\n\\n        <div class=\"ui-grid-b\">\\n        ');\n    \n      _ref = this.categories;\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        group = _ref[_i];\n        __out.push('\\n            ');\n        for (_j = 0, _len1 = group.length; _j < _len1; _j++) {\n          _ref1 = group[_j], category = _ref1[0], label = _ref1[1];\n          __out.push('\\n                ');\n          cat = category.get('category');\n          __out.push('\\n                ');\n          name = category.get('name');\n          __out.push('\\n                ');\n          subcat = category.get('children').length > 0;\n          __out.push('\\n\\n                <div class=\"ui-block-');\n          __out.push(label);\n          __out.push('\">\\n                    ');\n          if (category.get('grayed_out')) {\n            __out.push('\\n                    <a class=\"square grayed\"\\n                    ');\n          } else {\n            __out.push('\\n                        ');\n            if (subcat) {\n              __out.push('\\n                            <a class=\"square\"\\n                        ');\n            } else {\n              __out.push('\\n                            <a class=\"square category_name_play\"\\n                               data-lemma=\"');\n              __out.push(name);\n              __out.push('\"\\n                        ');\n            }\n            __out.push('\\n                    ');\n          }\n          __out.push('\\n                       href=\"#category/');\n          __out.push(cat);\n          __out.push('\"\\n                       data-transition=\"slide\">\\n                        ');\n          if (category.hasThumbnail()) {\n            __out.push('\\n                            ');\n            background_img = category.hasThumbnail();\n            __out.push('\\n                            <span class=\"link_image\" style=\"background-image: url(\\'');\n            __out.push(background_img);\n            __out.push('\\')\"></span>\\n                        ');\n          } else {\n            __out.push('\\n                            <span class=\"link_image\"></span>\\n                        ');\n          }\n          __out.push('\\n                        <span class=\"link_word\">');\n          __out.push(gettext.gettext(name));\n          __out.push('</span>\\n                    </a>\\n                </div>\\n            ');\n        }\n        __out.push('\\n        ');\n      }\n    \n      __out.push('\\n        </div>\\n\\n    </div>\\n</div>\\n');\n    \n      __out.push('\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var prev;\n    \n      if (this.category.get('parent')) {\n        __out.push('\\n    ');\n        prev = \"#category/\" + this.category.get('parent');\n        __out.push('\\n');\n      } else {\n        __out.push('\\n    ');\n        prev = \"#categoryMenu\";\n        __out.push('\\n');\n      }\n    \n      __out.push('\\n\\n<div class=\"aajege-header aajege-header-shrinkable\">\\n    <ul class=\"aajege-nav aajege-nav-left\">\\n        <li class=\"icon-aajege-home\">\\n            <a href=\"');\n    \n      __out.push(prev);\n    \n      __out.push('\" data-transition=\"slide\">\\n                <span class=\"label\">\\n                    ');\n    \n      __out.push(gettext.gettext(\"Back\"));\n    \n      __out.push('\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n    <h2>');\n    \n      __out.push(this.category.get('name'));\n    \n      __out.push('</h2>\\n    <ul class=\"aajege-nav aajege-nav-right\">\\n        <li class=\"icon-aajege-bag\">\\n            <a href=\"#stats\" id=\"userinfo_button\" class=\"user_points\">\\n                <span class=\"label\">\\n                    <span class=\"point_name\">');\n    \n      __out.push(gettext.gettext(\"Points\"));\n    \n      __out.push('</span>\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n    <hr class=\"aajege-flette\" />\\n</div>\\n\\n<div data-role=\"content\" id=\"category_content\">\\n    <div id=\"category_background\">\\n        <div id=\"category_buttons\">\\n            <ul class=\"aajege-buttons\">\\n\\t            <li>\\n\\t            \\t<a class=\"aajege-button\"\\n\\t            \\t   href=\"#conceptSet/');\n    \n      __out.push(this.category.get('category'));\n    \n      __out.push('\" \\n\\t            \\t   data-transition=\"slide\">');\n    \n      __out.push(gettext.gettext(\"Wordlist\"));\n    \n      __out.push('</a>\\n\\t            </li>\\n\\t            <li>\\n\\t                <a class=\"aajege-button\"\\n\\t                   href=\"#leksa/1/');\n    \n      __out.push(this.category.get('category'));\n    \n      __out.push('\" \\n\\t                   data-transition=\"slide\">');\n    \n      __out.push(gettext.gettext(\"Learn\"));\n    \n      __out.push('</a>\\n\\t            </li>\\n\\t            <li>\\n\\t                <a class=\"aajege-button\"\\n\\t                   href=\"#leksa/2/');\n    \n      __out.push(this.category.get('category'));\n    \n      __out.push('\" \\n\\t                   data-transition=\"slide\">');\n    \n      __out.push(gettext.gettext(\"Practice\"));\n    \n      __out.push('</a>\\n\\t           </li>\\n            </ul>\\n        </div>\\n    </div>\\n</div> \\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var background_img, cat, category, group, label, name, _i, _j, _len, _len1, _ref, _ref1;\n    \n      __out.push('<div class=\"aajege-header aajege-header-shrinkable\">\\n    <ul class=\"aajege-nav aajege-nav-left\">\\n        <li class=\"icon-aajege-left-arrow\">\\n            <a href=\"#categoryMenu\" data-transition=\"slide\">\\n                <span class=\"label\">\\n                    ');\n    \n      __out.push(gettext.gettext(\"Back\"));\n    \n      __out.push('\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n    <h2> ');\n    \n      __out.push(gettext.gettext(this.category.get('name')));\n    \n      __out.push(' </h2>\\n    <ul class=\"aajege-nav aajege-nav-right\">\\n        <li class=\"icon-aajege-bag\">\\n            <a href=\"#stats\" id=\"userinfo_button\" class=\"disable_auto_handler user_points\">\\n                <span class=\"label\">\\n                    <span class=\"point_name\">');\n    \n      __out.push(gettext.gettext(\"Points\"));\n    \n      __out.push('</span>\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n    <hr class=\"aajege-flette\" />\\n</div>\\n\\n<div data-role=\"content\" id=\"subcategory_menu\">\\n    <div id=\"category_background\">\\n        <div class=\"category_buttons\">\\n            <div class=\"ui-grid-b\">\\n            ');\n    \n      _ref = this.subcategory;\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        group = _ref[_i];\n        __out.push('\\n                ');\n        for (_j = 0, _len1 = group.length; _j < _len1; _j++) {\n          _ref1 = group[_j], category = _ref1[0], label = _ref1[1];\n          __out.push('\\n                    ');\n          cat = category.get('category');\n          __out.push('\\n                    ');\n          name = category.get('name');\n          __out.push('\\n\\n                    <div class=\"ui-block-');\n          __out.push(label);\n          __out.push('\">\\n                        ');\n          if (category.get('grayed_out')) {\n            __out.push('\\n                        <a class=\"square grayed\"\\n                        ');\n          } else {\n            __out.push('\\n                        <a class=\"square\"\\n                        ');\n          }\n          __out.push('\\n                           href=\"#category/');\n          __out.push(cat);\n          __out.push('\"\\n                           data-transition=\"slide\">\\n                            ');\n          if (category.hasThumbnail()) {\n            __out.push('\\n                                ');\n            background_img = category.hasThumbnail();\n            __out.push('\\n                                <span class=\"link_image\" style=\"background-image: url(\\'');\n            __out.push(background_img);\n            __out.push('\\')\"></span>\\n                            ');\n          } else {\n            __out.push('\\n                                <span class=\"link_image\"></span>\\n                            ');\n          }\n          __out.push('\\n                            <span class=\"link_word\">');\n          __out.push(gettext.gettext(name));\n          __out.push('</span>\\n                        </a>\\n                    </div>\\n                ');\n        }\n        __out.push('\\n            ');\n      }\n    \n      __out.push('\\n            </div>\\n        </div>\\n    </div>\\n</div>\\n\\n');\n    \n      __out.push('\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","ConceptItem = require './templates/item'\nConceptListTemplate = require './templates/list'\nConceptViewMain = require './templates/concepts'\n\nclass ConceptView extends Backbone.View\n\n  play: () ->\n    # if @model.hasVideo({no_default: true})\n    #   vid = @$el.find('video')\n\n    #   # TODO: replay on click\n\n    #   vid.bind 'loadeddata', () =>\n    #     console.log(\"video loaded\")\n    #     setTimeout(() ->\n    #       console.log(\"play event\")\n    #       $('video').get(0).play()\n    #     , 300)\n\n    @model.playAudio\n      begin: () =>\n        @$el.find('.audio_link').children('img').addClass('playing')\n      finished: () =>\n        console.log \"finished event\"\n        $(document).find('.audio_link img').removeClass('playing')\n\n    return false\n\n  template: ConceptItem\n\n  render: ->\n    translation_language = app.options.getSetting('help_language')\n\n    fallback = false\n    translations = @model.getTranslationsToLang translation_language\n    txl_string = (a.get('concept_value') for a in translations).join(', ')\n\n    success = false\n    if app.user\n      success = @model.successRateInUserLog()\n    else\n      if app.userprogression.models.length > 0\n        success = @model.successRateInUserLog()\n\n    @$el.html @template\n      model: @model\n      success_rate: success\n      cid: @model.cid\n      concept_value: @model.get('concept_value')\n      concept_type: @model.get('concept_type')\n      translations: translations\n      txl_string: txl_string\n      fallback: fallback\n      userlang: translation_language\n      next: @next\n      prev: @prev\n    \n    if app.device_type == 'tablet'\n      minFontSize = \"20px\"\n      maxFontSize = \"36px\"\n      compress = 1.5\n\n    if app.device_type == 'mobile'\n      minFontSize = \"14px\"\n      maxFontSize = \"22px\"\n      compress = 1\n\n    # @$el.find('.concept_definition').fitText compress, {\n    #   minFontSize: minFontSize\n    #   maxFontSize: maxFontSize\n    # }\n\n    # @$el.find('.concept_definition').textfill\n    #   maxFontPixels: 36\n    #\n\n    @play()\n\n    this\n\nmodule.exports = class ConceptList extends Backbone.View\n\n  id: \"concept_view\"\n\n  events:\n    'click .audio_link': 'findAudio'\n    'click #show-panel': \"revealWordsPanel\"\n    'click .concept_link': 'showConcept'\n    'click #cycle-concept-prev': 'prevConcept'\n    'click #cycle-concept-next': 'nextConcept'\n    \"click .aajege-header a\": \"clickSound\"\n\n  clickSound: (evt) ->\n    app.soundEffects.click()\n    return true\n  \n  clickTest: (evt) ->\n    $(evt.target).get\n    console.log evt\n    return true\n\n  nextConcept: ->\n    if @next?\n      @conceptByIndex(@next)\n    return false\n\n  prevConcept: ->\n    if @prev?\n      @conceptByIndex(@prev)\n    return false\n\n  conceptByIndex: (concept_index) ->\n    concept = @concepts_in_order[concept_index]\n    if not concept\n      return false\n\n    prev = null\n    if (concept_index - 1) > -1\n      prev = concept_index - 1\n\n    next = concept_index + 1\n\n    concept_template = new ConceptView {\n      model: concept\n    }\n\n    @current_concept_view = concept_template\n\n    @prev = prev\n    @next = next\n\n    $('#concept_content').html concept_template.render().$el.html()\n    $('#concept_content').trigger('create')\n\n    concept_list = @$el.find('#concept-list')\n    concept_link = concept_list.find(\"[data-concept-index=#{concept_index}]\")\n\n    concept_list.find('.ui-btn-active-d').removeClass('ui-btn-active-d')\n    concept_link.parents('li.ui-btn').addClass('ui-btn-active-d')\n\n    el_pos = concept_link.parents('li.ui-btn').position()\n    link_li = concept_link.parents('li.ui-btn')\n\n    new_position = concept_list.scrollTop(\n      concept_list.scrollTop() +\n      (link_li.position().top - concept_list.position().top) -\n      (concept_list.height()/2) +\n      (link_li.height()/2)\n    )\n\n    # reveal and hide arrows on scroll to bottom\n    # $(window).height() - $('.aajege-header').outerHeight()\n\n    # if link_li.position().top > concept_list.height()\n    #   concept_list.animate({\n    #     scrollTop: new_position\n    #   }, 'slow')\n\n    return false\n\n  showConcept: (evt) ->\n    concept_index = parseInt $(evt.target).attr('data-concept-index')\n\n    @$el.find('.ui-btn-active-d').removeClass('ui-btn-active-d')\n    $(evt.target).parents('li.ui-btn').addClass('ui-btn-active-d')\n\n    concept = @concepts_in_order[concept_index]\n\n    prev = null\n    if (concept_index - 1) > -1\n      prev = concept_index - 1\n\n    next = concept_index + 1\n\n    concept_template = new ConceptView {\n      model: concept\n    }\n\n    @current_concept_view = concept_template\n\n    @prev = prev\n    @next = next\n\n    $('#concept_content').html concept_template.render().$el.html()\n    $('#concept_content').trigger('create')\n    $('#wordlist_panel').panel('close', {})\n    return false\n\n  findAudio: (event) ->\n    image = $(document).find('.audio_link img')\n    $(image).addClass('playing')\n    @current_concept_view.model.playAudio\n      begin: () =>\n        $(image).addClass('playing')\n      finished: () =>\n        image.removeClass('playing')\n\n    return false\n\n  className: 'conceptlist'\n\n  template: ConceptListTemplate\n\n  calculateContentHeight: ->\n    header_height = $('.aajege-header').outerHeight()\n    window_height = $(window).height()\n\n    @$el.find('#concepts_content').css('height',\n      \"#{window_height - header_height}px\"\n    )\n\n    return false\n\n  render: ->\n\n    translation_language = app.options.getSetting('help_language')\n\n    category = _.first app.categories.where\n      category: @for_category\n\n    category_concepts = category.getConcepts\n      language: 'sma'\n\n    @next = 1\n    @prev = null\n\n    getTxl = (m) =>\n      translations = m.getTranslationsToLang translation_language\n      txl_string = _.uniq((a.get('concept_value') for a in translations)).join(', ')\n      m.set('txl_string', txl_string)\n\n    sortTxl = (m) -> return m.get('txl_string')\n\n    # sort by translation if no sorting method is provided by user\n    category_concepts = category_concepts.map(getTxl)\n    if not category.attributes.order_by?\n      category_concepts = _.sortBy category_concepts, sortTxl\n\n    @concepts_in_order = category_concepts\n\n    initial = new ConceptView {\n      model: category_concepts[0]\n    }\n\n    @current_concept_view = initial\n\n    # get_success_color = (_float) ->\n    #   _class = ''\n    #   if (1 >= _float) && (_float >= .9)\n    #     _class = 'success-rate-green'\n    #   if (.9 > _float) && (_float > .7)\n    #     _class = 'success-rate-yellow'\n    #   if (.7 > _float) && (_float > .49)\n    #     _class = 'success-rate-orange'\n    #   if (.49 > _float) && (_float > .1)\n    #     _class = 'success-rate-red'\n    #   return _class\n\n    @$el.html @template {\n      category: category\n      models: @concepts_in_order\n      initial_model: initial.render().$el.html()\n    }\n\n    @$el.find('ul#concept-list li:first').addClass('ui-btn-active-d')\n    @calculateContentHeight()\n\n    this\n","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var t, _i, _len, _ref;\n    \n      __out.push('<div data-role=\"header\">\\n    <a href=\"/#wordlist\" data-transition=\"slide\" data-icon=\"arrow-l\">');\n    \n      __out.push(gettext.gettext(\"Back\"));\n    \n      __out.push('</a>\\n    <h2> ');\n    \n      __out.push(this.model.get('concept_value'));\n    \n      __out.push(' </h2>\\n</div> \\n\\n<div data-role=\"content\" class=\"concept\">\\n    <div class=\"ui-grid-a\">\\n\\t    <div class=\"ui-block-a\">\\n            ');\n    \n      if (this.model.hasImage()) {\n        __out.push('\\n                <img width=\"150\" \\n                     height=\"150\" \\n                     src=\"');\n        __out.push(this.model.hasImage());\n        __out.push('\" />\\n            ');\n      }\n    \n      __out.push('\\n        </div>\\n\\t    <div class=\"ui-block-b\">\\n            ');\n    \n      if (this.model.hasAudio()) {\n        __out.push('\\n                <a href=\"#\" class=\"audio_link\">\\n                    <img width=\"32\" height=\"32\" src=\"/static/client/images/speaker.png\" />\\n                    Listen\\n                </a>\\n            ');\n      }\n    \n      __out.push('\\n            <ul class=\"translations\">\\n                ');\n    \n      _ref = this.translations;\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        t = _ref[_i];\n        __out.push('\\n                    <li>');\n        __out.push(t.get('concept_value'));\n        __out.push('</li>\\n                ');\n      }\n    \n      __out.push('\\n            </ul>\\n\\t    </div>\\t   \\n    </div>\\n\\n</div> \\n\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var vid, _i, _len, _ref;\n    \n      if (this.model.hasImage({\n        no_default: true\n      })) {\n        __out.push('\\n    <div id=\"concept_img_frame\">\\n        <img id=\"current_concept_img\"\\n             style=\"background-image: url(');\n        __out.push(this.model.hasImage());\n        __out.push(')\" />\\n     </div>\\n');\n      } else if (this.model.hasVideo({\n        no_default: true\n      })) {\n        __out.push('\\n    ');\n        if (app.video_format === 'gif') {\n          __out.push('\\n      <div id=\"concept_img_frame\">\\n          <img id=\"current_concept_img\"\\n               style=\"background-image: url(');\n          __out.push(this.model.hasVideo().path);\n          __out.push(')\" />\\n      </div>\\n    ');\n        } else {\n          __out.push('\\n      <div id=\"concept_video_frame\">\\n          <video \\n              class=\"conceptVideo\"\\n              id=\"current_concept_video\"\\n              webkit-playsinline\\n              poster preload=\"true\"\\n              loop>\\n              ');\n          _ref = this.model.hasVideo();\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n            vid = _ref[_i];\n            __out.push('\\n                  <source\\n                  src=\"');\n            __out.push(vid.path);\n            __out.push('\"\\n                  ');\n            if (vid.path.search('mp4') > -1) {\n              __out.push('\\n                  type=\"video/mp4\">\\n                  ');\n            } else if (vid.path.search('webm') > -1) {\n              __out.push('\\n                  type=\"video/webm\">\\n                  ');\n            }\n            __out.push('\\n              ');\n          }\n          __out.push('\\n              </video>\\n       </div>\\n    ');\n        }\n        __out.push('\\n');\n      } else {\n        __out.push('\\n    <div id=\"concept_img_frame\">\\n        <img id=\"current_concept_img\"\\n             style=\"background-image: url(/static/images/missing_concept_image.jpg)\" />\\n     </div>\\n');\n      }\n    \n      __out.push('\\n\\n<ul id=\"concept_definitions\">\\n    <li>\\n        <h2 data-textfill class=\"concept_definition concept_value\">\\n            <span>');\n    \n      __out.push(this.model.get('concept_value'));\n    \n      __out.push('</span>\\n        </h2>\\n    </li>\\n\\n    <!--\\n    ');\n    \n      if (this.fallback) {\n        __out.push('\\n        <li>\\n             <h2 class=\"concept_definition\">');\n        __out.push(this.txl_string);\n        __out.push(' <span class=\"concept_language\">(');\n        __out.push(tx.get('language'));\n        __out.push(')</span></h2>\\n        </li>\\n    ');\n      } else {\n        __out.push('\\n        <li>\\n            <h2 class=\"concept_definition\">');\n        __out.push(this.txl_string);\n        __out.push('</h2>\\n        </li>\\n    ');\n      }\n    \n      __out.push('\\n    -->\\n\\n</ul>\\n\\n\\n<div id=\"nav_buttons\">\\n    ');\n    \n      if (this.model.hasAudio()) {\n        __out.push('\\n            <a href=\"#\"\\n               class=\"audio_link\"\\n               data-concept-cid=\"');\n        __out.push(this.cid);\n        __out.push('\">\\n                <img width=\"48\"\\n                     height=\"48\"\\n                     class=\"play_speaker\"\\n                     src=\"/static/client/images/speaker.png\" />\\n            </a>\\n    ');\n      }\n    \n      __out.push('\\n</div>\\n\\n');\n    \n      if (this.fallback) {\n        __out.push('\\n    <span class=\"error\">No definition in db for ');\n        __out.push(this.userlang);\n        __out.push(' for word, falling back to nob.</span>\\n');\n      }\n    \n      __out.push('\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var color, concept, i, _i, _len, _ref;\n    \n      __out.push('<div class=\"aajege-header aajege-header-shrinkable\">\\n    <ul class=\"aajege-nav aajege-nav-left\">\\n        <li class=\"icon-aajege-home\">\\n            <a href=\"#index\" data-transition=\"slide\">\\n                <span class=\"label\">\\n                    ');\n    \n      __out.push(gettext.gettext(\"Home\"));\n    \n      __out.push('\\n                </span>\\n            </a>\\n        </li>\\n        <li class=\"icon-aajege-left-arrow\">\\n            <a href=\"#category/');\n    \n      __out.push(this.category.get('category'));\n    \n      __out.push('\" data-transition=\"slide\">\\n                <span class=\"label\">\\n                    ');\n    \n      __out.push(gettext.gettext(\"Back\"));\n    \n      __out.push('\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n\\n    <h2>');\n    \n      __out.push(this.category.get('name'));\n    \n      __out.push('</h2>\\n\\n    <ul class=\"aajege-nav aajege-nav-right\">\\n        <li class=\"icon-aajege-bag\">\\n            <a href=\"#stats\" id=\"userinfo_button\" class=\"user_points\">\\n                <span class=\"label\">\\n                    <span class=\"point_name\">');\n    \n      __out.push(gettext.gettext(\"Points\"));\n    \n      __out.push('</span>\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n    <hr class=\"aajege-flette\" />\\n</div>\\n\\n<div data-role=\"content\" id=\"concepts_content\">\\n    <div class=\"ui-grid-a twothirds\" id=\"concept_content_block\">\\n        <div class=\"ui-block-a left-block\" id=\"concept_content\">\\n            ');\n    \n      __out.push(this.initial_model);\n    \n      __out.push('\\n        </div>\\n        <div class=\"ui-block-b right-block\">\\n            <ul data-role=\"listview\" \\n                data-theme=\"i\" \\n                data-divider-theme=\"c\" \\n                data-split-icon=\"\"\\n                data-icon=\"\"\\n                id=\"concept_list\"\\n                class=\"ui-listview\">\\n                ');\n    \n      _ref = this.models;\n      for (i = _i = 0, _len = _ref.length; _i < _len; i = ++_i) {\n        concept = _ref[i];\n        __out.push('\\n                    ');\n        color = false;\n        __out.push('\\n                      \\n                    ');\n        if (i === 0) {\n          __out.push('\\n                    <li class=\\'ui-btn-active-d\\'>\\n                    ');\n        } else {\n          __out.push('\\n                    <li>\\n                    ');\n        }\n        __out.push('\\n                        <a class=\"concept_link\"\\n                           data-concept-index=\"');\n        __out.push(i);\n        __out.push('\"\\n                           href=\"#\">');\n        __out.push(concept.get('txl_string'));\n        __out.push('</a>\\n                    </li>\\n                ');\n      }\n    \n      __out.push('\\n            </ul>\\n            <div class=\"scroll-arrow\">\\n                <i class=\"icon-aajege-down-arrow\" />\\n            </div>\\n        </div>\\n    </div>\\n</div>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<h3>Uh oh, an error occurred.</h3>\\nError: ');\n    \n      __out.push(window.last_error);\n    \n      __out.push('\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","ErrorTemplate = require './templates/error'\n\nmodule.exports = class ErrorView extends Backbone.View\n\n  className: 'error'\n  id: \"error\"\n\n  template: ErrorTemplate\n\n  render: ->\n    @$el.html @template\n    this\n\n","#\n##\n## ## Notes and stuff\n##\n#\n#  There is some helpful documentation on potential problems and gotchas with a\n#  lot of the javascript problems one might encounter. See `leksa.coffee`.\n#\n#\n\nLevelCompleted = require './templates/leksa_level_completed'\nLeksaConceptTemplate = require '/views/templates/leksa_concept'\n\nLeksaView = require '/views/games/leksa'\n\n#\n##\n## ##\n\nmodule.exports = class LearnView extends LeksaView\n\n  events:\n    # TODO: test swiping\n    'click #menu_next': \"newQuestionSameGroup\"\n    'click .disable_auto_handler': \"reset_auto_event\"\n\n  id: \"leksa\"\n  auto_advance: true\n  level_constraint: (question) -> question.get('level') == 1\n\n  reset_auto_event: () ->\n    if app.wait_handler?\n      clearTimeout app.wait_handler\n    if app.leksaView.auto_advance_handler?\n      clearInterval @auto_advance_handler\n    if app.leksaView.countdown_handle?\n      clearInterval @countdown_handle\n    return true\n\n  # # #\n  # # #  Question rendering\n  # # #\n\n  selectQuestionForRendering: ->\n    # TODO: wait for ready if not\n    if app.questiondb.length == 0 and app.conceptdb.length == 0\n      window.last_error = \"Question DB and Concept DB not ready.\"\n      app.router.navigate('error')\n\n    if @attributes.level_constraint\n      level_constraint = @level_constraint\n    else\n      level_constraint = (level) -> true\n\n    # TODO: ordering\n    if @ordering?\n      q = app.questiondb.selectQuestion(\n        @attributes.leksa_category,\n        false,\n        @ordering\n      )\n    else\n      q = app.questiondb.selectQuestionByProg(\n        @attributes.leksa_category,\n        level_constraint,\n      )\n    return q\n\n  renderQuestion: ->\n    # Select a question, render it, bind event handlers to each possible\n    # answer\n\n    #\n    # Hide the question-end options\n    $('.set_done_options').hide()\n\n    window.scrollTo(0,0)\n\n    # check if the question has been preselected by the click event in the\n    # router\n    if @preselected_q?\n      if app.debug\n        console.log \"Pregenerated for click event.\"\n      @q = @preselected_q\n      delete @preselected_q\n    else\n      @q = @selectQuestionForRendering()\n\n    if not @ordering?\n      if app.debug\n        console.log \"choosing ordering\"\n\n      @cat = _.first app.categories.where\n        category: @attributes.leksa_category\n      concepts = @cat.getConcepts\n        language: @q.generator.attributes.filters.to_language\n      @ordering = (c.get('concept_value') for c in concepts)\n      @ordering = _.shuffle @ordering.filter (c) =>\n        c isnt @q.answer.attributes.concept_value\n\n      # @ordering.push \"THIS_IS_THE_LAST\"\n      @ordering.push @q.answer.attributes.concept_value\n    else\n      last = @ordering.shift(0)\n      @ordering.push(last)\n\n    if app.debug\n      console.log @ordering\n\n    if not @q.question\n      _log_msg = \"LearnView.render_question: ungeneratable question in ordering\"\n      _log_msg += \" \" + @ordering.join(', ')\n      console.log @ordering\n      window.client_log.error(_log_msg)\n      _err_msg = \"A question could not be generated from these parameters\"\n      @$el.find('#leksa_question').html @leksa_error_template\n        error_msg: _err_msg\n      return false\n\n    #\n    # Render the template for the question\n\n    class DummyConcept extends Backbone.Model\n      render_concept: () ->\n        LeksaConceptTemplate({\n          concept: @\n          concept_type: @.get('concept_type')\n          concept_value: @.get('concept_value')\n          additional_class: \"no_frame\"\n        })\n\n    if @q.choices.length == 3 and @q.generator.get('type') == \"word_to_image\"\n      @q.choices.push new DummyConcept\n        concept_value: \"/static/images/bakgrunn-spill.png\"\n        concept_type: \"img\"\n\n      @q.choices = _.shuffle @q.choices\n\n    @$el.find('#leksa_question').html @question_template\n      instance: @q\n      chunker: arrayChunk\n      audio: @q.question.hasAudio()\n      q_type: @q.generator.get('type')\n\n    @$el.find('#leksa_question a.answerlink.text').textfill\n      minFontPixels: 18\n      maxFontPixels: 36\n\n    # Do not advance\n    @$el.find('#leksa_question a.answerlink').click (evt) =>\n      return false\n\n    app.router.refreshCurrentPage()\n\n    playFirst = =>\n      if app.options.getSetting('enable_audio') and @q.generator.get('sound')\n        @playQuestionSound()\n\n    # Delay first sound playing as leksa page renders\n    if @pregenerated?\n      delete @pregenerated\n    else\n      if not @first\n        app.wait_handler = setTimeout(playFirst, 1500)\n        @first = false\n      else\n        playFirst()\n\n    @$el.find('#question_play').click () =>\n      if app.debug?\n        console.log \"Play:\"\n        console.log @q.question\n      @q.question.playAudio()\n      return false\n\n    return true\n\n  playQuestionSound: () ->\n    # Play the audio, but periodically poll to see if it's completed\n    # if complete, then move on.\n\n    if @preselected_q\n      a = @preselected_q\n    else\n      a = @q\n\n    window.current_audio = a.question.playAudio()\n\n    checkPosition = () ->\n      current_audio = window.current_audio\n      if current_audio.position == current_audio.duration or \\\n         current_audio.position == current_audio.durationEstimate\n        app.leksaView.soundFinished()\n      else\n        setTimeout(checkPosition, 200)\n\n    if current_audio?\n      setTimeout(checkPosition, 200)\n    else\n      app.leksaView.soundFinished()\n    \n  soundFinished: () ->\n    if app.debug\n      console.log \"View got sound finished.\"\n    app.wait_handler = setTimeout(() =>\n      if /leksa/.exec window.location.hash\n        app.leksaView.renderQuestion()\n      else\n        clearTimeout app.wait_handler\n        return false\n    , 4000)\n\n  render: ->\n    # if user ends up on front page due to error and comes back here, events\n    # are not registered\n    # Render template and insert a question\n\n    @cat = _.first app.categories.where\n      category: @attributes.leksa_category\n\n    @$el.html @template {\n      leksa_category: @attributes.leksa_category\n      category: @cat.attributes.name\n    }\n\n    @pts_bubble = @$el.find('#points_for_question')\n    @pts_bubble.hide()\n\n    app.leksaView.renderQuestion()\n\n    @first = true\n\n    return this\n","#\n##\n## ## Notes and stuff\n##\n#\n#  There's a lot of annoying and complex stuff involving the following:\n#\n#    * sound events\n#      - different browsers have different restrictions\n#\n#      - different browsers result in onfinished event getting handled\n#        differently\n#\n#      - mobile browsers only allow sounds to be played via HTML5 when a click\n#        event has triggered them, so the first sound must be 'pregenerated',\n#        otherwise relying on the typical .render() -> .renderQuestion()\n#        process will result in nothing playing\n#\n#      - HTML5 audio on mobile devices generally has a constraint of only one\n#        sound object per tab. It's the best idea to keep the same one around,\n#        and just retarget with a new URL and onfinish handler, rather than\n#        destroying the handler. The latter may not work, and if it actually\n#        does it may be really slow for certain browsers.\n#\n#      - Mobile browsers must have 'audio focus', i.e., you must have tapped a\n#        link to play audio, so that future audio events will work. For now I've\n#        tried to trick peoples' browsers in receiving focus for the more\n#        important learning events by having a sound associated with menu\n#        navigation\n#\n#    * point decrementing events\n#      - potential for overlapping decrements (make sure to delete handlers!)\n#\n#    * rendering new questinos\n#      - delete handlers\n#\n#    * removing timeout/interval handlers when moving to other pages/new\n#      questions\n#      - yep\n#\n#    * timetout/interval support across browsers\n#      - safari and android seem to sometimes prefer setTimeout, but setInterval\n#        support across browsers is worse, so it's better to use this.\n#      - some browsers (ahem, iOS Safari) may prefer that the setTimeout\n#        function be bound to this/@.\n#\n#          Function::bind = (parent) ->\n#            f = this\n#            args = []\n#            a = 1\n#\n#            while a < args.length\n#              args[args.length] = args[a]\n#              a++\n#\n#            temp = ->\n#              f.apply parent, args\n#\n#            temp\n#\n#\n#           someFunction = () ->\n#             console.log \"Did something\"\n#           handler = setTimeout(someFunction.bind(@), 1000)\n#\n#        ... but I've had bad luck getting this to actually work in Safari.\n#        It seems to be doing fine so far, but maybe that will change.\n#\n#\n##\n## ## Now to start doing things.\n##\n#\n\nUserLog = require 'models/user_log_entry'\n\nLeksaTemplate = require './templates/leksa'\nLeksaErrorTemplate = require './templates/leksa_error_template'\n\nLeksaQuestionImageToWord = require './templates/leksa_question_image_to_word'\nLeksaQuestionWordToWord = require './templates/leksa_question_image_to_word'\nLeksaQuestionWordToImage = require './templates/leksa_question_word_to_image'\nStatTemplate = require './templates/stat_block'\nLeksaConceptTemplate = require '/views/templates/leksa_concept'\n\n#\n##\n## ##\n\nmodule.exports = class LeksaView extends Backbone.View\n\n  id: \"leksa\"\n\n  template: LeksaTemplate\n\n  auto_advance: false\n\n  level_constraint: (question) =>\n    question.get('level') >= @attributes.level_constraint\n\n  question_template: (context) ->\n    tpl = switch context.q_type\n      when \"image_to_word\" then LeksaQuestionImageToWord\n      when \"word_to_word\" then LeksaQuestionWordToWord\n      when \"word_to_image\" then LeksaQuestionWordToImage\n    return tpl context\n\n  leksa_error_template: LeksaErrorTemplate\n\n  events:\n    # TODO: test swiping\n    'click #menu_next': \"newQuestionSameGroup\"\n    'click .disable_auto_handler': \"reset_auto_event\"\n\n  reset_auto_event: () ->\n    clearInterval @auto_advance_handler\n    clearInterval @countdown_handle\n    return true\n\n  newQuestionSameGroup: (evt) ->\n    @renderQuestion()\n    return false\n \n  # # #\n  # # #  Answer logging\n  # # #\n\n  correctAnswer: (q, user_input) ->\n    # Give user feedback that they were correct, and show the set done options.\n    if app.wait_handler?\n      clearInterval app.wait_handler\n      @answer_in = true\n\n\n    user_answer_concept = q.answer\n    correct_answer_concept = q.question\n\n    answer_offset = $(user_input).offset()\n    width_offset = ($(user_input).width() / 2) - (@pts_bubble.width() / 2)\n    height_offset = @pts_bubble.height() / 2\n\n    $(user_input).addClass('correct')\n    @logConcept(q.generator, correct_answer_concept, true)\n    $('.set_done_options').show()\n    setTimeout((() => @$el.find('#menu_next').click()), 1200)\n    clearInterval(app.wait_handler)\n\n    @pts_bubble.css('top',  \"#{answer_offset.top-height_offset}px\")\n    @pts_bubble.css('left', \"#{answer_offset.left+width_offset}px\")\n\n    @pts_bubble.fadeIn(100)\n    return false\n\n  logConcept: (question_generator, concept, correct) ->\n    # Log the concept that the user was prompted with, with a correct/incorrect\n    # value\n\n    #\n    # Use the concept_value, but if it's an image, then we want to find\n    # translations that are words corresponding to the language of the question\n    concept_name = concept.get('concept_value')\n    if concept.get('concept_type') == 'img'\n      _to = question_generator.get('filters').to_language\n      _lang_to_filt = (c) => c.get('language') == _to\n      _transl = app.conceptdb.getTranslationsOf(concept).filter _lang_to_filt\n      if _transl.length > 0\n        concept_name = _transl[0].get('concept_value')\n\n    if correct\n      points_given = @cur_points\n      if points_given < 0\n        points_given = 0\n    else\n      points_given = 0\n    #\n    # Create the log entry in the user progression\n    # TODO: remove question, rely only on question_category and ..._level\n    log = app.userprogression.logActivity\n      game_name: \"leksa\"\n      question_concept: concept.get('concept_value')\n      question_concept_value: concept_name\n      question_correct: correct\n      question_category: question_generator.get('category')\n      question_category_level: question_generator.get('level')\n      points: points_given\n      cycle: question_generator.get('cycle')\n\n    return true\n\n  incorrectAnswer: (q, user_input) ->\n    # NB: do not clear the point countdown handler here\n\n    if @cur_points > 10\n      @cur_points -= 10\n\n    user_answer_concept = q.answer\n    correct_answer_concept = q.question\n    # Give user visual feedback on incorrect, add user log.\n\n\n    # TODO: generate incorrect log entry only on first incorrect attempt, not\n    # on each incorrect attempt, but log instance of user progression for word?\n\n    $(user_input).addClass('incorrect')\n    @logConcept(q.generator, correct_answer_concept, false)\n    false\n\n  # # #\n  # # #  Level complete\n  # # #\n\n  levelComplete: () ->\n    # TODO:\n    return false\n\n  # # #\n  # # #  Progress bar\n  # # #\n\n  # setIndividualAnswerProgress: (count, total, note) ->\n  #   prog = @$el.find \"#leksa_progress_indiv\"\n  #   prog.progressbar({value: (count/total)*100})\n  #   prog.find('.progress_label').text(note)\n  #   return false\n\n  # setProgress: (count, total) ->\n  #   prog = @$el.find \"#leksa_progress\"\n  #   prog.progressbar({value: (count/total)*100})\n  #   return false\n\n  # # #\n  # # #  Question rendering\n  # # #\n\n  selectQuestionForRendering: ->\n    # TODO: wait for ready if not\n    if app.questiondb.length == 0 and app.conceptdb.length == 0\n      window.last_error = \"Question DB and Concept DB not ready.\"\n      app.router.navigate('error')\n\n    if @attributes.level_constraint\n      level_constraint = @level_constraint\n    else\n      level_constraint = (level) -> true\n\n    q = app.questiondb.selectQuestionByProg(\n      @attributes.leksa_category,\n      level_constraint\n    )\n\n    return q\n\n  displayUserPoints: ->\n    count = app.userprogression.countPoints()\n    @$el.find('#point_total').html count\n    return\n\n  renderQuestion: ->\n    # Select a question, render it, bind event handlers to each possible\n    # answer\n\n    #\n    # Hide the question-end options\n    $('.set_done_options').hide()\n    @answer_in = false\n\n    if app.wait_handler?\n      clearInterval app.wait_handler\n    \n    window.scrollTo(0,0)\n\n    @displayUserPoints()\n\n    # check if the question has been preselected by the click event in the\n    # router\n    if @preselected_q?\n      if app.debug\n        console.log \"Pregenerated for click event.\"\n      @q = @preselected_q\n      delete @preselected_q\n    else\n      @q = @selectQuestionForRendering()\n\n    # TODO: feedback to user that they haven't completed this yet or have\n    # already-- if already, repeat\n    # incement cycle once\n    if @q == false\n      window.last_category = window.location.hash\n      window.location.hash = '#category_complete'\n      return false\n\n    if @last_level\n      if @q.generator.get('level') != @last_level\n        window.last_category = window.location.hash\n        window.location.hash = '#level_complete'\n        @last_level = false\n        return false\n\n    level_note = \"Level #{@q.generator.get('level')}\"\n    @last_level = @q.generator.get('level')\n\n    # @setProgress(@q.current_count, @q.question_total)\n    _repeats = @q.generator.get('repetitions')\n    if _repeats == 0\n      _repeats = 1\n    else\n      _repeats += 1\n\n    # @setIndividualAnswerProgress(\n    #   @q.total_correct,\n    #   @q.question_total_repeats,\n    #   level_note\n    # )\n\n    if not @q.question\n      _log_msg = \"LeksaView.render_question: ungeneratable question - \"\n      _log_msg += \"#{q.generator.get('category')}/#{q.generator.get('level')}\"\n      window.client_log.error(_log_msg)\n      _err_msg = \"A question could not be generated from these parameters\"\n      @$el.find('#leksa_question').html @leksa_error_template\n        error_msg: _err_msg\n      return false\n\n    #\n    # Render the template for the question\n\n    class DummyConcept extends Backbone.Model\n      render_concept: () ->\n        LeksaConceptTemplate({\n          concept: @\n          concept_type: @.get('concept_type')\n          concept_value: @.get('concept_value')\n          additional_class: \"no_frame\"\n        })\n\n    if @q.choices.length == 3 and @q.generator.get('type') == \"word_to_image\"\n      @q.choices.push new DummyConcept\n        concept_value: \"/static/images/bakgrunn-spill.png\"\n        concept_type: \"img\"\n\n      @q.choices = _.shuffle @q.choices\n\n    @$el.find('#leksa_question').html @question_template\n      instance: @q\n      chunker: arrayChunk\n      audio: @q.question.hasAudio()\n      q_type: @q.generator.get('type')\n\n    @$el.find('#leksa_question a.answerlink.text').textfill\n      minFontPixels: 18\n      maxFontPixels: 36\n\n    @cur_points = @q.generator.get('points')\n\n    @pts_bubble.find('.points').html(\"+#{@cur_points}\")\n    @pts_bubble.hide()\n\n    #\n    # Register answer click handlers\n    @$el.find('#leksa_question a.answerlink').click (evt) =>\n      if @auto_advance\n        return false\n      else\n        answerlink = $(evt.target).parents('.answerlink')\n        user_input = answerlink.attr('data-word')\n        answer_value = @q.answer.get('concept_value')\n        window.last_user_input = answerlink\n        if user_input == answer_value\n          # If user is correct, stop watching for additional clicks\n          @$el.find('#leksa_question a.answerlink')\n              .unbind('click').click (evt) -> return false\n          @correctAnswer(@q, answerlink)\n        else\n          @incorrectAnswer(@q, answerlink)\n        #\n        # rebind event to null result incase user clicks multiple times\n        answerlink.unbind('click').click (evt) -> return false\n        return false\n\n    app.router.refreshCurrentPage()\n\n    playFirst = =>\n      if app.options.getSetting('enable_audio') and @q.generator.get('sound')\n        speaker = $(document).find('img.play_speaker')\n        speaker.addClass('playing')\n        @playQuestionSound()\n\n    # Delay first sound playing as leksa page renders\n    if @pregenerated?\n      # setTimeout(playFirst, 1500)\n      delete @pregenerated\n    else\n      if not @first\n        setTimeout(playFirst, 1500)\n        @first = false\n      else\n        playFirst()\n\n    @$el.find('#question_play').click () =>\n      if app.debug?\n        console.log \"Play:\"\n        console.log @q.question\n      speaker = $(document).find('img.play_speaker').addClass('playing')\n      @q.question.playAudio()\n      return false\n\n    return true\n\n  playQuestionSound: () ->\n    if @preselected_q\n      a = @preselected_q\n    else\n      a = @q\n\n    @current_audio = a.question.playAudio\n      finished: app.leksaView.soundFinished\n\n  countdownPoints: () ->\n    # these parts need to be written with reference to app, because setting\n    # them as an interval or timeout breaks scope\n    if app.leksaView.cur_points > 5\n      app.leksaView.cur_points -= 5\n      app.leksaView.pts_bubble.find('.points').html(\n        \"+#{app.leksaView.cur_points}\"\n      )\n      if app.debug\n        console.log \"available points: #{app.leksaView.cur_points}\"\n\n    # need to tail call or something with setTimeout\n    app.wait_handler = setTimeout(app.leksaView.countdownPoints, 1000)\n    return false\n\n  soundFinished: () ->\n    speaker = $(document).find('img.play_speaker').removeClass('playing')\n \n    # Begin point degrading after the sound has finished\n    if app.debug\n      console.log \"View got sound finished.\"\n      if app.leksaView.answer_in\n        console.log \"Sound finished, but user answered first.\"\n\n    # handle the situation where the user clicks the answer before the sound\n    # finishes; do not continue counting points.\n    if not app.leksaView.answer_in\n      app.leksaView.countdownPoints()\n    return false\n\n  render: ->\n    # if user ends up on front page due to error and comes back here, events\n    # are not registered\n    # Render template and insert a question\n    if app.wait_handler?\n      console.log \"Clearing old wait handler\"\n      clearTimeout app.wait_handler\n\n    @last_level = false\n\n    @cat = _.first app.categories.where\n      category: @attributes.leksa_category\n\n    @$el.html @template {\n      leksa_category: @attributes.leksa_category\n      category: @cat.attributes.name\n    }\n\n    @pts_bubble = @$el.find('#points_for_question')\n    @pts_bubble.hide()\n\n    @renderQuestion()\n\n    @first = true\n\n    return this\n","\nmodule.exports = class LeksaOptionsView extends Backbone.View\n\n  # ? Multiple different manifests depending on what user wants to\n  # store?\n  className: 'hello'\n  events:\n    'click #save-options': 'saveOptions'\n\n  getLevel: () ->\n    _level = @$el.find('#current_level input[checked]').val()\n    if _level.length == 0\n      _level = false\n\n    _level\n\n  getSet: () ->\n    _set = @$el.find('#semantic_set input[checked]').val()\n    if _set.length == 0\n      _set = false\n\n    _set\n\n  saveOptions: (evt) ->\n    # TODO: check options, store to app.leksaOptions\n    # Then, question generation should use app.leksaOptions if something is set.\n\n    toBool = (v) ->\n      switch v\n        when \"true\"  then return true\n        when \"false\" then return false\n       \n    _level = @getLevel()\n    _set = @getSet()\n\n    if _level\n      app.leksaOptions.current_level = _level\n\n    if _set\n      app.leksaOptions.current_set = _set\n\n  template: require './templates/leksa_options_view'\n\n  render: ->\n    @$el.html @template\n\n    _level = @getLevel()\n    _set = @getSet()\n\n    if _level\n      @$el.find(\"#current_level input[value='#{_level}'\").click()\n\n    if _set\n      @$el.find(\"#semantic_set input[value='#{_set}'\").click()\n\n    # TODO: app.options.getSetting\n\n    ## if app.options?\n    ##   _set = @$el.find('#semantic_set fieldset')\n    ##   _level = @$el.find('#current_level fieldset')\n    ##   _set.val(\n    ##       app.options.enable_cache.toString()\n    ##   )\n    ##   _level.val(\n    ##       app.options.enable_audio.toString()\n    ##   )\n    ##   # _cache.slider('refresh')\n    ##   # _audio.slider('refresh')\n\n    this\n\n","LevelCompleteTemplate = require './templates/leksa_level_completed'\n\nmodule.exports = class LevelComplete extends Backbone.View\n\n  id: \"level_complete\"\n\n  events:\n    'click a#repeat': 'navigateBack'\n\n  template: LevelCompleteTemplate\n\n  navigateBack: (e) ->\n    e.preventDefault()\n    window.location.hash = window.last_category\n    delete window.last_category\n\n  render: () ->\n    @$el.html @template {category: @category}\n    setTimeout( app.soundEffects.correct, 500 )\n    this\n\n","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div class=\"aajege-header aajege-header-shrinkable\">\\n    <ul class=\"aajege-nav aajege-nav-left\">\\n        <li class=\"icon-aajege-home\">\\n            <a href=\"#index\" data-transition=\"slide\" class=\"disable_auto_handler\">\\n                <span class=\"label\">\\n                    ');\n    \n      __out.push(gettext.gettext(\"Home\"));\n    \n      __out.push('\\n                </span>\\n            </a>\\n        </li>\\n        <li class=\"icon-aajege-left-arrow\">\\n            <a href=\"#category/');\n    \n      __out.push(this.leksa_category);\n    \n      __out.push('\" class=\"disable_auto_handler\">\\n                <span class=\"label\">\\n                    ');\n    \n      __out.push(gettext.gettext(\"Back\"));\n    \n      __out.push('\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n    <h2>');\n    \n      __out.push(this.category);\n    \n      __out.push('</h2>\\n    <ul class=\"aajege-nav aajege-nav-right\">\\n        <li class=\"icon-aajege-bag\">\\n            <a href=\"#stats\" id=\"userinfo_button\" class=\"disable_auto_handler user_points\">\\n                <span class=\"label\">\\n                    <span id=\"point_total\"></span>\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n    <hr class=\"aajege-flette\" />\\n</div>\\n\\n<div data-role=\"content\">\\n\\n    <div id=\"leksa_question\">\\n        ');\n    \n      if (this.leksa_question) {\n        __out.push(this.leksa_question);\n      }\n    \n      __out.push('\\n    </div>\\n\\n    <div id=\"points_for_question\"><span class=\"points\">+15</span></div>\\n\\n    <div id=\"progress_container\">\\n        <div id=\"leksa_progress_indiv\"><div class=\"progress_label\"></div></div>\\n    </div>\\n\\n</div>\\n\\n<a style=\"display: none;\" data-role=\"button\" id=\"menu_next\" href=\"#\" data-icon=\"arrow-r\">Next</a>\\n');\n    \n      __out.push('\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<h3>Uh oh, an error occurred.</h3>\\nError: ');\n    \n      __out.push(this.error_msg);\n    \n      __out.push('\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div class=\"aajege-header aajege-header-shrinkable\">\\n    <ul class=\"aajege-nav aajege-nav-left\">\\n        <li class=\"icon-aajege-home\">\\n            <a href=\"#index\" data-transition=\"slide\">\\n                <span class=\"label\">\\n                    ');\n    \n      __out.push(gettext.gettext(\"Home\"));\n    \n      __out.push('\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n\\n    <h2>&nbsp;</h2>\\n\\n    <ul class=\"aajege-nav aajege-nav-right\">\\n        <li class=\"icon-aajege-bag\">\\n            <a href=\"#stats\" id=\"userinfo_button\" class=\"user_points\">\\n                <span class=\"label\">\\n                    <span class=\"point_name\">');\n    \n      __out.push(gettext.gettext(\"Points\"));\n    \n      __out.push('</span>\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n    <hr class=\"aajege-flette\" />\\n</div>\\n\\n<div data-role=\"content\">\\n    <div id=\"full_box\">\\n        <h1 class=\"tjoho\">');\n    \n      __out.push(gettext.gettext(\"Tjoho!\"));\n    \n      __out.push('</h1>\\n        <h1 class=\"center-icon icon-is-too-big\">\\n            <span class=\"fa-stack fa-lg\">\\n              <i class=\"fa fa-circle fa-stack-2x\"></i>\\n              <i class=\"fa fa-star fa-stack-1x fa-inverse\"></i>\\n            </span>\\n        </h1>\\n    </div>\\n    ');\n    \n      if (this.category) {\n        __out.push('\\n        <p class=\"note\">');\n        __out.push(gettext.gettext(\"You completed the category!\"));\n        __out.push('</p>\\n    ');\n      } else {\n        __out.push('\\n        <p class=\"note\">');\n        __out.push(gettext.gettext(\"You completed the level!\"));\n        __out.push('</p>\\n    ');\n      }\n    \n      __out.push('\\n    ');\n    \n      if (this.category) {\n        __out.push('\\n    <a href=\"#\" data-role=\"button\" data-theme=\"b\" id=\"repeat\" data-mini=\"true\">\\n        ');\n        __out.push(gettext.gettext(\"Play again\"));\n        __out.push(' <i class=\"fa fa-arrow-circle-right\"></i>\\n    </a>\\n    ');\n      } else {\n        __out.push('\\n    <a href=\"#\" data-role=\"button\" data-theme=\"b\" id=\"repeat\" data-mini=\"true\">\\n        ');\n        __out.push(gettext.gettext(\"Next level\"));\n        __out.push(' <i class=\"fa fa-arrow-circle-right\"></i>\\n    </a>\\n    ');\n      }\n    \n      __out.push('\\n    <br />\\n    <a href=\"#categoryMenu\" data-role=\"button\" data-theme=\"b\" id=\"back_to_categories\" data-mini=\"true\">\\n        <i class=\"fa fa-arrow-circle-left\"></i> ');\n    \n      __out.push(gettext.gettext(\"Category list\"));\n    \n      __out.push('\\n    </a>\\n</div>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div data-role=\"header\">\\n    <a href=\"#leksa\" data-transition=\"slide\" data-icon=\"arrow-l\">');\n    \n      __out.push(gettext.gettext(\"Back\"));\n    \n      __out.push('</a>\\n    <h2>Options</h2>\\n    <a id=\"save-options\" data-icon=\"gear\">Save</a>\\n</div> \\n\\n<div data-role=\"content\">\\n    <h2>Game settings</h2>\\n\\n    <p>NB: currently only for testing. We\\'ll put real options in later.</p>\\n    <form id=\"option_form\">\\n\\n    <div data-role=\"fieldcontain\" id=\"semantic_set\">\\n        <fieldset data-role=\"controlgroup\">\\n            <legend>Set</legend>\\n            <input type=\"radio\" name=\"radio-choice-1\" id=\"radio-choice-1\" value=\"face\" checked=\"checked\">\\n            <label for=\"radio-choice-1\">Face</label>\\n            <input type=\"radio\" name=\"radio-choice-1\" id=\"radio-choice-2\" value=\"other\">\\n            <label for=\"radio-choice-2\">Other</label>\\n        </fieldset>\\n    </div>\\n\\n    <div data-role=\"fieldcontain\" id=\"current_level\">\\n        <fieldset data-role=\"controlgroup\" data-type=\"horizontal\" data-mini=\"true\">\\n            <legend>Level</legend>\\n                <input type=\"radio\" name=\"radio-choice-b\" id=\"radio-choice-c\" value=\"1\">\\n                <label for=\"radio-choice-c\">1</label>\\n                <input type=\"radio\" name=\"radio-choice-b\" id=\"radio-choice-d\" value=\"2\">\\n                <label for=\"radio-choice-d\">2</label>\\n                <input type=\"radio\" name=\"radio-choice-b\" id=\"radio-choice-e\" value=\"3\">\\n                <label for=\"radio-choice-e\">3</label>\\n                <input type=\"radio\" name=\"radio-choice-b\" id=\"radio-choice-f\" value=\"4\">\\n                <label for=\"radio-choice-f\">4</label>\\n                <input type=\"radio\" name=\"radio-choice-b\" id=\"radio-choice-g\" value=\"\" checked=\"checked\">\\n                <label for=\"radio-choice-g\">Auto</label>\\n        </fieldset>\\n    </div>\\n\\n    </form>\\n</div> \\n\\n\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var choice, idx, _i, _len, _ref;\n    \n      __out.push('<div class=\"one_image\">\\n    <div class=\"question_prompt\">\\n        ');\n    \n      __out.push(this.instance.question.render_concept());\n    \n      __out.push('\\n    </div>\\n\\n    <br />\\n\\n    <div class=\"possible_answers word_set\">\\n        ');\n    \n      _ref = this.instance.choices;\n      for (idx = _i = 0, _len = _ref.length; _i < _len; idx = ++_i) {\n        choice = _ref[idx];\n        __out.push('\\n            <a class=\"answerlink text\"\\n               data-word=\"');\n        __out.push(choice.get('concept_value'));\n        __out.push('\"\\n               href=\"#\">');\n        __out.push(choice.render_concept());\n        __out.push('</a>\\n        ');\n      }\n    \n      __out.push('\\n    </div>\\n\\n    ');\n    \n      if (this.audio && this.instance.generator.get('sound')) {\n        __out.push('\\n        <a href=\"#\" id=\"question_play\"><img width=\"32\" height=\"32\" src=\"/static/client/images/speaker.png\" class=\"play_speaker\"/></a>\\n    ');\n      }\n    \n      __out.push('\\n</div>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var chars, choice, choice_group, grid_count, idx, _i, _j, _len, _len1, _ref;\n    \n      __out.push('<div class=\"word_to_image\">\\n    <div class=\"possible_answers image_set\">\\n        <div class=\"image-grid-group grid-total-');\n    \n      __out.push(this.instance.choices.length);\n    \n      __out.push('\">\\n            ');\n    \n      _ref = this.chunker(this.instance.choices, 2);\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        choice_group = _ref[_i];\n        __out.push('\\n                ');\n        grid_count = 'grid-' + choice_group.length;\n        __out.push('\\n                <ul class=\"image-grid ');\n        __out.push(grid_count);\n        __out.push('\">\\n                ');\n        chars = 'abcdefghijklmnopqrstuvwxyz';\n        __out.push('\\n                ');\n        for (idx = _j = 0, _len1 = choice_group.length; _j < _len1; idx = ++_j) {\n          choice = choice_group[idx];\n          __out.push('\\n                    <li class=\"image-item image-');\n          __out.push(chars.charAt(idx));\n          __out.push('\">\\n                        <a class=\"answerlink\" data-word=\"');\n          __out.push(choice.get('concept_value'));\n          __out.push('\" href=\"#\"><span class=\"tint\">');\n          __out.push(choice.render_concept());\n          __out.push('</span></a>\\n                    </li>\\n                ');\n        }\n        __out.push('\\n                </ul>\\n            ');\n      }\n    \n      __out.push('\\n        </div>\\n    </div>\\n\\n    <div class=\"question_prompt\">\\n        ');\n    \n      __out.push(this.instance.question.render_concept());\n    \n      __out.push('\\n    </div>\\n\\n    ');\n    \n      if (this.audio && this.instance.generator.get('sound')) {\n        __out.push('\\n        <a href=\"#\" id=\"question_play\"><img src=\"/static/client/images/speaker.png\" class=\"play_speaker\" /></a>\\n    ');\n      }\n    \n      __out.push('\\n</div>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var concept, total_correct, _ref;\n    \n      __out.push('<h4>Overall progress</h4>\\n<dl>\\n<dt>Total points</dt>\\n<dd>');\n    \n      __out.push(this.total_points);\n    \n      __out.push('</dd>\\n<dt>Correct</dt>\\n<dd>');\n    \n      __out.push(this.correct);\n    \n      __out.push('</dd>\\n<dt>Total</dt>\\n<dd>');\n    \n      __out.push(this.total);\n    \n      __out.push('</dk>\\n</dl>\\n<h4>Concept progress</h4>\\n<h5>(Correct / tries)</h5>\\n<dl>\\n    ');\n    \n      _ref = this.concept_progress;\n      for (concept in _ref) {\n        total_correct = _ref[concept];\n        __out.push('\\n      <dt>');\n        __out.push(concept);\n        __out.push('</dt>\\n      <dd>');\n        __out.push(total_correct[0]);\n        __out.push('/');\n        __out.push(total_correct[1]);\n        __out.push('</dd>\\n    ');\n      }\n    \n      __out.push('\\n</dl>\\n\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","InfoTemplate = require './templates/info'\n\nmodule.exports = class InfoPage extends Backbone.View\n\n  id: \"infoPage\"\n\n  template: InfoTemplate\n\n  render: ->\n    @$el.html @template\n\n    this\n","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div class=\"aajege-header aajege-header-shrinkable\">\\n    <ul class=\"aajege-nav aajege-nav-left\">\\n        <li class=\"icon-aajege-left-arrow\">\\n            <a href=\"#index\">\\n            </a>\\n        </li>\\n    </ul>\\n   <h2>');\n    \n      __out.push(gettext.gettext(\"About this app\"));\n    \n      __out.push('</h2>\\n   <hr class=\"aajege-flette\" />\\n</div>\\n\\n<div data-role=\"content\" id=\"info_text_content\">\\n\\n    <h3>Forml</h3>\\n\\n    <p> Hovedmlet med prosjektet er  fremme srsamisk sprkbruk p flere og nye\\n    arenaer, samt utvikle hjelpemidler som bidrar i prosessen med vitalisering av\\n    srsamisk sprk.  </p>\\n\\n    <h3> Resultatml </h3>\\n\\n    <ul>\\n        <li>Utvikle en srsamisk sprkapplikasjon for iPhone og iPad som\\n        kombinerer srsamisk lyd, skrift og bilde. </li>\\n        <li>Bruke ny teknologi til  fremme bruk av srsamisk\\n        hverdagssprk.</li>\\n        <li>Synliggjre srsamisk p nye sprkarenaer. </li>\\n    </ul>\\n\\n    <h3> Mlgruppe </h3>\\n    <p>Den primre mlgruppen er barn, ungdom og voksne som nsker  lre,\\n    repetere og/eller videreutvikle sine srsamiske sprkferdigheter.\\n    Sprknivet for brukeren vil kunne variere fra de som har liten kunnskap om\\n    srsamisk til de som kan snakke.</p> <p>Verktyet kan brukes selvstendig av\\n    enkeltpersoner, eller integreres som et hjelpemiddel i eksisterende\\n    sprkopplring eller sprkstimulering. Hjelpemidlet vil kunne vre aktuelt\\n    for alle som nsker  arbeide med det srsamiske sprket.</p>\\n\\n    <h3> Medarbeidere </h3>\\n    <dl>\\n        <dt>Planlegging</dt>\\n        <dd>Sissel Jma, Helen Blind Brandsfjell, Toini Bergstrm, Sjur Moshagen</dd>\\n        <dt>Tekst</dt>\\n        <dd>Sissel Jma, Aino Danielsen, Helen Blind Brandsfjell</dd>\\n        <dt>Foto</dt>\\n        <dd>Vg2 Medier og kommunikasjon ved Rros videregende skole 2012/2013, Bente Haarstad, Aino Danielsen</dd>\\n        <dt>Lyd</dt>\\n        <dd>Peder Kristian Bientie Aasvold, Emmi Danielsen, Aino Danielsen</dd>\\n        <dt>Illustrasjoner og layout</dt>\\n        <dd>Anne Rustad</dd>\\n        <dt>Programmerer</dt>\\n        <dd>Ryan Johnson</dd>\\n    </dl>\\n\\n    <p> Appen er produsert med sttte fra Sametinget, Fornyings-, administrasjons-\\n    og kirkedepartementet og Aajege  samisk sprk- og\\n    kompetansesenter, Divvun-gruppa ved Universitetet i Troms </p>\\n\\n</div>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","module.exports = class LoadingView extends Backbone.View\n\n  className: 'loading'\n  id: \"loading\"\n\n  template: require './templates/loading'\n\n  render: ->\n    @$el.html @template\n    app.loadingTracker.showLoading()\n    i = 0\n    console.log \"int #{i}\"\n    @$el.find(\"pre\").html(\"\"\"\n        Concepts:  #{app.conceptdb.models.length}\n        Questions: #{app.questiondb.models.length}\n    \"\"\")\n    # app.router.index()\n    this\n\n","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var disp;\n    \n      __out.push('<div class=\"aajege-header aajege-header-shrinkable\">\\n    <ul class=\"aajege-nav aajege-nav-right\">\\n        <li class=\"icon-aajege-info\">\\n            <a href=\"#infoPage\">\\n            </a>\\n        </li>\\n    </ul>\\n    <hr class=\"aajege-flette\" />\\n</div>\\n<div data-role=\"content\" id=\"front_page_content\">\\n    <div class=\"ui-grid-a\">\\n        <div class=\"ui-block-a\">\\n            <h2 class=\"legend\">');\n    \n      __out.push(gettext.gettext(\"Use an account?\"));\n    \n      __out.push('</h2>\\n        </div>\\n        <div class=\"ui-block-b\">\\n            <h2 id=\"create_account_or_login_legend\" class=\"legend\">');\n    \n      __out.push(gettext.gettext(\"New account?\"));\n    \n      __out.push('</h2>\\n        </div>\\n        <div class=\"ui-block-a\">\\n            <div data-role=\"fieldcontain\" id=\"create_account\">\\n                <fieldset data-role=\"controlgroup\" data-type=\"horizontal\" data-setting=\"use_account\">\\n\\n                    <input data-theme=\"a\" \\n                           type=\"radio\" \\n                           name=\"create-user-account\" \\n                           id=\"create-user-account-a\" \\n                           value=\"true\" \\n                           data-subquestion=\"user_account_block\" checked>\\n                    <label for=\"create-user-account-a\">');\n    \n      __out.push(gettext.gettext(\"Yes\"));\n    \n      __out.push('</label>\\n\\n                    <input data-theme=\"a\" \\n                           type=\"radio\" \\n                           name=\"create-user-account\" \\n                           id=\"create-user-account-b\" \\n                           value=\"false\" \\n                           data-hide-subquestion=\"user_account_block\">\\n                    <label for=\"create-user-account-b\">');\n    \n      __out.push(gettext.gettext(\"No\"));\n    \n      __out.push('</label>\\n\\n                </fieldset>\\n            </div>\\n        </div>\\n\\n        <div class=\"ui-block-b\">\\n            <div data-role=\"fieldcontain\" id=\"create_account_or_login\">\\n                <fieldset data-role=\"controlgroup\" data-type=\"horizontal\" data-setting=\"use_account\">\\n\\n                    <input data-theme=\"a\" \\n                           type=\"radio\" \\n                           name=\"login-or-new\" \\n                           id=\"login-or-new-a\" \\n                           value=\"true\" \\n                           checked>\\n                    <label for=\"login-or-new-a\">');\n    \n      __out.push(gettext.gettext(\"Yes\"));\n    \n      __out.push('</label>\\n\\n                    <input data-theme=\"a\" \\n                           type=\"radio\" \\n                           name=\"login-or-new\" \\n                           id=\"login-or-new-b\" \\n                           value=\"false\">\\n                    <label for=\"login-or-new-b\">');\n    \n      __out.push(gettext.gettext(\"No\"));\n    \n      __out.push('</label>\\n\\n                </fieldset>\\n            </div>\\n        </div>\\n    </div>\\n\\n    ');\n    \n      disp = '';\n    \n      __out.push('\\n    ');\n    \n      if (this.hide_form) {\n        __out.push('\\n    ');\n        disp = 'style=\"display: none;\"';\n        __out.push('\\n    ');\n      }\n    \n      __out.push('\\n    <div id=\"user_account_block\" ');\n    \n      __out.push(disp);\n    \n      __out.push('>\\n        <div id=\"loginform_subsub\">\\n            <form id=\"user\" action=\"\" data-use=\"create\">\\n                <div class=\"form_fields grouped_fields\">\\n                    <div class=\"grouped_field\">\\n                        <label for=\"un\">');\n    \n      __out.push(gettext.gettext(\"Username\"));\n    \n      __out.push('</label>\\n                        <input data-role=\"none\" \\n                               autocapitalize=\"off\" \\n                               autocorrect=\"off\" \\n                               type=\"text\" \\n                               name=\"username\" \\n                               id=\"un\" \\n                               value=\"\" \\n                               placeholder=\".....................................\">\\n                    </div>\\n                    <div class=\"grouped_field\">\\n                        <label for=\"pw\">');\n    \n      __out.push(gettext.gettext(\"Password\"));\n    \n      __out.push('</label>\\n                        <input data-role=\"none\" \\n                               type=\"password\" \\n                               name=\"password\" \\n                               id=\"pw\" \\n                               value=\"\" \\n                               placeholder=\".....................................\">\\n                    </div>\\n                    <div class=\"grouped_field\" id=\"email_field\">\\n                        <label for=\"em\">');\n    \n      __out.push(gettext.gettext(\"E-mail\"));\n    \n      __out.push('</label>\\n                        <input data-role=\"none\" \\n                               autocapitalize=\"off\" \\n                               autocorrect=\"off\" \\n                               type=\"email\" \\n                               name=\"email\" \\n                               id=\"em\" \\n                               value=\"\" \\n                               placeholder=\".....................................\">\\n                    </div>\\n                </div>\\n                <div class=\"validation_errors\" />\\n            </form>\\n        </div>\\n    </div>\\n\\n    <div class=\"sub_question_block\">\\n        <div data-role=\"fieldcontain\" id=\"help_language\">\\n            <div class=\"ui-grid-a\">\\n                <div class=\"ui-block-a\">\\n                    <h2 class=\"legend no_disable\">');\n    \n      __out.push(gettext.gettext(\"Translation language\"));\n    \n      __out.push('</h2>\\n                </div>\\n                <div class=\"ui-block-b\">&nbsp;</div>\\n            </div>\\n            <fieldset data-role=\"none\" data-setting=\"help_language,interface_language,translation_language\">\\n                <div class=\"ui-grid-a\">\\n                    <div class=\"ui-block-a\">\\n                        <a type=\"button\"\\n                           data-theme=\"a\"\\n                           name=\"both-choice\"\\n                           id=\"both-choice-1\"\\n                           data-value=\"nob\"\\n                           data-mini=\"true\">\\n                        Norsk\\n                        </a>\\n                    </div>\\n                    <div class=\"ui-block-b\">\\n                        <a type=\"button\"\\n                           data-theme=\"a\"\\n                           name=\"both-choice\"\\n                           id=\"both-choice-3\"\\n                           data-value=\"swe\"\\n                           data-mini=\"true\">\\n                        Svenska\\n                        </a>\\n                    </div>\\n                </div>\\n            </fieldset>\\n        </div>\\n    </div>\\n\\n    <div id=\"account_feedback\">\\n        <p style=\"display: none;\" class=\"message\" id=\"account_created\">');\n    \n      __out.push(gettext.gettext(\"Your account was created, you may now begin!\"));\n    \n      __out.push('</p>\\n        <p style=\"display: none;\" class=\"message\" id=\"account_exists\">');\n    \n      __out.push(gettext.gettext(\"You are logged in, and may now begin!\"));\n    \n      __out.push('</p>\\n    </div>\\n\\n    <div id=\"end\">\\n        <a href=\"#categoryMenu\" class=\"begin_text\" data-role=\"button\" data-theme=\"b\" id=\"start\" data-mini=\"true\" style=\"display: none;\">\\n            ');\n    \n      __out.push(gettext.gettext(\"Begin!\"));\n    \n      __out.push('\\n        </a>\\n        <a href=\"#\" data-role=\"button\" class=\"login_text\" data-theme=\"b\" id=\"submit\" data-mini=\"true\">\\n            ');\n    \n      __out.push(gettext.gettext(\"Log in\"));\n    \n      __out.push('\\n        </a>\\n    </div>\\n\\n</div>\\n\\n');\n    \n      __out.push('\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div data-role=\"header\">\\n    <h1>Please wait...</h1>\\n</div> \\n\\n<div data-role=\"content\">\\n    <p> Downloading some resources </p>\\n    <pre></pre>\\n</div> \\n\\n\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","# A front page view to ask users introductory questions about their experience.\n# Once this is set, need to skip this on further loads.\n\nFrontPageTemplate = require './templates/front_page'\nLoginErrorTemplate = require '/views/users/templates/login_error_modal'\n\nmodule.exports = class FrontPage extends Backbone.View\n\n  id: \"frontPage\"\n\n  template: FrontPageTemplate\n\n  # NB: some events need to be bound after the template is rendered, because\n  # jQuery mobile and Backbone events don't play well together.\n  events:\n    \"submit #user\": \"userForm\"\n    \"click #submit\": \"userForm\"\n\n    \"click #displayLogin\": \"displayLogin\"\n    \"change #create-user-account-c\": \"displayLogin\"\n    \"click #end a\": \"begin\"\n\n    \"click #help_language [type='button']\": \"changeLanguage\"\n    \"change #help_language [type='button']\": \"changeLanguage\"\n    \"change #create_account [data-subquestion]\": \"revealUserForm\"\n    \"change #create_account [data-hide-subquestion]\": \"hideUserForm\"\n\n    \"change #create_account_or_login #login-or-new-a\": \"useCreateVariant\"\n    \"change #create_account_or_login #login-or-new-b\": \"useLoginVariant\"\n\n  begin: (evt) ->\n    DSt.set('gielese-configured', true)\n\n  useCreateVariant: (evt) ->\n    @$el.find('#email_field').slideDown()\n    @$el.find('#user').attr('data-use', 'create')\n    DSt.set('form-create-or-not', 'create')\n\n    if evt?\n      if not $(evt.target).attr('checked')\n        $(evt.target).attr('checked', true)\n                     .checkboxradio('refresh')\n\n\n  useLoginVariant: (evt) ->\n    @$el.find('#email_field').slideUp()\n    @$el.find(\"#user #em\").val('')\n    @$el.find('#user').attr('data-use', 'login')\n    DSt.set('form-create-or-not', 'login')\n\n    if evt?\n      if not $(evt.target).attr('checked')\n        $(evt.target).attr('checked', true)\n                     .checkboxradio('refresh')\n\n\n  changeLanguage: (evt) ->\n    anon = DSt.get('anonymous_selected')\n    if anon\n      @language_switched = true\n    target_btn = $(evt.target).parents('[type=\"button\"]')\n\n    active = 'b'\n    inactive = 'a'\n\n    fieldset = $(evt.target).parents('fieldset')\n\n    @storeCurrentVisibleSetting fieldset, target_btn\n\n    return true\n\n  disableForm: () ->\n    @$el.find('#create_account fieldset').checkboxradio()\n                                         .checkboxradio('disable')\n    @$el.find('#create_account_or_login fieldset').checkboxradio()\n                                                  .checkboxradio('disable')\n    @$el.find('h2.legend').addClass('disabled')\n    @form_disabled = true\n  \n  enableForm: () ->\n    @$el.find('#create_account fieldset').checkboxradio()\n                                         .checkboxradio('enable')\n    @$el.find('#create_account_or_login fieldset').checkboxradio()\n                                                  .checkboxradio('enable')\n    @$el.find('h2.legend').removeClass('disabled')\n    @form_disabled = false\n\n  revealUserForm: (evt) ->\n    sub = $(evt.target).attr('data-subquestion')\n    @$el.find(\"##{sub}\").slideDown()\n    $('.login_text').show()\n    $('.begin_text').hide()\n    DSt.set('anonymous_selected', false)\n    $('#create_account_or_login').fadeIn(200)\n    $('#create_account_or_login_legend').fadeIn()\n    return true\n\n  hideUserForm: (evt) ->\n    if app.user\n      app.auth.logout()\n    sub = $(evt.target).attr('data-hide-subquestion')\n    @$el.find(\"##{sub}\").slideUp()\n    $('.login_text').hide()\n    $('.begin_text').show()\n    DSt.set('anonymous_selected', true)\n    $('#account_exists').hide()\n    $('#account_created').hide()\n    $('#create_account_or_login').fadeOut(200)\n    $('#create_account_or_login_legend').fadeOut(200)\n    return true\n\n  displayLogin: ->\n    app.auth.render_authentication_popup @$el, {\n      success: () =>\n        setTimeout(() =>\n          app.auth.hide_authentication_popup @$el\n          window.location.hash = \"#mainMenu\"\n        , 250)\n        # TODO: check if user has configured stuff-- if not (for instance, they\n        # created a username and account, but got thrown out of the process for\n        # some reason), need to resume for them.\n    }\n    return false\n\n  hideLoading: () ->\n    interval = setInterval(() ->\n      $.mobile.loading('hide')\n      clearInterval(interval)\n    ,1)\n    return false\n\n  showLoading: (txt) ->\n    interval = setInterval(() =>\n      $.mobile.loading('show', {\n        text: txt,\n        textVisible: true,\n        theme: 'a',\n        html: \"\"\n      })\n      clearInterval(interval)\n    ,1)\n    return false\n\n  storeForm: () ->\n    # This is different from the DSt.store_form method, intended for storing\n    # stuff between sessions.\n    #\n    form_data =\n      username: @$el.find(\"#user #un\").val()\n      email:    @$el.find(\"#user #em\").val()\n      password: @$el.find(\"#user #pw\").val()\n    DSt.set('login-details', form_data)\n\n  recallForm: () ->\n    # TODO: access token\n    # TODO: yes/no state on account create also: if username is\n    # recalled, automaticallhy set to 'no'\n\n    ds = DSt.get('login-details')\n    if ds\n      @$el.find(\"#user #un\").val ds.username\n      # @$el.find(\"#user #em\").val ds.email\n      @$el.find(\"#user #pw\").val ds.password\n      @useLoginVariant()\n\n    create_or = DSt.get('form-create-or-not')\n\n    if create_or == \"create\"\n      @$el.find('#email_field').show()\n\n    if create_or == \"login\"\n      @$el.find('#email_field').hide()\n      @$el.find(\"#user #em\").val('')\n      @$el.find(\"#create_account_or_login #login-or-new-a\")\n              .attr('checked', false)\n              .checkboxradio()\n              .checkboxradio('refresh')\n      @$el.find(\"#create_account_or_login #login-or-new-b\")\n              .attr('checked', true)\n              .checkboxradio()\n              .checkboxradio('refresh')\n\n    return true\n\n  userForm: (event) ->\n    # display loading\n    #\n    @showLoading(\"Submitting...\")\n\n    # TODO: client-side validation?\n    #\n    username = $(\"#user #un\").val()\n    password = $(\"#user #pw\").val()\n\n    form_sub_action = $('#user').attr('data-use')\n\n    if form_sub_action == 'create'\n      login_request =\n        username: $(\"#user #un\").val()\n        email:    $(\"#user #em\").val()\n        password: $(\"#user #pw\").val()\n\n    if form_sub_action == 'login'\n      login_request =\n        username: $(\"#user #un\").val()\n        password: $(\"#user #pw\").val()\n        # TODO: un / em:    $(\"#user #em\").val()\n\n    # TODO: maybe submit json instead? do something so it can't be sniffed?\n    #\n\n    login_request.fail = (resp) =>\n      error_json = JSON.parse(resp.responseText)\n      fields = error_json.reasons\n      $(\"form#user input\").removeClass(\"error\")\n      $(\"form#user span.error\").remove()\n      $(\"form .grouped_field.error\").removeClass(\"error\")\n\n      # Can't rely on schematics to return consistent data. Sometimes this is\n      # a list, sometimes an Object\n      if fields\n        # Append errors to form\n        for fieldname, error of fields\n          console.log [fieldname, error]\n          if form_sub_action == 'login'\n            if fieldname == 'username' or 'exists' in error\n              @show_login_error(@_LOGIN_ACCOUNT_ERROR_EXISTS, true, username)\n              continue\n          error_field = $(\"input[name=#{fieldname}]\").parents('.grouped_field')\n          error_msg = $(\"<div class='grouped_field_error'><span class='error'>#{error}</span></div>\")\n          error_field.after(error_msg)\n\n        # Highlight fields that have errors\n        for key, error of fields\n          input = $(\"input[name=#{key}]\")\n          input.addClass(\"error\")\n          fieldset = input.parents('.grouped_field')\n          fieldset.addClass('error')\n\n          error_msg = $(\"<span class='error'>\")\n          error_msg.html(error.join(', '))\n          # fieldset.append error_msg\n      else\n        @show_login_error(@_LOGIN_ACCOUNT_ERROR_EXISTS, true, username)\n\n    if form_sub_action == 'create'\n      login_request.success = (resp) =>\n        app.auth.login({\n          username: username\n          password: password\n          success: () =>\n            setTimeout(@hideLoading, 500)\n            $('.login_text').hide()\n            $('.begin_text').show()\n            $('#loginform_subsub').slideUp()\n            $('#account_created').show()\n            # TODO: store form to another DSt variable.\n            DSt.store_form(app.frontPage.form[0])\n        })\n\n    @$el.find('#fakeSubmit').click (evt) ->\n      $(\"#loginform_subsub\").slideUp()\n      $(\"#loginform_success\").show()\n\n    if form_sub_action == 'create'\n      login_request.always = (resp) =>\n        setTimeout(@hideLoading, 500)\n\n    if form_sub_action == 'login'\n      login_request.success = (resp) =>\n        setTimeout(@hideLoading, 500)\n        if app.user\n          app.frontPage.storeForm()\n          $(\"#loginform_success\").show()\n          $('#account_created').hide()\n          $('#account_exists').show()\n          $('#loginform_subsub').slideUp()\n          $('.login_text').hide()\n          $('.begin_text').show()\n          @disableForm()\n\n    if form_sub_action == 'login'\n      login_result = app.auth.login(login_request)\n\n    if form_sub_action == 'create'\n      login_result = app.auth.create_user(login_request)\n\n    return false\n\n  storeCurrentVisibleSetting: (fieldset, btn) ->\n\n    # TODO: user settings model\n    checked_setting = fieldset.find('input[type=\"radio\"]:checked')\n    setting_target = fieldset.attr('data-setting')\n    setting_value = btn.attr('data-value')\n\n    refresh_template = false\n\n    if setting_target and setting_value\n      for key in setting_target.split(',')\n        if key == \"interface_language\"\n          refresh_template = true\n        app.options.setSetting key, setting_value\n\n    if refresh_template\n      setTimeout(@refreshTemplate, 500)\n\n    return true\n\n  refreshTemplate: () =>\n    # Refresh the template when language setting is changed\n    #\n\n    # TODO: store form values to reload\n    DSt.store_form($('form#user')[0])\n    if @language_switched?\n      hide_form = true\n    else\n      hide_form = false\n\n    @$el.html @template {\n      hide_form: hide_form\n    }\n    delete @language_switched\n    $('[data-role=page]').trigger('pagecreate')\n    @loadSettings()\n    DSt.recall_form($('form#user')[0])\n\n  loadSettings: ->\n    help_lang = app.options.getSetting('help_language')\n    h_value = \"[data-value=#{help_lang}]\"\n\n    active = 'b'\n    inactive = 'a'\n\n    resetCheck = (vs, val) ->\n      vs.attr('data-theme', val)\n\n    create_or = DSt.get('form-create-or-not')\n\n    if create_or == \"create\"\n      @$el.find('#email_field').show()\n\n    if create_or == \"login\"\n      @$el.find('#email_field').hide()\n      @$el.find(\"#user #em\").val('')\n      @$el.find(\"#create_account_or_login #login-or-new-a\")\n              .attr('checked', false)\n              .checkboxradio()\n              .checkboxradio('refresh')\n      @$el.find(\"#create_account_or_login #login-or-new-b\")\n              .attr('checked', true)\n              .checkboxradio()\n              .checkboxradio('refresh')\n\n    anon = DSt.get('anonymous_selected')\n    if @form_disabled\n      @disableForm()\n\n    if anon\n      $('#create_account_or_login').hide()\n      $('#create_account_or_login_legend').hide()\n      $('#user_account_block').hide()\n\n      $('#create-user-account-b').attr('checked', true)\n                                 .checkboxradio('refresh')\n\n      $('#create-user-account-a').attr('checked', false)\n                                 .checkboxradio('refresh')\n\n      $('.login_text').hide()\n      $('.begin_text').show()\n\n    if app.user\n      $('#create_account_or_login').show()\n      $('#user_account_block').hide()\n\n      $('#create-user-account-b').attr('checked', false)\n                                 .checkboxradio('refresh')\n\n      $('#create-user-account-a').attr('checked', true)\n                                 .checkboxradio('refresh')\n\n      $('.login_text').hide()\n      $('.begin_text').show()\n      $('#account_exists').show()\n\n  show_login_error: (msg, forgotten=false, username=false, try_again=true) ->\n    if @login_error_popup?\n      @login_error_popup.remove()\n\n    login_template = LoginErrorTemplate\n      error_msg: msg\n      forgotten: forgotten\n      try_again: try_again\n\n    @$el.append(login_template)\n\n    @login_error_popup = @$el.find('#loginErrorPopup')\n    @login_error_popup.trigger('create')\n    @login_error_popup.popup().show().popup('open')\n\n    if forgotten\n      @login_error_popup.find('a#forget_button').click (e) =>\n\n        @login_error_popup.popup().popup('close')\n\n        app.auth.forgot\n          username: username\n          success: () =>\n            app.frontPage.cur_msg = @_LOGIN_ACCOUNT_CHECK_EMAIL\n            setTimeout(() ->\n              app.frontPage.show_login_error(\n                app.frontPage.cur_msg, false, false, false)\n            , 500)\n          fail: () =>\n            app.frontPage.cur_msg = @_LOGIN_ACCOUNT_NETWORK_ERROR\n            setTimeout(() ->\n              app.frontPage.show_login_error(\n                app.frontPage.cur_msg, true, username)\n            , 500)\n\n    return\n\n\n  render: ->\n    if history.length > 1\n      if app.user\n        app.auth.logout()\n      else\n        app.auth.clearUserData()\n    @total_questions = 2\n    @questions_answered = 0\n    @process_complete = false\n    @enableForm()\n\n    if not DSt.get('form-create-or-not')\n      DSt.set('form-create-or-not', 'create')\n\n    if @language_switched?\n      console.log \"rendering with switched lang\"\n      hide_form = true\n    else\n      hide_form = false\n\n    @$el.html @template {\n      hide_form: hide_form\n    }\n\n    @form = @$el.find('form')\n\n    delete @language_switched\n\n    _FORGET = gettext.gettext \"Did you forget your password?\"\n    _EMAIL = gettext.gettext \"Check your email!\"\n    _NETWORK = gettext.gettext \"Check your network connection and try again\"\n    @_LOGIN_ACCOUNT_ERROR_EXISTS = _FORGET\n    @_LOGIN_ACCOUNT_CHECK_EMAIL = _EMAIL\n    @_LOGIN_ACCOUNT_NETWORK_ERROR = _NETWORK\n\n    # Initialize error template\n\n    @loadSettings()\n    \n    @recallForm()\n\n    # Need to bind events here; jQuery mobile creates elements that messes with\n    # backbone events.\n\n    this\n\n","SplashTemplate = require './templates/splash'\n\nmodule.exports = class SplashPage extends Backbone.View\n\n  hideLoading: () ->\n    interval = setInterval(() ->\n      $.mobile.loading('hide')\n      clearInterval(interval)\n    ,1)\n    return false\n\n  showLoading: (txt) ->\n    interval = setInterval(() =>\n      $.mobile.loading('show', {\n        text: txt,\n        textVisible: true,\n        theme: 'a',\n        html: \"\"\n      })\n      clearInterval(interval)\n    ,1)\n    return false\n\n  id: \"loading_splash\"\n\n  template: SplashTemplate\n\n  render: ->\n    @$el.html @template\n    this\n\n\n","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div data-role=\"content\">\\n    <div id=\"splash_content\">\\n\\n        <div id=\"big_logo\">\\n        </div>\\n\\n        <div id=\"splash_footer\">\\n            <div id=\"footer_version\">\\n                <span class=\"version\">v. 0.1.0</span>\\n            </div>\\n            <div id=\"footer_logo\">\\n                <div id=\"logo\">\\n                    <img src=\"/static/images/aajege.png\" />\\n                    <span class=\"aajege\">Aajege</span>\\n                </div>\\n                <div id=\"copy\">\\n                    <span class=\"copyright\">&copy; 2013</span>\\n                </div>\\n            </div>\\n        </div>\\n    </div>\\n</div> \\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div id=\"loading_float\">\\n  <img src=\"/static/client/images/icon_loading_spinner.gif\"/>\\n  <span id=\"status\">\\n    <span id=\"message\">Initializing offline cache ... </span>  \\n    <span id=\"cache_count\">&nbsp;</span>/<span id=\"cache_total\">');\n    \n      __out.push(this.obj_count);\n    \n      __out.push('</span>\\n  </span>\\n</div>\\n\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var classes, linebreaks, val;\n    \n      if (this.concept_type === 'img') {\n        __out.push('\\n\\n    ');\n        classes = 'concept img_concept ';\n        __out.push('\\n    ');\n        if (this.additional_class) {\n          __out.push('\\n        ');\n          classes += this.additional_class;\n          __out.push('\\n    ');\n        }\n        __out.push('\\n\\n    <div class=\\'');\n        __out.push(classes);\n        __out.push('\\'>\\n        <span class=\"concept_img_span\" style=\\'background-image: url(');\n        __out.push(this.concept_value);\n        __out.push(')\\' />\\n    </div>\\n\\n');\n      } else if (this.concept_type === 'text') {\n        __out.push('\\n\\n    ');\n        linebreaks = /[-]/;\n        __out.push('\\n    ');\n        val = this.concept_value.split(linebreaks).join('-<br />');\n        __out.push('\\n    <span class=\\'concept word_concept\\'>');\n        __out.push(val);\n        __out.push('</span>\\n\\n');\n      }\n    \n      __out.push('\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div id=\"sound_loading_bar\" style=\"display: none;\">\\n    <img src=\"/static/images/ajax-loader.gif\" width=\"16\" height=\"16\" /> \\n    <p>Downloading audio...</p>\\n</div>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","\nmodule.exports = class FrontPage extends Backbone.View\n\n  template: require './templates/login_modal'\n\n  render: ->\n    this\n","OptionsTemplate = require './templates/options'\n\nmodule.exports = class GlobalOptionsView extends Backbone.View\n\n  # ? Multiple different manifests depending on what user wants to\n  # store?\n  id: 'global_options'\n\n  # TODO: save when the options are adjusted individually.\n\n  events:\n    'click #save-options': 'saveOptions'\n    'change #help_language': 'revealSubquestion'\n    'change #help_language input': 'selectHelpLang'\n    'change #help_language_2 input': 'saveOptions'\n    'change #offline_fieldset select': 'saveOptions'\n    'change #audio_fieldset select': 'saveOptions'\n\n  selectHelpLang: (evt) ->\n    $fieldset = $(evt.target).parents('fieldset')\n    target_fieldset = $fieldset.attr('data-copy-to')\n    target_value = $fieldset.find('input[type=\"radio\"]:checked')\n                            .val()\n\n    # Sync language option between two separate fields\n    $(\"[data-setting='#{target_fieldset}']\").find(\"[type='radio']\")\n        .attr(\"checked\",false).checkboxradio(\"refresh\")\n\n    $(\"[data-setting='#{target_fieldset}']\").find(\"[value='#{target_value}']\")\n        .attr(\"checked\",true).checkboxradio(\"refresh\")\n\n    @saveOptions()\n    return true\n\n  revealSubquestion: (evt) ->\n    sub_q = 'data-reveal-subquestion'\n    subs = $(\"[#{sub_q}]\").attr(sub_q)\n    $(\"##{subs}\").slideUp()\n\n    sub = $(evt.target).attr(sub_q)\n    if sub?\n      sub = $(\"##{sub}\")\n      sub.slideDown()\n      first = sub.find(\".ui-radio:first\")\n      first.find('input').attr('checked', true).checkboxradio(\"refresh\")\n\n    return true\n  \n  saveOptions: (evt) ->\n    if app.debug == true\n      console.log evt\n    toBool = (v) ->\n      switch v\n        when \"true\"  then return true\n        when \"false\" then return false\n       \n    _data = @$el.find('select[name=\"data-storage\"]')\n    _audio = @$el.find('select[name=\"play-audio\"]')\n\n    enable_cache = toBool _data.slider().val()\n    enable_audio = toBool _audio.slider().val()\n\n    interface_language = $(\"[data-setting='interface_language']\")\n                            .find('input[type=\"radio\"]:checked').val()\n\n    help_language = $(\"[data-setting='help_language']\")\n                            .find('input[type=\"radio\"]:checked').val()\n\n    new_settings = {\n      enable_cache:       enable_cache\n      enable_audio:       enable_audio\n      interface_language: interface_language\n      help_language:      help_language\n    }\n\n    app.options.setSettings(new_settings, {\n      store: true\n    })\n      \n\n  template: OptionsTemplate\n\n  reloadSettings: ->\n    _cache = @$el.find('select[name=\"data-storage\"]')\n    _audio = @$el.find('select[name=\"play-audio\"]')\n\n    uil = app.options.getSetting('interface_language')\n    hl  = app.options.getSetting('help_language')\n\n    # NB: ISOs are stored in three-char format here, so no need to convert to\n    # read and save in storage\n    #\n    _ui = @$el.find(\"[data-setting='interface_language'] input[value='#{uil}']\")\n\n    _hl = @$el.find(\"[data-setting='help_language'] input[value='#{hl}']\")\n\n    _cache.val(\n      app.options.getSetting('enable_cache').toString()\n    )\n\n    _audio.val(\n      app.options.getSetting('enable_audio').toString()\n    )\n\n    _ui.attr(\"checked\", true)\n    _hl.attr(\"checked\", true)\n\n    # TODO: sync offline, or in localstorage\n\n  render: ->\n    if app.options.getSetting('interface_language') == 'sma'\n      hide_sub = false\n    else\n      hide_sub = true\n\n    @$el.html @template\n      hide_sub: hide_sub\n\n    @reloadSettings()\n\n    # TODO: events for some reason aren't reregistered when returning to this\n    # view.\n    console.log \"render\"\n\n","# TODO: if this view is called and someone isn't logged in, display login\n# but with a back button\n#\nCategoryLegend = require './templates/category_legend'\nHighScoreList = require './templates/high_scores'\n\n# TODO: if user is anonymous, total points locally and include in result\n\nmodule.exports = class UserStats extends Backbone.View\n\n  id: \"user_stats_page\"\n\n  events:\n    'click .history_back': 'goBack'\n    'change input': 'displayTab'\n\n  displayTab: (evt) ->\n    new_tab = $(evt.target).attr('data-display-tab')\n\n    $('.stats-tab').fadeOut 300, () =>\n      $(\"##{new_tab}\").fadeIn(300)\n      $('.aajege-header h2').html $(\"##{new_tab}\").attr('data-tab-title')\n\n\n  goBack: () ->\n    window.history.back()\n    return false\n\n  template: require './templates/stats'\n\n  initChart: () ->\n    width = 960\n    height = 500\n    radius = Math.min(width, height) / 2\n\n    color = d3.scale.category20()\n\n    pie = d3.layout.pie()\n        .value( (d) -> return d.count )\n        .sort(null)\n\n    arc = d3.svg.arc()\n        .innerRadius(radius - 100)\n        .outerRadius(radius - 20)\n\n\n    svg = d3.select(_el).append(\"svg\")\n        .attr(\"width\", width)\n        .attr(\"height\", height)\n      .append(\"g\")\n        .attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")\")\n\n    path = svg.selectAll(\"path\")\n\n    return svg\n\n  categoryChart: () ->\n    # POINTS or amount of times played?\n    catego = _.zip(\n      app.categories.pluck('category'),\n      app.categories.pluck('name'),\n    )\n\n    color_range = [ \"#F7464A\" ,\n                    \"#437FEB\" ,\n                    \"#48CC92\" ,\n                    \"#DDD46D\" ,\n                    \"#E49247\" ]\n\n    # light grey (1)\n    # \"#E2EAE9\" ,\n    # tan (3)\n    # \"#D4CCC5\" ,\n    # mid grey (4)\n    # \"#949FB1\" ,\n    # dark grey (2)\n    # \"#4D5360\"\n\n    test_data = [\n      { points: 30,  color: \"#F7464A\", category: \"omg\", pretty_name: \"Omg\" },\n      { points: 50,  color: \"#E2EAE9\", category: \"bbq\", pretty_name: \"Bbq\" },\n      { points: 100, color: \"#D4CCC5\", category: \"lol\", pretty_name: \"ll\" },\n      { points: 40,  color: \"#949FB1\", category: \"foo\", pretty_name: \"f\" },\n      { points: 120, color: \"#4D5360\", category: \"bar\", pretty_name: \"br\" }\n    ]\n\n    category_colors = []\n    for [cat, col] in _.zip(catego, color_range)\n      [title, pretty_name] = cat\n      points = app.userprogression.points_for_category_name title\n      if points > 0\n        category_colors.push {category: pretty_name, color: col, points: points}\n\n    if app.debug\n      console.log category_colors\n    if app.debug and app.userprogression.models.length == 0\n      category_colors = test_data\n      console.log category_colors\n\n    # TODO: legend\n    # @$el.find('#categories').html CategoryLegend {\n    #   items: category_colors\n    # }\n\n    width = $(document).width() - 20\n    height = 300\n    radius = Math.min(width, height) / 2\n\n    color = d3.scale.ordinal().range(color_range)\n\n    arc = d3.svg.arc().outerRadius(radius - 10)\n                      .innerRadius(radius - 70)\n\n    pie = d3.layout.pie().sort(null).value (d) -> d.points\n\n    _el = @$el.find(\"#category_use\")[0]\n    if $(_el).find('svg')\n      $(_el).find('svg').remove()\n\n    # Create an SVG, and translate the viewport to relate to the height and\n    # width\n    svg = d3.select(_el)\n        .append(\"svg\")\n        .attr(\"width\", width)\n        .attr(\"height\", height)\n        .append(\"g\")\n        .attr(\"transform\", \"translate(\" + width / 2 + \",\" + height / 2 + \")\")\n\n    # Plot categories\n    plotCategories = (data) ->\n\n      # Make sure that the points field is converted to an integer.\n      data.forEach (d) ->\n        d.points = +d.points\n\n      # Add an arc, projecting to pie() layout\n      g = svg.selectAll(\".arc\")\n             .data(pie(data))\n             .enter().append(\"g\").attr(\"class\", \"arc\")\n\n      # Set the color according to the preselected color field\n      g.append(\"path\").attr(\"d\", arc).style \"fill\", (d) ->\n        color d.data.category\n\n      # Put a text label on the category's center\n      g.append(\"text\").attr(\"transform\", (d) ->\n        \"translate(\" + arc.centroid(d) + \")\"\n      ).attr(\"dy\", \".35em\").style(\"text-anchor\", \"middle\").text (d) ->\n        # NB: not pretty_name here\n        d.data.category if d.data.points > 0\n\n    plotCategories(category_colors)\n    return true\n\n  store_user_visibility: (evt, ui) ->\n    toBool = (v) ->\n      switch v\n        when \"true\"  then return true\n        when \"false\" then return false\n\n    key = 'highscore_visible'\n    val = toBool $(evt.target).attr('data-highscore-visible')\n\n    if app.user\n      app.options.setSettings({highscore_visible: val}, {store: true})\n\n    return false\n\n  render: ->\n\n    # * word accuracy rate\n    # * category accuracy rate\n    # * words to practice\n    # * percentage of time spent on each category-- see what needs doing (fancy\n    #   pie chart?)\n    #\n    # but for now, just a list of objects\n    models = app.userprogression.models\n\n    correct_for_category = {}\n    if app.userprogression.length > 0\n      # problem here\n      questions = app.userprogression\n                     .pluck('question')\n                     .filter (q) ->\n                       q != null\n\n      cats = []\n\n      cats.push cat for cat in cats if cat?\n      \n      categories = _.uniq cats\n\n      for c in categories\n        questions_for_category = app.userprogression.filter (l) =>\n          l.get('question').category == c\n        questions_correct_for_category = questions_for_category.filter (l) =>\n          l.get('question_correct') == true\n\n        total_questions_tried = questions_for_category.length\n        total_questions_correct = questions_correct_for_category.length\n\n        correct_for_category[c] = {\n          'total': total_questions_tried\n          'correct': total_questions_correct\n          'percent': (total_questions_correct/total_questions_tried)*100\n        }\n\n    if app.userprogression.length > 0\n      points = app.userprogression.countPoints()\n    else\n      points = false\n\n    user = false\n    if app.user\n      user = true\n\n    @$el.html @template\n      logs: models\n      category_scores: correct_for_category\n      highscore_visible: app.options.getSetting('highscore_visible')\n      points_total: points\n      user: user\n\n    if app.userprogression.length > 0 or app.debug\n      @categoryChart()\n\n    @$el.find('#display_stats input[type=radio]').on(\n      'change',\n      @store_user_visibility\n    )\n\n    scores = @$el.find('div#high_scores')\n    $.get '/users/scores/',\n      (resp) =>\n        scores.html HighScoreList\n          highscores: resp.highscores\n\n","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var category, _i, _len, _ref;\n    \n      __out.push('<ul>\\n');\n    \n      _ref = this.items;\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        category = _ref[_i];\n        __out.push('\\n    ');\n        if (category.points > 0) {\n          __out.push('\\n        <li style=\"background-color: ');\n          __out.push(category.color);\n          __out.push('\">');\n          __out.push(category.name);\n          __out.push('<br />');\n          __out.push(category.points);\n          __out.push('</li>\\n    ');\n        }\n        __out.push('\\n');\n      }\n    \n      __out.push('\\n</ul>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      var cur_class, entry, you_are_here_first, you_are_here_second, you_are_here_third, _i, _len, _ref;\n    \n      __out.push('<ul id=\"top_three\">\\n    ');\n    \n      you_are_here_second = \"\";\n    \n      __out.push('\\n    ');\n    \n      if (app.user != null) {\n        __out.push('\\n        ');\n        if (app.user.username === this.highscores[1].username) {\n          __out.push('\\n            ');\n          you_are_here_second = \"you_are_here\";\n          __out.push('\\n        ');\n        }\n        __out.push('\\n    ');\n      }\n    \n      __out.push('\\n    <li class=\"point_block second ');\n    \n      __out.push(you_are_here_second);\n    \n      __out.push('\">\\n        <ul class=\"score_set\">\\n            <li class=\"number\">\\n                <span class=\"circled-number\"> 2 </span>\\n            </li>\\n            <li class=\"score_part username\"><span class=\"txt\">');\n    \n      __out.push(this.highscores[1].username);\n    \n      __out.push('</span class=\"txt\"></li>\\n            <li class=\"score_part points\"><span class=\"txt\">');\n    \n      __out.push(this.highscores[1].points);\n    \n      __out.push('</span class=\"txt\"></li>\\n        </ul>\\n    </li>\\n\\n    ');\n    \n      you_are_here_first = \"\";\n    \n      __out.push('\\n    ');\n    \n      if (app.user != null) {\n        __out.push('\\n        ');\n        if (app.user.username === this.highscores[0].username) {\n          __out.push('\\n            ');\n          you_are_here_first = \"you_are_here\";\n          __out.push('\\n        ');\n        }\n        __out.push('\\n    ');\n      }\n    \n      __out.push('\\n    <li class=\"point_block first ');\n    \n      __out.push(you_are_here_first);\n    \n      __out.push('\">\\n        <ul class=\"score_set\">\\n            <li class=\"number\">\\n                <span class=\"circled-number\"> 1 </span>\\n            </li>\\n            <li class=\"score_part username\"><span class=\"txt\">');\n    \n      __out.push(this.highscores[0].username);\n    \n      __out.push('</span class=\"txt\"></li>\\n            <li class=\"score_part points\"><span class=\"txt\">');\n    \n      __out.push(this.highscores[0].points);\n    \n      __out.push('</span class=\"txt\"></li>\\n        </ul>\\n    </li>\\n\\n    ');\n    \n      you_are_here_third = \"\";\n    \n      __out.push('\\n    ');\n    \n      if (app.user != null) {\n        __out.push('\\n        ');\n        if (app.user.username === this.highscores[2].username) {\n          __out.push('\\n            ');\n          you_are_here_third = \"you_are_here\";\n          __out.push('\\n        ');\n        }\n        __out.push('\\n    ');\n      }\n    \n      __out.push('\\n    <li class=\"point_block third ');\n    \n      __out.push(you_are_here_third);\n    \n      __out.push('\">\\n        <ul class=\"score_set\">\\n            <li class=\"number\">\\n                <span class=\"circled-number\"> 3 </span>\\n            </li>\\n            <li class=\"score_part username\"><span class=\"txt\">');\n    \n      __out.push(this.highscores[2].username);\n    \n      __out.push('</span class=\"txt\"></li>\\n            <li class=\"score_part points\"><span class=\"txt\">');\n    \n      __out.push(this.highscores[2].points);\n    \n      __out.push('</span class=\"txt\"></li>\\n        </ul>\\n    </li>\\n\\n</ul>\\n\\n<ul id=\"point_list\">\\n    ');\n    \n      _ref = this.highscores.slice(3);\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\n        entry = _ref[_i];\n        __out.push('\\n        ');\n        cur_class = \"\";\n        __out.push('\\n        ');\n        if (app.user != null) {\n          __out.push('\\n            ');\n          if (app.user.username === entry.username) {\n            __out.push('\\n                ');\n            cur_class = \"this_is_you\";\n            __out.push('\\n            ');\n          }\n          __out.push('\\n        ');\n        }\n        __out.push('\\n        <li class=\"');\n        __out.push(cur_class);\n        __out.push('\">\\n            <span class=\"username\">');\n        __out.push(entry.username);\n        __out.push('</span>\\n            <span class=\"points\">');\n        __out.push(entry.points);\n        __out.push('</span>\\n        </li>\\n    ');\n      }\n    \n      __out.push('\\n</ul>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div id=\"loginErrorPopup\" \\n     data-transition=\"pop\" \\n     data-theme=\"a\">\\n\\n    <div id=\"loginPopupPadding\">\\n        <div id=\"fail\">\\n            ');\n    \n      __out.push(this.error_msg);\n    \n      __out.push('\\n        </div>\\n        ');\n    \n      if (this.try_again) {\n        __out.push('\\n            <a data-role=\"button\" data-rel=\"back\" type=\"submit\" data-theme=\"b\">');\n        __out.push(gettext.gettext(\"Try again\"));\n        __out.push('</a>\\n        ');\n      } else {\n        __out.push('\\n            <a data-role=\"button\" data-rel=\"back\" type=\"submit\" data-theme=\"b\">');\n        __out.push(gettext.gettext(\"Close\"));\n        __out.push('</a>\\n        ');\n      }\n    \n      __out.push('\\n\\n        ');\n    \n      __out.push(this.forgotten ? (__out.push('\\n            <a data-role=\"button\" data-rel=\"email\" id=\"forget_button\" type=\"\" data-theme=\"a\">'), __out.push(gettext.gettext(\"Email me\")), __out.push('</a>\\n        ')) : void 0);\n    \n      __out.push('\\n    </div>\\n\\n</div>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div id=\"loginPopup\" style=\"display: none;\" data-transition=\"pop\" data-theme=\"a\">\\n    ');\n    \n      if (this.logout) {\n        __out.push('\\n\\n        <div id=\"loading\" style=\"display: none;\">\\n            Sending... <span id=\"login_status\">&nbsp;</span>\\n        </div>\\n        <div id=\"success\" style=\"display: none;\">\\n            Success!\\n        </div>\\n        <div id=\"fail\" style=\"display: none;\">\\n            You were not logged in. Are you connected, or was your password wrong?\\n        </div>\\n        \\n    ');\n      } else {\n        __out.push('\\n    <form id=\"login_form\">\\n        <div style=\"padding:10px 20px;\">\\n            <h3>Please sign in</h3>\\n            <input autocapitalize=\"off\" autocorrect=\"off\" type=\"text\" name=\"user\" id=\"un\" value=\"\" placeholder=\"Username or e-mail\" data-theme=\"a\">\\n            <input autocapitalize=\"off\" autocorrect=\"off\"type=\"password\" name=\"pass\" id=\"pw\" value=\"\" placeholder=\"password\" data-theme=\"a\">\\n\\n            <button type=\"submit\" data-theme=\"b\">Sign in</button>\\n        </div>\\n        <div id=\"loading\" style=\"display: none;\">\\n            Sending... <span id=\"login_status\">&nbsp;</span>\\n        </div>\\n        <div id=\"success\" style=\"display: none;\">\\n            Success!\\n        </div>\\n        <div id=\"fail\" style=\"display: none;\">\\n            You were not logged in. Are you connected, or was your password wrong?\\n        </div>\\n        <!-- TODO: close button? -->\\n    </form>\\n    ');\n      }\n    \n      __out.push('\\n</div>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div class=\"aajege-header aajege-header-shrinkable\">\\n    <ul class=\"aajege-nav aajege-nav-left\">\\n        <li class=\"icon-aajege-left-arrow\">\\n            <a href=\"#mainMenu\" data-transition=\"slide\">\\n                <span class=\"label\">\\n                    ');\n    \n      __out.push(gettext.gettext(\"Back\"));\n    \n      __out.push('\\n                </span>\\n            </a>\\n        </li>\\n    </ul>\\n    <h2>Options</h2>\\n    <hr class=\"aajege-flette\" />\\n</div>\\n\\n<div data-role=\"content\">\\n    <form>\\n        <ul data-role=\"listview\" data-theme=\"j\">\\n            <li data-role=\"fieldcontain\">\\n                <fieldset id=\"help_language\" data-role=\"controlgroup\"  data-setting=\"interface_language\" data-copy-to=\"help_language\">\\n                    <legend>');\n    \n      __out.push(gettext.gettext(\"Help language\"));\n    \n      __out.push('</legend>\\n                    <input class=\"nextSection\" type=\"radio\" name=\"radio-choice-1\" id=\"radio-choice-1\" value=\"nob\" checked=\"checked\">\\n                    <label for=\"radio-choice-1\">Norsk <img class=\"flag_ico\" src=\"/static/images/flags/no_20x15.png\" /></label>\\n                    <input class=\"nextSection\" type=\"radio\" name=\"radio-choice-1\" id=\"radio-choice-2\" value=\"sma\" data-reveal-subquestion=\"help_language_sub\">\\n                    <label for=\"radio-choice-2\">arjelsaemien <img class=\"flag_ico\" src=\"/static/images/flags/sma_20x15.png\" /></label>\\n                    <input class=\"nextSection\" type=\"radio\" name=\"radio-choice-1\" id=\"radio-choice-3\" value=\"swe\">\\n                    <label for=\"radio-choice-3\">Svenska <img class=\"flag_ico\" src=\"/static/images/flags/sv_20x15.png\" /></label>\\n                </fieldset>\\n            </li>\\n\\n            <!-- TODO: this option will be in sync with the previous value unless\\n                       the value is \\'sma\\'\\n            -->\\n\\n            ');\n    \n      if (this.hide_sub) {\n        __out.push('\\n            <li data-role=\"fieldcontain\" style=\"display: none;\" id=\"help_language_sub\">\\n            ');\n      } else {\n        __out.push('\\n            <li data-role=\"fieldcontain\" id=\"help_language_sub\">\\n            ');\n      }\n    \n      __out.push('\\n                <fieldset id=\"help_language_2\" data-role=\"controlgroup\"  data-setting=\"help_language\">\\n                    <legend>');\n    \n      __out.push(gettext.gettext(\"Translation language\"));\n    \n      __out.push('</legend>\\n                    <input class=\"nextSection\" type=\"radio\" name=\"radio-choice-2\" id=\"radio-choice-1\" value=\"nob\" checked=\"checked\">\\n                    <label for=\"radio-choice-1\">Norsk <img class=\"flag_ico\" src=\"/static/images/flags/no_20x15.png\" /></label>\\n                    <input class=\"nextSection\" type=\"radio\" name=\"radio-choice-2\" id=\"radio-choice-2\" value=\"swe\">\\n                    <label for=\"radio-choice-2\">Svenska <img class=\"flag_ico\" src=\"/static/images/flags/sv_20x15.png\" /></label>\\n                    <input class=\"nextSection\" type=\"radio\" name=\"radio-choice-2\" id=\"radio-choice-3\" value=\"eng\">\\n                    <label for=\"radio-choice-3\">English <img class=\"flag_ico\" src=\"/static/images/flags/en_20x15.png\" /></label>\\n                </fieldset>\\n            </li>\\n\\n            <li data-role=\"fieldcontain\">\\n                <fieldset data-role=\"controlgroup\" id=\"audio_fieldset\">\\n                    <legend>');\n    \n      __out.push(gettext.gettext(\"Play audio?\"));\n    \n      __out.push('</legend>\\n                    <select name=\"play-audio\" \\n                            id=\"play-audio\" \\n                            data-theme=\"d\"\\n                            data-track-theme=\"d\"\\n                            data-role=\"slider\">\\n                        <option value=\"false\">');\n    \n      __out.push(gettext.gettext(\"No\"));\n    \n      __out.push('</option>\\n                        <option value=\"true\">');\n    \n      __out.push(gettext.gettext(\"Yes\"));\n    \n      __out.push('</option>\\n                    </select>\\n                </fieldset>\\n            </li>\\n\\n            <li data-role=\"fieldcontain\">\\n                <fieldset data-role=\"controlgroup\" id=\"offline_fieldset\">\\n                    <legend>Store data offline</legend>\\n                    <select name=\"data-storage\" \\n                            id=\"data-storage\" \\n                            data-theme=\"d\"\\n                            data-track-theme=\"d\"\\n                            data-role=\"slider\">\\n                        <option value=\"false\">');\n    \n      __out.push(gettext.gettext(\"No\"));\n    \n      __out.push('</option>\\n                        <option value=\"true\">');\n    \n      __out.push(gettext.gettext(\"Yes\"));\n    \n      __out.push('</option>\\n                    </select>\\n                </fieldset>\\n            </li>\\n\\n            <li data-role=\"fieldcontain\">\\n                <fieldset data-role=\"controlgroup\">\\n                    <legend>Debug</legend>\\n                    <div class=\"ui-grid-b\">\\n                        <div class=\"ui-block-a\">\\n                            <a class=\"square\" href=\"#reset\" data-transition=\"slide\">\\n                                <span class=\"link_word\">Reset App</span>\\n                            </a>\\n                        </div>\\n\\n                        <div class=\"ui-block-b\">\\n                            <a class=\"square\" href=\"#category/TEST\" data-transition=\"slide\">\\n                                <span class=\"link_image\"></span>\\n                                <span class=\"link_word\">Test Category</span>\\n                            </a>\\n                        </div>\\n                    </div>\\n                </fieldset>\\n            </li>\\n        </ul>\\n    </form>\\n\\n</div>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}","var __templateData = function (__obj) {\n  if (!__obj) __obj = {};\n  var __out = [], __capture = function(callback) {\n    var out = __out, result;\n    __out = [];\n    callback.call(this);\n    result = __out.join('');\n    __out = out;\n    return __safe(result);\n  }, __sanitize = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else if (typeof value !== 'undefined' && value != null) {\n      return __escape(value);\n    } else {\n      return '';\n    }\n  }, __safe, __objSafe = __obj.safe, __escape = __obj.escape;\n  __safe = __obj.safe = function(value) {\n    if (value && value.ecoSafe) {\n      return value;\n    } else {\n      if (!(typeof value !== 'undefined' && value != null)) value = '';\n      var result = new String(value);\n      result.ecoSafe = true;\n      return result;\n    }\n  };\n  if (!__escape) {\n    __escape = __obj.escape = function(value) {\n      return ('' + value)\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;');\n    };\n  }\n  (function() {\n    (function() {\n      __out.push('<div class=\"aajege-header aajege-header-shrinkable\">\\n    <ul class=\"aajege-nav aajege-nav-left\">\\n        <li class=\"icon-aajege-left-arrow\">\\n            <a href=\"#\" class=\"history_back\">\\n            </a>\\n        </li>\\n    </ul>\\n    <h2 class=\"kaushan\">');\n    \n      __out.push(gettext.gettext(\"Top 10\"));\n    \n      __out.push('</h2>\\n    <hr class=\"aajege-flette\" />\\n</div>\\n\\n<div data-role=\"content\">\\n\\n    <fieldset data-role=\"controlgroup\" data-type=\"horizontal\" id=\"subnav-control\">\\n    \\t<input data-display-tab=\"high_scores_panel\" \\n    \\t       type=\"radio\" \\n    \\t       data-theme=\"a\" \\n    \\t       name=\"radio-mini\" \\n    \\t       id=\"radio-mini-1\" \\n    \\t       value=\"choice-1\" \\n    \\t       checked=\"checked\" />\\n    \\t<label for=\"radio-mini-1\">');\n    \n      __out.push(gettext.gettext(\"Top 10\"));\n    \n      __out.push('</label>\\n\\n\\t    <input data-display-tab=\"statistics\" \\n\\t           type=\"radio\" \\n\\t           data-theme=\"a\" \\n\\t           name=\"radio-mini\" \\n\\t           id=\"radio-mini-2\" \\n\\t           value=\"choice-2\" />\\n    \\t<label for=\"radio-mini-2\">');\n    \n      __out.push(gettext.gettext(\"Statistics\"));\n    \n      __out.push('</label>\\n    </fieldset>\\n    \\n\\n    <div id=\"high_scores_panel\" class=\"stats-tab\" data-tab-title=\"');\n    \n      __out.push(gettext.gettext(\"Top 10\"));\n    \n      __out.push('\">\\n        <div id=\"high_scores\">\\n            ');\n    \n      __out.push(gettext.gettext(\"Loading...\"));\n    \n      __out.push('\\n        </div>\\n        ');\n    \n      if (this.user) {\n        __out.push('\\n            <form id=\"display_stats\">\\n                <ul data-role=\"listview\" data-inset=\"true\">\\n                    <li data-role=\"fieldcontain\">\\n                        <fieldset data-role=\"controlgroup\" data-type=\"horizontal\">\\n                            <legend>');\n        __out.push(gettext.gettext(\"Show my score to everyone?\"));\n        __out.push('</legend>\\n                                <input type=\"radio\" \\n                                       name=\"radio-choice-b\" \\n                                       id=\"radio-choice-a\"\\n                                       data-highscore-visible=\"true\"\\n                                       ');\n        if (this.highscore_visible) {\n          __out.push('\\n                                       checked=\"checked\"\\n                                       ');\n        }\n        __out.push('\\n                                       >\\n                                <label for=\"radio-choice-a\">');\n        __out.push(gettext.gettext(\"Yes\"));\n        __out.push('</label>\\n                                <input type=\"radio\"\\n                                       name=\"radio-choice-b\"\\n                                       id=\"radio-choice-b\"\\n                                       ');\n        if (!this.highscore_visible) {\n          __out.push('\\n                                       checked=\"checked\"\\n                                       ');\n        }\n        __out.push('\\n                                       data-highscore-visible=\"false\">\\n                                <label for=\"radio-choice-b\">');\n        __out.push(gettext.gettext(\"No\"));\n        __out.push('</label>\\n                        </fieldset>\\n                    </li>\\n                </ul>\\n            </form>\\n        ');\n      } else {\n        __out.push('\\n            <p>');\n        __out.push(gettext.gettext(\"You are playing anonymously, so your points may not be stored if you leave the app.\"));\n        __out.push('</p>\\n        ');\n      }\n    \n      __out.push('\\n    </div>\\n\\n\\n    <div id=\"statistics\" style=\"display: none;\" class=\"stats-tab\" data-tab-title=\"');\n    \n      __out.push(gettext.gettext(\"Your stats\"));\n    \n      __out.push('\">\\n\\n    ');\n    \n      if (this.points_total) {\n        __out.push('\\n        <h3>');\n        __out.push(this.points_total);\n        __out.push(' ');\n        __out.push(gettext.gettext(\"points\"));\n        __out.push('</h3>\\n    ');\n      }\n    \n      __out.push('\\n\\n    ');\n    \n      if (this.logs.length > 0 || window.app.debug) {\n        __out.push('\\n\\n        <div id=\"category_use\" width=\"300\" height=\"300\">\\n        </div>\\n\\n        <div id=\"category_chart\">\\n        <!-- -->\\n            <tabl\\n\\n        </div>\\n\\n    ');\n      } else {\n        __out.push('\\n\\n        <h3>');\n        __out.push(gettext.gettext(\"Learn some words to see stats!\"));\n        __out.push('</h3>\\n\\n    ');\n      }\n    \n      __out.push('\\n    </div>\\n</div>\\n');\n    \n    }).call(this);\n    \n  }).call(__obj);\n  __obj.safe = __objSafe, __obj.escape = __escape;\n  return __out.join('');\n};\nif (typeof define === 'function' && define.amd) {\n  define([], function() {\n    return __templateData;\n  });\n} else if (typeof module === 'object' && module && module.exports) {\n  module.exports = __templateData;\n} else {\n  __templateData;\n}"]}